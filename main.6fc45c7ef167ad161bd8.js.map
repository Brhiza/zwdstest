{"version":3,"file":"main.6fc45c7ef167ad161bd8.js","mappings":"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","sources":["webpack://react-iztro/./src/hooks/useHistoryManager.ts","webpack://react-iztro/./src/AIChat/AIChatContext.tsx","webpack://react-iztro/./src/IzpalaceCenter/index.ts","webpack://react-iztro/./src/Izstar/Izstar.tsx","webpack://react-iztro/./src/AIChat/components/SkeletonLoader.tsx","webpack://react-iztro/./src/Iztrolabe/index.ts","webpack://react-iztro/./src/AIChat/hooks/useVirtualScroll.ts","webpack://react-iztro/./src/AIChat/components/MessageList.tsx","webpack://react-iztro/./src/AIChat/AIChat.tsx","webpack://react-iztro/./src/utils/historyUtils.ts","webpack://react-iztro/./src/utils/markdownFormatter.tsx","webpack://react-iztro/./src/AIChat/utils/messageUtils.ts","webpack://react-iztro/./src/Iztrolabe/Iztrolabe.type.ts","webpack://react-iztro/./src/AIChat/components/QuickActions.tsx","webpack://react-iztro/./src/AIChat/hooks/useVirtualKeyboard.ts","webpack://react-iztro/./src/AIChat/components/ChatContainer.tsx","webpack://react-iztro/./src/index.tsx","webpack://react-iztro/./src/AIChat/hooks/useMessageScroll.ts","webpack://react-iztro/./src/AIChat/index.ts","webpack://react-iztro/./src/AIChat/hooks/useAIChatService.ts","webpack://react-iztro/./src/Iztrolabe/Iztrolabe.tsx","webpack://react-iztro/./src/AIChat/questionData.ts","webpack://react-iztro/./src/AIChat/utils/layoutUtils.ts","webpack://react-iztro/./src/containers/ResultContainer.tsx","webpack://react-iztro/./src/AIChat/components/ChatInput.tsx","webpack://react-iztro/./src/Izstar/index.ts","webpack://react-iztro/./src/utils/cloudStorage.ts","webpack://react-iztro/./src/Izpalace/Izpalace.tsx","webpack://react-iztro/./src/SegmentedControl/SegmentedControl.tsx","webpack://react-iztro/./src/AIChat/quickActions.ts","webpack://react-iztro/./src/AIChat/components/QuestionPanel.tsx","webpack://react-iztro/./src/AIChat/components/MessageItem.tsx","webpack://react-iztro/./src/utils/astrolabeFormatter.ts","webpack://react-iztro/./src/IzpalaceCenter/Line.tsx","webpack://react-iztro/./src/components/HistoryModal.tsx","webpack://react-iztro/./src/containers/FormContainer.tsx","webpack://react-iztro/./src/AIChat/components/TypingIndicator.tsx","webpack://react-iztro/./src/AIChat/hooks/useNetworkRequest.ts","webpack://react-iztro/./src/IzpalaceCenter/Item.tsx","webpack://react-iztro/./src/AIChat/hooks/useChatLayout.ts","webpack://react-iztro/./src/App.tsx","webpack://react-iztro/./src/IzpalaceCenter/IzpalaceCenter.tsx","webpack://react-iztro/./src/AIChat/components/ScrollToBottomButton.tsx","webpack://react-iztro/./src/AIChat/BackgroundAIIndicator.tsx","webpack://react-iztro/./src/containers/AppContainer.tsx","webpack://react-iztro/./src/AIChat/hooks/useMessageStorage.ts","webpack://react-iztro/./src/utils/useKeyboardDetector.ts","webpack://react-iztro/./src/components/FormPanel.tsx"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useHistoryManager = void 0;\nconst react_1 = require(\"react\");\nconst historyUtils_1 = require(\"../utils/historyUtils\");\nconst useHistoryManager = () => {\n    const [history, setHistory] = (0, react_1.useState)([]);\n    const [showHistoryModal, setShowHistoryModal] = (0, react_1.useState)(false);\n    const [searchTerm, setSearchTerm] = (0, react_1.useState)(\"\");\n    const [showPasswordInput, setShowPasswordInput] = (0, react_1.useState)(false);\n    const [password, setPassword] = (0, react_1.useState)(\"\");\n    const [isCloudStorageEnabled, setIsCloudStorageEnabled] = (0, react_1.useState)(false);\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [editingHistoryId, setEditingHistoryId] = (0, react_1.useState)(null);\n    // 初始化历史管理器和加载历史记录\n    (0, react_1.useEffect)(() => {\n        const initializeHistory = () => __awaiter(void 0, void 0, void 0, function* () {\n            // 初始化云存储状态\n            historyUtils_1.HistoryManager.initialize();\n            console.log('useHistoryManager: 初始化历史管理器');\n            // 获取历史记录（如果启用了云存储，会自动从云端加载）\n            const history = yield historyUtils_1.HistoryManager.getHistoryWithCloudSync();\n            setHistory(history);\n            setIsCloudStorageEnabled(historyUtils_1.HistoryManager.isCloudStorageEnabled());\n            console.log('useHistoryManager: 历史记录已加载，数量:', history.length);\n        });\n        initializeHistory();\n    }, []);\n    // 处理密码提交\n    const handlePasswordSubmit = (0, react_1.useCallback)(() => __awaiter(void 0, void 0, void 0, function* () {\n        if (!password.trim())\n            return;\n        setIsLoading(true);\n        try {\n            console.log('useHistoryManager: 提交密码启用云存储');\n            const success = yield historyUtils_1.HistoryManager.enableCloudStorage(password);\n            if (success) {\n                console.log('useHistoryManager: 云存储启用成功，重新加载历史记录');\n                setIsCloudStorageEnabled(true);\n                setShowPasswordInput(false);\n                setPassword(\"\");\n                // 刷新历史记录（从云端加载）\n                const history = yield historyUtils_1.HistoryManager.getHistoryWithCloudSync();\n                setHistory(history);\n                console.log('useHistoryManager: 历史记录已刷新，数量:', history.length);\n            }\n            else {\n                alert(\"密码错误，请重试\");\n            }\n        }\n        catch (error) {\n            console.error(\"启用云存储失败:\", error);\n            alert(\"启用云存储失败，请稍后再试\");\n        }\n        finally {\n            setIsLoading(false);\n        }\n    }), [password]);\n    // 处理历史记录保存\n    const handleSaveHistory = (0, react_1.useCallback)((item) => __awaiter(void 0, void 0, void 0, function* () {\n        if (editingHistoryId) {\n            // 如果正在编辑，更新现有记录\n            yield historyUtils_1.HistoryManager.updateHistory(editingHistoryId, item);\n            // 重置编辑状态\n            setEditingHistoryId(null);\n        }\n        else {\n            // 如果不是编辑，创建新记录\n            yield historyUtils_1.HistoryManager.saveHistory(item);\n        }\n        setHistory(historyUtils_1.HistoryManager.getHistory());\n    }), [editingHistoryId]);\n    // 处理历史记录删除\n    const handleDeleteHistory = (0, react_1.useCallback)((id) => __awaiter(void 0, void 0, void 0, function* () {\n        yield historyUtils_1.HistoryManager.deleteHistory(id);\n        setHistory(historyUtils_1.HistoryManager.getHistory());\n    }), []);\n    // 处理历史记录清空\n    const handleClearHistory = (0, react_1.useCallback)(() => __awaiter(void 0, void 0, void 0, function* () {\n        if (isCloudStorageEnabled) {\n            alert(\"云存储已启用，无法清空历史记录\");\n            return;\n        }\n        if (confirm('确定要清空所有历史记录吗？')) {\n            yield historyUtils_1.HistoryManager.clearHistory();\n            setHistory([]);\n        }\n    }), [isCloudStorageEnabled]);\n    // 过滤历史记录\n    const filteredHistory = history.filter(item => {\n        var _a;\n        return item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n            (item.type === 'synastry' && ((_a = item.person2) === null || _a === void 0 ? void 0 : _a.name.toLowerCase().includes(searchTerm.toLowerCase()))) ||\n            `${item.year}-${item.month}-${item.day}`.includes(searchTerm);\n    });\n    return {\n        history: filteredHistory,\n        showHistoryModal,\n        setShowHistoryModal,\n        searchTerm,\n        setSearchTerm,\n        showPasswordInput,\n        setShowPasswordInput,\n        password,\n        setPassword,\n        isCloudStorageEnabled,\n        isLoading,\n        editingHistoryId,\n        setEditingHistoryId,\n        handlePasswordSubmit,\n        handleSaveHistory,\n        handleDeleteHistory,\n        handleClearHistory,\n    };\n};\nexports.useHistoryManager = useHistoryManager;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAIChat = exports.AIChatProvider = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst AIChatContext = (0, react_1.createContext)(undefined);\nconst AIChatProvider = ({ children }) => {\n    const [messages, setMessages] = (0, react_1.useState)([]);\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [isGeneratingInBackground, setIsGeneratingInBackground] = (0, react_1.useState)(false);\n    const addMessage = (message) => {\n        setMessages(prev => [...prev, message]);\n    };\n    const updateLastMessage = (content) => {\n        setMessages(prev => {\n            const newMessages = [...prev];\n            if (newMessages.length > 0) {\n                const lastMessage = newMessages[newMessages.length - 1];\n                // 只有当最后一条消息是助手消息时才更新\n                if (lastMessage.role === \"assistant\") {\n                    newMessages[newMessages.length - 1] = Object.assign(Object.assign({}, lastMessage), { content });\n                }\n            }\n            return newMessages;\n        });\n    };\n    const clearMessages = () => {\n        setMessages([]);\n    };\n    return (react_1.default.createElement(AIChatContext.Provider, { value: {\n            messages,\n            setMessages,\n            isLoading,\n            setIsLoading,\n            isGeneratingInBackground,\n            setIsGeneratingInBackground,\n            addMessage,\n            updateLastMessage,\n            clearMessages\n        } }, children));\n};\nexports.AIChatProvider = AIChatProvider;\nconst useAIChat = () => {\n    const context = (0, react_1.useContext)(AIChatContext);\n    if (context === undefined) {\n        throw new Error('useAIChat must be used within an AIChatProvider');\n    }\n    return context;\n};\nexports.useAIChat = useAIChat;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./IzpalaceCenter\"), exports);\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Izstar = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst data_1 = require(\"iztro/lib/data\");\nconst i18n_1 = require(\"iztro/lib/i18n\");\nconst utils_1 = require(\"iztro/lib/utils\");\nconst Izstar = (_a) => {\n    var { horoscopeMutagens, activeHeavenlyStem, hoverHeavenlyStem, palaceHeavenlyStem } = _a, star = __rest(_a, [\"horoscopeMutagens\", \"activeHeavenlyStem\", \"hoverHeavenlyStem\", \"palaceHeavenlyStem\"]);\n    const mutagenStyle = (0, react_1.useMemo)(() => {\n        if (!activeHeavenlyStem) {\n            return \"\";\n        }\n        const mutagens = (0, utils_1.getMutagensByHeavenlyStem)((0, i18n_1.t)(activeHeavenlyStem));\n        const index = mutagens.indexOf(star.name);\n        if (index < 0) {\n            return \"\";\n        }\n        return `iztro-star-mutagen-${index}`;\n    }, [activeHeavenlyStem, star.name]);\n    const hoverMutagenStyle = (0, react_1.useMemo)(() => {\n        if (!hoverHeavenlyStem) {\n            return \"\";\n        }\n        const mutagens = (0, utils_1.getMutagensByHeavenlyStem)((0, i18n_1.t)(hoverHeavenlyStem));\n        const index = mutagens.indexOf(star.name);\n        if (index < 0) {\n            return \"\";\n        }\n        return `iztro-star-hover-mutagen-${index}`;\n    }, [hoverHeavenlyStem, star.name]);\n    const selfMutagenStyle = (0, react_1.useMemo)(() => {\n        if (!palaceHeavenlyStem || activeHeavenlyStem || hoverHeavenlyStem) {\n            return undefined;\n        }\n        const mutagens = (0, utils_1.getMutagensByHeavenlyStem)((0, i18n_1.t)(palaceHeavenlyStem));\n        const index = mutagens.indexOf(star.name);\n        if (index < 0) {\n            return \"\";\n        }\n        return `iztro-star-self-mutagen-${index}`;\n    }, [palaceHeavenlyStem, activeHeavenlyStem, hoverHeavenlyStem]);\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-star\", `iztro-star-${star.type}`) },\n        react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"star-with-mutagen\", mutagenStyle, selfMutagenStyle, hoverMutagenStyle, {\n                \"iztro-star-self-mutagen\": !!selfMutagenStyle,\n            }) }, star.name),\n        react_1.default.createElement(\"i\", { className: (0, classnames_1.default)(\"iztro-star-brightness\") }, star.brightness),\n        star.mutagen && (react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"iztro-star-mutagen\", `mutagen-${data_1.MUTAGEN.indexOf((0, i18n_1.kot)(star.mutagen))}`) }, star.mutagen)), horoscopeMutagens === null || horoscopeMutagens === void 0 ? void 0 :\n        horoscopeMutagens.map((item) => {\n            if (item.mutagen.includes(star.name) && item.show) {\n                return (react_1.default.createElement(\"span\", { key: item.scope, className: (0, classnames_1.default)(\"iztro-star-mutagen\", `mutagen-${item.scope}`) }, (0, i18n_1.t)(data_1.MUTAGEN[item.mutagen.indexOf(star.name)])));\n            }\n        })));\n};\nexports.Izstar = Izstar;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\n/**\n * 骨架屏加载组件\n * 提供多种类型的骨架屏加载效果，改善用户体验\n */\nconst SkeletonLoader = ({ type = 'message', count = 1, animate = true, }) => {\n    const renderMessageSkeleton = () => (react_1.default.createElement(\"div\", { className: \"skeleton-message\" },\n        react_1.default.createElement(\"div\", { className: \"skeleton-avatar\" }),\n        react_1.default.createElement(\"div\", { className: \"skeleton-content\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-line skeleton-short\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-line\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-line skeleton-long\" }))));\n    const renderChatSkeleton = () => (react_1.default.createElement(\"div\", { className: \"skeleton-chat\" },\n        react_1.default.createElement(\"div\", { className: \"skeleton-header\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-title\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-subtitle\" })),\n        react_1.default.createElement(\"div\", { className: \"skeleton-messages\" }, Array.from({ length: 3 }).map((_, index) => (react_1.default.createElement(\"div\", { key: index, className: \"skeleton-message-wrapper\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-message-avatar\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-message-content\" },\n                react_1.default.createElement(\"div\", { className: \"skeleton-message-line\" }),\n                react_1.default.createElement(\"div\", { className: \"skeleton-message-line skeleton-short\" })))))),\n        react_1.default.createElement(\"div\", { className: \"skeleton-input\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-input-field\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-input-button\" }))));\n    const renderInputSkeleton = () => (react_1.default.createElement(\"div\", { className: \"skeleton-input-container\" },\n        react_1.default.createElement(\"div\", { className: \"skeleton-input-field\" }),\n        react_1.default.createElement(\"div\", { className: \"skeleton-input-button\" })));\n    const renderSkeletons = () => {\n        const skeletons = [];\n        for (let i = 0; i < count; i++) {\n            switch (type) {\n                case 'message':\n                    skeletons.push(renderMessageSkeleton());\n                    break;\n                case 'chat':\n                    skeletons.push(renderChatSkeleton());\n                    break;\n                case 'input':\n                    skeletons.push(renderInputSkeleton());\n                    break;\n                default:\n                    skeletons.push(renderMessageSkeleton());\n            }\n        }\n        return skeletons;\n    };\n    return (react_1.default.createElement(\"div\", { className: `skeleton-loader ${animate ? 'skeleton-animate' : ''}` }, renderSkeletons()));\n};\nexports.default = SkeletonLoader;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./Iztrolabe\"), exports);\n__exportStar(require(\"./Iztrolabe.type\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useVirtualScroll = void 0;\nconst react_1 = require(\"react\");\n/**\n * 虚拟滚动Hook\n * 支持动态高度的虚拟滚动，优化长列表性能\n */\nconst useVirtualScroll = (items, containerRef, options = {}) => {\n    const { itemHeight = 80, // 默认项目高度\n    overscan = 5, // 预渲染的项目数量\n    defaultHeight = 80, // 默认高度\n     } = options;\n    const [scrollTop, setScrollTop] = (0, react_1.useState)(0);\n    const [containerHeight, setContainerHeight] = (0, react_1.useState)(0);\n    const [measuredItems, setMeasuredItems] = (0, react_1.useState)(new Map());\n    const [isScrolling, setIsScrolling] = (0, react_1.useState)(false);\n    const scrollTimeoutRef = (0, react_1.useRef)(null);\n    // 计算总高度\n    const totalHeight = (0, react_1.useMemo)(() => {\n        let height = 0;\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            height += (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n        }\n        return height;\n    }, [items, measuredItems, defaultHeight]);\n    // 计算可见项目\n    const visibleRange = (0, react_1.useMemo)(() => {\n        let startOffset = 0;\n        let startIndex = 0;\n        let endIndex = items.length;\n        // 找到起始索引\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            const itemHeight = (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            if (startOffset + itemHeight > scrollTop) {\n                startIndex = Math.max(0, i - overscan);\n                break;\n            }\n            startOffset += itemHeight;\n        }\n        // 找到结束索引\n        let currentOffset = startOffset;\n        for (let i = startIndex; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            const itemHeight = (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            if (currentOffset > scrollTop + containerHeight) {\n                endIndex = Math.min(items.length, i + overscan);\n                break;\n            }\n            currentOffset += itemHeight;\n        }\n        return { startIndex, endIndex, startOffset };\n    }, [items, scrollTop, containerHeight, measuredItems, defaultHeight, overscan]);\n    // 测量项目高度\n    const measureItem = (0, react_1.useCallback)((id, height) => {\n        setMeasuredItems(prev => {\n            const newMap = new Map(prev);\n            const existing = newMap.get(id);\n            // 只有当高度变化时才更新\n            if (!existing || existing.height !== height) {\n                newMap.set(id, { id, height, offset: (existing === null || existing === void 0 ? void 0 : existing.offset) || 0 });\n                // 更新后续项目的偏移量\n                let offset = 0;\n                for (let i = 0; i < items.length; i++) {\n                    const itemId = `${items[i].role}-${i}`;\n                    const item = newMap.get(itemId);\n                    if (item) {\n                        newMap.set(itemId, Object.assign(Object.assign({}, item), { offset }));\n                        offset += item.height;\n                    }\n                    else {\n                        offset += defaultHeight;\n                    }\n                }\n            }\n            return newMap;\n        });\n    }, [items, defaultHeight]);\n    // 处理滚动事件\n    const handleScroll = (0, react_1.useCallback)(() => {\n        if (containerRef.current) {\n            setScrollTop(containerRef.current.scrollTop);\n            setIsScrolling(true);\n            // 清除之前的超时\n            if (scrollTimeoutRef.current) {\n                clearTimeout(scrollTimeoutRef.current);\n            }\n            // 设置新的超时\n            scrollTimeoutRef.current = setTimeout(() => {\n                setIsScrolling(false);\n            }, 150);\n        }\n    }, [containerRef]);\n    // 更新容器高度\n    (0, react_1.useEffect)(() => {\n        const updateContainerHeight = () => {\n            if (containerRef.current) {\n                setContainerHeight(containerRef.current.clientHeight);\n            }\n        };\n        updateContainerHeight();\n        window.addEventListener('resize', updateContainerHeight);\n        return () => {\n            window.removeEventListener('resize', updateContainerHeight);\n            if (scrollTimeoutRef.current) {\n                clearTimeout(scrollTimeoutRef.current);\n            }\n        };\n    }, [containerRef]);\n    // 添加滚动事件监听器\n    (0, react_1.useEffect)(() => {\n        const container = containerRef.current;\n        if (container) {\n            container.addEventListener('scroll', handleScroll, { passive: true });\n            return () => {\n                container.removeEventListener('scroll', handleScroll);\n            };\n        }\n    }, [containerRef, handleScroll]);\n    // 计算可见项目\n    const visibleItems = (0, react_1.useMemo)(() => {\n        const result = [];\n        let offset = 0;\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            const itemHeight = (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            if (i >= visibleRange.startIndex && i < visibleRange.endIndex) {\n                result.push({\n                    item,\n                    index: i,\n                    offset,\n                    height: itemHeight,\n                });\n            }\n            offset += itemHeight;\n        }\n        return result;\n    }, [items, measuredItems, visibleRange, defaultHeight]);\n    // 滚动到指定项目\n    const scrollToIndex = (0, react_1.useCallback)((index) => {\n        if (containerRef.current) {\n            let offset = 0;\n            for (let i = 0; i < index && i < items.length; i++) {\n                const measured = measuredItems.get(`${items[i].role}-${i}`);\n                offset += (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            }\n            containerRef.current.scrollTo({\n                top: offset,\n                behavior: 'smooth',\n            });\n        }\n    }, [containerRef, items, measuredItems, defaultHeight]);\n    // 滚动到底部\n    const scrollToBottom = (0, react_1.useCallback)(() => {\n        if (containerRef.current) {\n            containerRef.current.scrollTo({\n                top: totalHeight,\n                behavior: 'smooth',\n            });\n        }\n    }, [containerRef, totalHeight]);\n    return {\n        visibleItems,\n        totalHeight,\n        isScrolling,\n        measureItem,\n        scrollToIndex,\n        scrollToBottom,\n        scrollTop,\n    };\n};\nexports.useVirtualScroll = useVirtualScroll;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst MessageItem_1 = __importDefault(require(\"./MessageItem\"));\nconst TypingIndicator_1 = __importDefault(require(\"./TypingIndicator\"));\nconst SkeletonLoader_1 = __importDefault(require(\"./SkeletonLoader\"));\nconst useMessageStorage_1 = require(\"../hooks/useMessageStorage\");\nconst useVirtualScroll_1 = require(\"../hooks/useVirtualScroll\");\n// 使用React.memo优化组件重渲染\nconst MessageList = react_1.default.memo(({ messages, isLoading, generationFailed, lastFailedMessage, onRegenerate, messagesContainerRef, lastMessageRef, isStreaming = false, useMessageStorage = false, // 默认不使用消息存储，保持向后兼容\nuseVirtualScroll = false, // 默认不使用虚拟滚动，保持向后兼容\n }) => {\n    // 使用消息存储和分页功能\n    const messageStorage = useMessageStorage ? (0, useMessageStorage_1.useMessageStorage)({\n        maxMessagesInMemory: 200, // 内存中最多保存200条消息\n        pageSize: 30, // 每页显示30条消息\n    }) : null;\n    const { visibleMessages: storedVisibleMessages = messages, isLoading: isStorageLoading = false, hasMore = false, addMessages = () => { }, loadMoreMessages = () => { }, resetToLatest = () => { } } = messageStorage || {};\n    // 确定使用哪些消息\n    const displayMessages = useMessageStorage ? storedVisibleMessages : messages;\n    // 使用虚拟滚动\n    const virtualScroll = useVirtualScroll ? (0, useVirtualScroll_1.useVirtualScroll)(displayMessages, messagesContainerRef, {\n        itemHeight: 80, // 默认项目高度\n        overscan: 3, // 预渲染的项目数量\n        defaultHeight: 80, // 默认高度\n    }) : null;\n    const { visibleItems = [], totalHeight = 0, isScrolling = false, measureItem = () => { }, scrollToIndex = () => { }, scrollToBottom = () => { }, } = virtualScroll || {};\n    // 监听外部消息变化，更新存储\n    (0, react_1.useEffect)(() => {\n        if (useMessageStorage && messages.length > 0) {\n            // 只添加新的消息\n            const lastStoredMessage = storedVisibleMessages[storedVisibleMessages.length - 1];\n            const newMessages = lastStoredMessage\n                ? messages.filter(msg => !storedVisibleMessages.some((storedMsg) => storedMsg.role === msg.role && storedMsg.content === msg.content))\n                : messages;\n            if (newMessages.length > 0) {\n                addMessages(newMessages);\n            }\n        }\n    }, [messages, storedVisibleMessages, useMessageStorage, addMessages]);\n    // 滚动到顶部的观察器，用于加载更多消息\n    const topObserverRef = (0, react_1.useRef)(null);\n    // 设置Intersection Observer来检测滚动到顶部\n    (0, react_1.useEffect)(() => {\n        if (!useMessageStorage || !hasMore || isStorageLoading)\n            return;\n        const observer = new IntersectionObserver((entries) => {\n            if (entries[0].isIntersecting) {\n                loadMoreMessages();\n            }\n        }, {\n            root: messagesContainerRef.current,\n            threshold: 0.1,\n            rootMargin: '100px'\n        });\n        if (topObserverRef.current) {\n            observer.observe(topObserverRef.current);\n        }\n        return () => {\n            if (topObserverRef.current) {\n                observer.unobserve(topObserverRef.current);\n            }\n        };\n    }, [useMessageStorage, hasMore, isStorageLoading, loadMoreMessages, messagesContainerRef]);\n    // 自动滚动到底部\n    (0, react_1.useEffect)(() => {\n        if (!isScrolling && displayMessages.length > 0) {\n            scrollToBottom();\n        }\n    }, [displayMessages.length, isScrolling, scrollToBottom]);\n    // 使用useMemo优化消息列表渲染，避免不必要的重渲染\n    const messageItems = (0, react_1.useMemo)(() => {\n        if (useVirtualScroll) {\n            return visibleItems.map(({ item, index, offset, height }) => {\n                const originalIndex = displayMessages.indexOf(item);\n                const isLastMessage = originalIndex === displayMessages.length - 1;\n                return (react_1.default.createElement(\"div\", { key: `${item.role}-${originalIndex}-${item.content.slice(0, 20)}`, className: \"message-item-container\", style: {\n                        position: 'absolute',\n                        top: offset,\n                        left: 0,\n                        right: 0,\n                        height: height || 'auto',\n                    }, ref: (el) => {\n                        if (el) {\n                            // 测量项目高度\n                            const measuredHeight = el.getBoundingClientRect().height;\n                            measureItem(`${item.role}-${originalIndex}`, measuredHeight);\n                        }\n                    } },\n                    react_1.default.createElement(MessageItem_1.default, { message: item, isLastMessage: isLastMessage, showRegenerate: generationFailed &&\n                            item.role === \"assistant\" &&\n                            isLastMessage, onRegenerate: onRegenerate, messageRef: isLastMessage ? lastMessageRef : undefined, isStreaming: isStreaming && isLastMessage && item.role === \"assistant\", showActions: item.role === \"assistant\" && isLastMessage && !isStreaming })));\n            });\n        }\n        else {\n            return displayMessages.map((message, index) => {\n                const isLastMessage = index === displayMessages.length - 1;\n                return (react_1.default.createElement(MessageItem_1.default, { key: `${message.role}-${index}-${message.content.slice(0, 20)}`, message: message, isLastMessage: isLastMessage, showRegenerate: generationFailed &&\n                        message.role === \"assistant\" &&\n                        isLastMessage, onRegenerate: onRegenerate, messageRef: isLastMessage ? lastMessageRef : undefined, isStreaming: isStreaming && isLastMessage && message.role === \"assistant\", showActions: message.role === \"assistant\" && isLastMessage && !isStreaming }));\n            });\n        }\n    }, [displayMessages, visibleItems, useVirtualScroll, isLoading, generationFailed, isStreaming, onRegenerate, lastMessageRef, measureItem]);\n    return (react_1.default.createElement(\"div\", { ref: messagesContainerRef, className: \"chat-messages\" },\n        useVirtualScroll && (react_1.default.createElement(\"div\", { className: \"virtual-scroll-container\" }, messageItems)),\n        !useVirtualScroll && (react_1.default.createElement(react_1.default.Fragment, null,\n            useMessageStorage && hasMore && (react_1.default.createElement(\"div\", { ref: topObserverRef, className: \"load-more-trigger\" }, isStorageLoading ? '加载中...' : '向上滚动加载更多消息')),\n            messageItems)),\n        isLoading && (react_1.default.createElement(\"div\", { className: \"message assistant-message\" },\n            react_1.default.createElement(TypingIndicator_1.default, null))),\n        (isStorageLoading || (isLoading && displayMessages.length === 0)) && (react_1.default.createElement(\"div\", { className: \"chat-skeleton-fallback\" },\n            react_1.default.createElement(SkeletonLoader_1.default, { type: \"message\", count: 3, animate: true }))),\n        react_1.default.createElement(\"div\", { ref: lastMessageRef, className: \"bottom-observer\" })));\n});\nexports.default = MessageList;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nrequire(\"../styles/chat/chat.css\");\nrequire(\"../styles/index.css\");\n// 懒加载ChatContainer组件\nconst ChatContainer = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require('./components/ChatContainer'))));\nconst SkeletonLoader = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require('./components/SkeletonLoader'))));\n// 加载状态组件\nconst ChatLoadingFallback = () => (react_1.default.createElement(\"div\", { className: \"chat-loading-fallback\" },\n    react_1.default.createElement(\"div\", null, \"\\u52A0\\u8F7D\\u4E2D...\")));\n// 骨架屏加载组件\nconst ChatSkeletonFallback = () => (react_1.default.createElement(\"div\", { className: \"chat-skeleton-fallback\" },\n    react_1.default.createElement(react_1.Suspense, { fallback: react_1.default.createElement(ChatLoadingFallback, null) },\n        react_1.default.createElement(SkeletonLoader, { type: \"chat\", animate: true }))));\n/**\n * AI 聊天组件 - 优化版本\n *\n * 这个组件现在是一个轻量级的容器组件，主要职责是：\n * 1. 接收 props 并传递给 ChatContainer\n * 2. 提供清晰的组件接口\n * 3. 保持与原有 API 的兼容性\n * 4. 实现懒加载，提高初始加载性能\n *\n * 所有的业务逻辑和状态管理都已经移到 ChatContainer 和相关的 Hooks 中\n */\nconst AIChat = ({ astrolabe, synastryAstrolabe, isSynastryMode = false, personNames = { person1: \"第一个人\", person2: \"第二个人\" }, isVisible = true, }) => {\n    const [shouldLoadChat, setShouldLoadChat] = (0, react_1.useState)(isVisible);\n    // 当组件变为可见时，延迟加载聊天组件\n    (0, react_1.useEffect)(() => {\n        if (isVisible) {\n            // 使用requestAnimationFrame确保在下一帧加载，避免阻塞主线程\n            requestAnimationFrame(() => {\n                setShouldLoadChat(true);\n            });\n        }\n    }, [isVisible]);\n    // 如果组件不可见，不渲染任何内容\n    if (!isVisible) {\n        return null;\n    }\n    return (react_1.default.createElement(react_1.Suspense, { fallback: react_1.default.createElement(ChatSkeletonFallback, null) }, shouldLoadChat && (react_1.default.createElement(ChatContainer, { astrolabe: astrolabe, synastryAstrolabe: synastryAstrolabe, isSynastryMode: isSynastryMode, personNames: personNames, isVisible: isVisible }))));\n};\nexports.default = react_1.default.memo(AIChat);\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HistoryManager = void 0;\n/**\n * 导入云存储服务\n */\nconst cloudStorage_1 = require(\"./cloudStorage\");\n/**\n * 历史记录管理工具\n */\nclass HistoryManager {\n    /**\n     * 初始化方法，在类加载时调用\n     */\n    static initialize() {\n        // 初始化云存储服务\n        cloudStorage_1.CloudStorageService.initialize();\n        // 检查云存储是否已启用\n        this.isCloudEnabled = cloudStorage_1.CloudStorageService.isAuth();\n    }\n    /**\n     * 启用云存储\n     * @param password 云存储密码\n     * @returns 是否启用成功\n     */\n    static enableCloudStorage(password) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const isAuthenticated = yield cloudStorage_1.CloudStorageService.authenticate(password);\n                if (isAuthenticated) {\n                    this.isCloudEnabled = true;\n                    return true;\n                }\n                return false;\n            }\n            catch (error) {\n                console.error('启用云存储失败:', error);\n                return false;\n            }\n        });\n    }\n    /**\n     * 检查云存储是否已启用\n     * @returns 云存储是否已启用\n     */\n    static isCloudStorageEnabled() {\n        // 动态检查云存储状态，确保页面刷新后能正确恢复\n        this.isCloudEnabled = cloudStorage_1.CloudStorageService.isAuth();\n        return this.isCloudEnabled;\n    }\n    /**\n     * 禁用云存储\n     */\n    static disableCloudStorage() {\n        this.isCloudEnabled = false;\n        cloudStorage_1.CloudStorageService.clearAuthentication();\n    }\n    /**\n     * 从云端加载历史记录到本地\n     */\n    static loadHistoryFromCloud() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // 动态检查云存储状态\n            if (!this.isCloudStorageEnabled())\n                return;\n            try {\n                console.log('开始从云端加载历史记录...');\n                // 获取所有历史记录ID\n                const ids = yield cloudStorage_1.CloudStorageService.getHistoryIds();\n                console.log('获取到的历史记录ID列表:', ids);\n                if (ids.length === 0) {\n                    console.log('云端没有历史记录');\n                    return;\n                }\n                // 批量获取历史记录\n                const cloudHistory = yield cloudStorage_1.CloudStorageService.batchDownloadHistoryItems(ids);\n                console.log('从云端获取的历史记录:', cloudHistory);\n                console.log('历史记录数量:', cloudHistory.length);\n                // 检查每条记录的格式\n                cloudHistory.forEach((item, index) => {\n                    console.log(`记录 ${index}:`, item);\n                    console.log(`记录 ${index} 的类型:`, typeof item);\n                    console.log(`记录 ${index} 的键:`, Object.keys(item));\n                });\n                // 获取本地历史记录\n                const localHistory = this.getHistory();\n                console.log('本地历史记录:', localHistory);\n                // 合并本地和云端的历史记录\n                const mergedHistory = this.mergeHistories(localHistory, cloudHistory);\n                console.log('合并后的历史记录:', mergedHistory);\n                // 限制历史记录数量，最多保存50条\n                if (mergedHistory.length > 50) {\n                    mergedHistory.splice(50);\n                }\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(mergedHistory));\n                console.log('历史记录已保存到本地');\n            }\n            catch (error) {\n                console.error('从云端加载历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 保存历史记录到云端\n     */\n    static saveHistoryToCloud() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isCloudEnabled)\n                return;\n            try {\n                const history = this.getHistory();\n                // 上传每个历史记录\n                for (const item of history) {\n                    yield cloudStorage_1.CloudStorageService.uploadHistoryItem(item);\n                }\n            }\n            catch (error) {\n                console.error('保存历史记录到云端失败:', error);\n            }\n        });\n    }\n    /**\n     * 合并本地和云端的历史记录\n     * @param localHistory 本地历史记录\n     * @param cloudHistory 云端历史记录\n     * @returns 合并后的历史记录\n     */\n    static mergeHistories(localHistory, cloudHistory) {\n        console.log('开始合并历史记录...');\n        console.log('本地历史记录数量:', localHistory.length);\n        console.log('云端历史记录数量:', cloudHistory.length);\n        const mergedMap = new Map();\n        // 先添加云端历史记录\n        cloudHistory.forEach(item => {\n            mergedMap.set(item.id, item);\n            console.log('添加云端记录:', item.id);\n        });\n        // 再添加本地历史记录，如果ID相同则保留时间戳较新的\n        localHistory.forEach(item => {\n            const existingItem = mergedMap.get(item.id);\n            if (!existingItem) {\n                mergedMap.set(item.id, item);\n                console.log('添加本地记录（云端不存在）:', item.id);\n            }\n            else if (item.timestamp > existingItem.timestamp) {\n                mergedMap.set(item.id, item);\n                console.log('更新记录（本地版本更新）:', item.id);\n            }\n            else {\n                console.log('跳过本地记录（云端版本更新）:', item.id);\n            }\n        });\n        // 转换为数组并按时间戳降序排序\n        const mergedHistory = Array.from(mergedMap.values()).sort((a, b) => b.timestamp - a.timestamp);\n        console.log('合并后的历史记录数量:', mergedHistory.length);\n        return mergedHistory;\n    }\n    /**\n     * 保存历史记录到本地存储，如果云存储已启用则同步到云端\n     * @param item 历史记录项\n     */\n    static saveHistory(item) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const history = this.getHistory();\n                const newHistoryItem = Object.assign(Object.assign({}, item), { id: this.generateId(), timestamp: Date.now() });\n                // 添加到历史记录开头\n                history.unshift(newHistoryItem);\n                // 限制历史记录数量，最多保存50条\n                if (history.length > 50) {\n                    history.splice(50);\n                }\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(history));\n                // 动态检查云存储状态，如果已启用则保存到云端\n                if (this.isCloudStorageEnabled()) {\n                    yield cloudStorage_1.CloudStorageService.uploadHistoryItem(newHistoryItem);\n                }\n            }\n            catch (error) {\n                console.error('保存历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 从本地存储获取历史记录\n     * @returns 历史记录数组\n     */\n    static getHistory() {\n        try {\n            const historyJson = localStorage.getItem(this.STORAGE_KEY);\n            return historyJson ? JSON.parse(historyJson) : [];\n        }\n        catch (error) {\n            console.error('获取历史记录失败:', error);\n            return [];\n        }\n    }\n    /**\n     * 获取历史记录（如果启用了云存储，会自动从云端加载）\n     * @returns 历史记录数组\n     */\n    static getHistoryWithCloudSync() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // 动态检查云存储状态\n            const isCloudEnabled = this.isCloudStorageEnabled();\n            console.log('getHistoryWithCloudSync 被调用，云存储状态:', isCloudEnabled);\n            // 如果云存储已启用，从云端加载\n            if (isCloudEnabled) {\n                console.log('开始从云端加载历史记录...');\n                yield this.loadHistoryFromCloud();\n            }\n            else {\n                console.log('云存储未启用，只返回本地历史记录');\n            }\n            const localHistory = this.getHistory();\n            console.log('返回的历史记录:', localHistory);\n            return localHistory;\n        });\n    }\n    /**\n     * 更新指定ID的历史记录\n     * @param id 历史记录ID\n     * @param updatedItem 更新后的历史记录数据\n     */\n    static updateHistory(id, updatedItem) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const history = this.getHistory();\n                const itemIndex = history.findIndex(item => item.id === id);\n                if (itemIndex === -1) {\n                    console.error('未找到要更新的历史记录:', id);\n                    return;\n                }\n                // 更新历史记录，保留原有的ID和时间戳\n                history[itemIndex] = Object.assign(Object.assign({}, updatedItem), { id: id, timestamp: history[itemIndex].timestamp });\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(history));\n                // 动态检查云存储状态，如果已启用则更新云端记录\n                if (this.isCloudStorageEnabled()) {\n                    // 先删除云端记录，再上传更新后的记录\n                    yield cloudStorage_1.CloudStorageService.deleteHistoryItem(id);\n                    yield cloudStorage_1.CloudStorageService.uploadHistoryItem(history[itemIndex]);\n                }\n            }\n            catch (error) {\n                console.error('更新历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 删除指定ID的历史记录\n     * @param id 历史记录ID\n     */\n    static deleteHistory(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const history = this.getHistory();\n                const filteredHistory = history.filter(item => item.id !== id);\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(filteredHistory));\n                // 动态检查云存储状态，如果已启用则删除云端记录\n                if (this.isCloudStorageEnabled()) {\n                    yield cloudStorage_1.CloudStorageService.deleteHistoryItem(id);\n                }\n            }\n            catch (error) {\n                console.error('删除历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 清空所有历史记录\n     */\n    static clearHistory() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                localStorage.removeItem(this.STORAGE_KEY);\n                // 动态检查云存储状态，如果已启用则清空云端记录\n                if (this.isCloudStorageEnabled()) {\n                    yield cloudStorage_1.CloudStorageService.clearAllHistory();\n                }\n            }\n            catch (error) {\n                console.error('清空历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 生成唯一ID\n     * @returns 唯一ID字符串\n     */\n    static generateId() {\n        return Date.now().toString(36) + Math.random().toString(36).substr(2);\n    }\n    /**\n     * 格式化日期显示\n     * @param timestamp 时间戳\n     * @returns 格式化后的日期字符串\n     */\n    static formatDate(timestamp) {\n        const date = new Date(timestamp);\n        return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\n    }\n}\nexports.HistoryManager = HistoryManager;\nHistoryManager.STORAGE_KEY = 'iztro_history';\nHistoryManager.isCloudEnabled = false;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst react_markdown_1 = __importDefault(require(\"react-markdown\"));\nconst remark_gfm_1 = __importDefault(require(\"remark-gfm\"));\nconst remark_breaks_1 = __importDefault(require(\"remark-breaks\"));\n/**\n * 懒加载图片组件\n * 实现图片懒加载，提高页面加载性能\n */\nconst LazyImage = (_a) => {\n    var { src, alt, className = \"markdown-img\" } = _a, props = __rest(_a, [\"src\", \"alt\", \"className\"]);\n    const [isLoaded, setIsLoaded] = (0, react_1.useState)(false);\n    const [isInView, setIsInView] = (0, react_1.useState)(false);\n    const imgRef = (0, react_1.useRef)(null);\n    (0, react_1.useEffect)(() => {\n        const observer = new IntersectionObserver(([entry]) => {\n            if (entry.isIntersecting) {\n                setIsInView(true);\n                observer.disconnect();\n            }\n        }, {\n            rootMargin: '100px', // 提前100px开始加载\n            threshold: 0.1\n        });\n        if (imgRef.current) {\n            observer.observe(imgRef.current);\n        }\n        return () => {\n            if (imgRef.current) {\n                observer.unobserve(imgRef.current);\n            }\n        };\n    }, []);\n    const handleLoad = () => {\n        setIsLoaded(true);\n    };\n    return (react_1.default.createElement(\"div\", { className: \"markdown-img-container\" },\n        !isLoaded && (react_1.default.createElement(\"div\", { className: \"markdown-img-placeholder\" },\n            react_1.default.createElement(\"div\", { className: \"loading-spinner\" }))),\n        react_1.default.createElement(\"img\", Object.assign({ ref: imgRef, src: isInView ? src : undefined, alt: alt, className: `${className} ${isLoaded ? 'loaded' : ''}`, onLoad: handleLoad }, props))));\n};\n/**\n * Markdown格式化组件\n * 将markdown文本转换为格式化的HTML元素\n * 优化版本：改进换行处理、添加更多元素支持、优化样式\n */\nconst MarkdownFormatter = ({ content }) => {\n    // 预处理内容，简化处理 - 使用useMemo避免重复计算\n    const processedContent = (0, react_1.useMemo)(() => {\n        return content\n            .replace(/\\n{3,}/g, '\\n\\n') // 将3个或更多换行减少为2个\n            .replace(/^\\s+|\\s+$/g, ''); // 去除首尾空白\n    }, [content]);\n    // 使用useMemo优化components对象，避免每次渲染都重新创建\n    const components = (0, react_1.useMemo)(() => ({\n        // 自定义标题样式\n        h1: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h1\", Object.assign({ className: \"markdown-h1\" }, props), children));\n        },\n        h2: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h2\", Object.assign({ className: \"markdown-h2\" }, props), children));\n        },\n        h3: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h3\", Object.assign({ className: \"markdown-h3\" }, props), children));\n        },\n        h4: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h4\", Object.assign({ className: \"markdown-h4\" }, props), children));\n        },\n        h5: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h5\", Object.assign({ className: \"markdown-h5\" }, props), children));\n        },\n        h6: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h6\", Object.assign({ className: \"markdown-h6\" }, props), children));\n        },\n        // 自定义段落样式\n        p: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"p\", Object.assign({ className: \"markdown-p\" }, props), children));\n        },\n        // 自定义列表样式\n        ul: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"ul\", Object.assign({ className: \"markdown-ul\" }, props), children));\n        },\n        ol: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"ol\", Object.assign({ className: \"markdown-ol\" }, props), children));\n        },\n        li: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            // 检查是否是任务列表项\n            const isTask = react_1.default.Children.toArray(children).some((child) => react_1.default.isValidElement(child) && child.type === 'input');\n            return (react_1.default.createElement(\"li\", Object.assign({ className: `markdown-li ${isTask ? 'task-list-item' : ''}` }, props), children));\n        },\n        // 自定义链接样式\n        a: (_a) => {\n            var { href, children } = _a, props = __rest(_a, [\"href\", \"children\"]);\n            return (react_1.default.createElement(\"a\", Object.assign({ href: href, className: \"markdown-a\", target: \"_blank\", rel: \"noopener noreferrer\" }, props), children));\n        },\n        // 自定义代码样式\n        code: (props) => {\n            const { inline, className, children } = props, rest = __rest(props, [\"inline\", \"className\", \"children\"]);\n            const match = /language-(\\w+)/.exec(className || '');\n            const language = match ? match[1] : '';\n            return !inline && match ? (react_1.default.createElement(\"div\", { className: \"markdown-code-wrapper\" },\n                react_1.default.createElement(\"div\", { className: \"markdown-code-header\" },\n                    react_1.default.createElement(\"span\", { className: \"markdown-code-language\" }, language)),\n                react_1.default.createElement(\"code\", Object.assign({ className: `markdown-code-block ${className}` }, rest), children))) : (react_1.default.createElement(\"code\", Object.assign({ className: \"markdown-code-inline\" }, rest), children));\n        },\n        // 自定义代码块样式\n        pre: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"pre\", Object.assign({ className: \"markdown-pre\" }, props), children));\n        },\n        // 自定义引用样式\n        blockquote: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"blockquote\", Object.assign({ className: \"markdown-blockquote\" }, props), children));\n        },\n        // 自定义表格样式 - 改进响应式支持\n        table: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"div\", { className: \"markdown-table-wrapper\" },\n                react_1.default.createElement(\"table\", Object.assign({ className: \"markdown-table\" }, props), children)));\n        },\n        thead: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"thead\", Object.assign({ className: \"markdown-thead\" }, props), children));\n        },\n        tbody: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"tbody\", Object.assign({ className: \"markdown-tbody\" }, props), children));\n        },\n        tr: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"tr\", Object.assign({ className: \"markdown-tr\" }, props), children));\n        },\n        th: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"th\", Object.assign({ className: \"markdown-th\" }, props), children));\n        },\n        td: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"td\", Object.assign({ className: \"markdown-td\" }, props), children));\n        },\n        // 自定义强调样式\n        strong: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"strong\", Object.assign({ className: \"markdown-strong\" }, props), children));\n        },\n        em: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"em\", Object.assign({ className: \"markdown-em\" }, props), children));\n        },\n        // 自定义分割线样式\n        hr: (_a) => {\n            var props = __rest(_a, []);\n            return react_1.default.createElement(\"hr\", Object.assign({ className: \"markdown-hr\" }, props));\n        },\n        // 添加对图片的支持 - 优化版本，支持懒加载\n        img: (_a) => {\n            var { src, alt } = _a, props = __rest(_a, [\"src\", \"alt\"]);\n            // 使用自定义图片组件实现懒加载\n            return react_1.default.createElement(LazyImage, Object.assign({ src: src, alt: alt || '' }, props));\n        },\n        // 添加对删除线的支持\n        del: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"del\", Object.assign({ className: \"markdown-del\" }, props), children));\n        },\n        // 添加对任务列表的支持\n        input: (_a) => {\n            var { checked, type } = _a, props = __rest(_a, [\"checked\", \"type\"]);\n            return (react_1.default.createElement(\"input\", Object.assign({ type: \"checkbox\", checked: checked, readOnly: true, className: \"markdown-task-checkbox\" }, props)));\n        },\n    }), []);\n    // 优化长内容渲染，使用memo避免不必要的重渲染\n    const markdownContent = (0, react_1.useMemo)(() => (react_1.default.createElement(react_markdown_1.default, { remarkPlugins: [remark_gfm_1.default, remark_breaks_1.default], rehypePlugins: [], components: components }, processedContent)), [processedContent, components]);\n    return (react_1.default.createElement(\"div\", { className: \"markdown-content\" }, markdownContent));\n};\nexports.default = react_1.default.memo(MarkdownFormatter);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getLastUserMessage = exports.filterValidMessages = exports.isValidMessage = exports.createErrorMessage = exports.processRemainingBuffer = exports.processStreamChunk = exports.buildAIMessages = exports.buildSystemPrompt = exports.formatAstrolabeForSynastry = void 0;\nconst astrolabeFormatter_1 = require(\"../../utils/astrolabeFormatter\");\n/**\n * 格式化星盘数据为AI可理解的格式（合盘模式专用）\n */\nconst formatAstrolabeForSynastry = (astrolabe, currentTime = new Date()) => {\n    if (!astrolabe) {\n        return '暂无星盘数据';\n    }\n    const formattedTime = currentTime.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        hour12: false\n    });\n    // 精简版只包含最关键的信息\n    let result = `\n=== 紫微斗数星盘数据（精简版）===\n当前时间：${formattedTime}\n\n基本信息：\n性别：${astrolabe.gender === 'male' ? '男' : '女'}\n阳历日期：${astrolabe.solarDate}\n干支纪年：${astrolabe.chineseDate}\n出生时辰：${astrolabe.time}\n命宫地支：${astrolabe.earthlyBranchOfSoulPalace}\n身宫地支：${astrolabe.earthlyBranchOfBodyPalace}\n命主：${astrolabe.soul}\n身主：${astrolabe.body}\n五行局：${astrolabe.fiveElementsClass}\n\n关键宫位信息：\n`;\n    // 只添加关键宫位信息（命宫、身宫、夫妻宫、事业宫、财帛宫）\n    const keyPalaces = ['命宫', '身宫', '夫妻宫', '事业宫', '财帛宫'];\n    if (astrolabe.palaces && astrolabe.palaces.length > 0) {\n        astrolabe.palaces.forEach((palace) => {\n            var _a, _b;\n            if (keyPalaces.includes(palace.name)) {\n                const majorStars = ((_a = palace.majorStars) === null || _a === void 0 ? void 0 : _a.map(star => star.name)) || [];\n                const minorStars = ((_b = palace.minorStars) === null || _b === void 0 ? void 0 : _b.map(star => star.name)) || [];\n                result += `\n${palace.name}：\n天干地支：${palace.heavenlyStem}${palace.earthlyBranch}\n主星：${majorStars.join('、') || '无'}\n辅星：${minorStars.join('、') || '无'}\n`;\n            }\n        });\n    }\n    // 添加简化的大限和流年信息\n    if (astrolabe.horoscope) {\n        const horoscope = astrolabe.horoscope();\n        if (horoscope) {\n            result += `\n当前运限：\n大限：${horoscope.decadal.heavenlyStem}${horoscope.decadal.earthlyBranch}\n流年：${horoscope.yearly.heavenlyStem}${horoscope.yearly.earthlyBranch}\n`;\n        }\n    }\n    return result.trim();\n};\nexports.formatAstrolabeForSynastry = formatAstrolabeForSynastry;\n/**\n * 构建AI系统提示\n */\nconst buildSystemPrompt = (astrolabe, synastryAstrolabe, isSynastryMode, personNames) => {\n    const currentTime = new Date();\n    if (isSynastryMode && synastryAstrolabe) {\n        // 合盘模式下的系统提示\n        const synastryData = (0, exports.formatAstrolabeForSynastry)(synastryAstrolabe, currentTime);\n        const person1Data = (0, exports.formatAstrolabeForSynastry)(astrolabe, currentTime);\n        return `你是一位专业的紫微斗数命理师，请根据以下两个人的星盘数据和当前时间，进行专业的合盘分析和解读。\n\n第一个人（${personNames.person1}）的星盘数据：\n${person1Data}\n\n第二个人（${personNames.person2}）的星盘数据：\n${synastryData}\n\n请基于以上两个人的星盘数据，进行合盘分析，比较两人星盘的相容性、互补性和潜在冲突。以纯文本形式输出即可。`;\n    }\n    else {\n        // 单人模式下的系统提示\n        const astrolabeData = astrolabe ? (0, astrolabeFormatter_1.formatAstrolabeForAI)(astrolabe, currentTime) : '暂无星盘数据';\n        return `你是一位专业的紫微斗数命理师，请根据以下用户的星盘数据和当前时间，结合用户的问题进行专业分析和解读。\n\n${astrolabeData}\n\n请基于以上星盘数据，回答用户的问题。以纯文本形式输出即可。`;\n    }\n};\nexports.buildSystemPrompt = buildSystemPrompt;\n/**\n * 构建发送给AI的消息数组\n */\nconst buildAIMessages = (systemPrompt, existingMessages, userMessage) => {\n    return [\n        { role: \"system\", content: systemPrompt },\n        ...existingMessages,\n        { role: userMessage.role, content: userMessage.content }\n    ];\n};\nexports.buildAIMessages = buildAIMessages;\n/**\n * 处理流式响应数据\n */\nconst processStreamChunk = (chunk, buffer, onMessageUpdate) => {\n    let assistantMessage = \"\";\n    let newBuffer = buffer + chunk;\n    // 按行分割，但保留可能的截断行\n    const lines = newBuffer.split(\"\\n\");\n    newBuffer = lines.pop() || \"\"; // 保留最后一个可能不完整的行\n    for (const line of lines) {\n        if (line.startsWith(\"data: \")) {\n            const data = line.slice(6).trim();\n            if (data === \"[DONE]\") {\n                continue;\n            }\n            // 跳过空数据\n            if (!data) {\n                continue;\n            }\n            try {\n                // 检查 JSON 数据是否完整\n                if (data.startsWith('{') && data.endsWith('}')) {\n                    const parsed = JSON.parse(data);\n                    if (parsed.choices && parsed.choices[0].delta && parsed.choices[0].delta.content) {\n                        const newContent = parsed.choices[0].delta.content;\n                        assistantMessage += newContent;\n                        // 立即通知更新新增的内容\n                        onMessageUpdate(newContent);\n                    }\n                }\n            }\n            catch (e) {\n                console.error(\"解析 SSE 数据时出错:\", e);\n                console.error(\"问题数据:\", data);\n            }\n        }\n    }\n    return { newBuffer, assistantMessage };\n};\nexports.processStreamChunk = processStreamChunk;\n/**\n * 处理缓冲区中剩余的数据\n */\nconst processRemainingBuffer = (buffer, onMessageUpdate) => {\n    let assistantMessage = \"\";\n    if (buffer.trim()) {\n        const lines = buffer.split(\"\\n\");\n        let newBuffer = \"\";\n        for (const line of lines) {\n            if (line.startsWith(\"data: \")) {\n                const data = line.slice(6).trim();\n                if (data && data !== \"[DONE]\") {\n                    try {\n                        if (data.startsWith('{') && data.endsWith('}')) {\n                            const parsed = JSON.parse(data);\n                            if (parsed.choices && parsed.choices[0].delta && parsed.choices[0].delta.content) {\n                                const newContent = parsed.choices[0].delta.content;\n                                assistantMessage += newContent;\n                                // 立即通知更新新增的内容\n                                onMessageUpdate(newContent);\n                            }\n                        }\n                    }\n                    catch (e) {\n                        console.error(\"解析缓冲区 SSE 数据时出错:\", e);\n                        console.error(\"问题数据:\", data);\n                    }\n                }\n            }\n        }\n        return newBuffer;\n    }\n    return buffer;\n};\nexports.processRemainingBuffer = processRemainingBuffer;\n/**\n * 创建错误消息\n */\nconst createErrorMessage = (error) => {\n    console.error(\"AI 服务错误:\", error);\n    return {\n        role: \"assistant\",\n        content: \"抱歉，我在处理您的消息时遇到了问题。请稍后再试。\",\n    };\n};\nexports.createErrorMessage = createErrorMessage;\n/**\n * 验证消息内容\n */\nconst isValidMessage = (message) => {\n    return message &&\n        typeof message.role === 'string' &&\n        ['user', 'assistant'].includes(message.role) &&\n        typeof message.content === 'string' &&\n        message.content.trim().length > 0;\n};\nexports.isValidMessage = isValidMessage;\n/**\n * 过滤无效消息\n */\nconst filterValidMessages = (messages) => {\n    return messages.filter(exports.isValidMessage);\n};\nexports.filterValidMessages = filterValidMessages;\n/**\n * 获取最后一条用户消息\n */\nconst getLastUserMessage = (messages) => {\n    const validMessages = (0, exports.filterValidMessages)(messages);\n    for (let i = validMessages.length - 1; i >= 0; i--) {\n        if (validMessages[i].role === 'user') {\n            return validMessages[i];\n        }\n    }\n    return null;\n};\nexports.getLastUserMessage = getLastUserMessage;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst QuickActions = ({ quickActions, onQuickActionClick, isLoading, }) => {\n    return (react_1.default.createElement(\"div\", { className: \"quick-actions-container\" },\n        react_1.default.createElement(\"div\", { className: \"quick-actions\" }, quickActions.map((action) => (react_1.default.createElement(\"button\", { key: action.id, className: \"quick-action-button\", onClick: () => onQuickActionClick(action.name, action.prompt), disabled: isLoading }, action.name))))));\n};\nexports.default = QuickActions;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useVirtualKeyboard = void 0;\nconst react_1 = require(\"react\");\nconst layoutUtils_1 = require(\"../utils/layoutUtils\");\n/**\n * 虚拟键盘处理 Hook\n * 提供虚拟键盘状态检测和处理功能\n */\nconst useVirtualKeyboard = () => {\n    const [keyboardState, setKeyboardState] = (0, react_1.useState)({\n        isVisible: false,\n        height: 0,\n    });\n    const isMobile = (0, react_1.useRef)((0, layoutUtils_1.isMobileDevice)());\n    const isAndroid = (0, react_1.useRef)((0, layoutUtils_1.isAndroidDevice)());\n    const navigationBarHeight = (0, react_1.useRef)((0, layoutUtils_1.getAndroidNavigationBarHeight)());\n    const observerRef = (0, react_1.useRef)(null);\n    // 更新键盘状态\n    const updateKeyboardState = (0, react_1.useCallback)((config) => {\n        const isVisible = config.keyboardHeight > 0;\n        setKeyboardState(prev => {\n            // 只有状态真正改变时才更新\n            if (prev.isVisible !== isVisible || prev.height !== config.keyboardHeight) {\n                return {\n                    isVisible,\n                    height: config.keyboardHeight,\n                };\n            }\n            return prev;\n        });\n        // 更新 CSS 变量\n        document.documentElement.style.setProperty('--keyboard-height', `${config.keyboardHeight}px`);\n        // 更新安卓导航栏高度变量\n        if (isAndroid.current) {\n            const navHeight = (0, layoutUtils_1.getAndroidNavigationBarHeight)();\n            navigationBarHeight.current = navHeight;\n            document.documentElement.style.setProperty('--android-navigation-bar-height', `${navHeight}px`);\n        }\n    }, []);\n    // 处理视口大小变化 - 优化性能，减少计算频率\n    const handleViewportResize = (0, react_1.useCallback)((0, layoutUtils_1.throttle)(() => {\n        var _a;\n        if (!isMobile.current)\n            return;\n        // 获取安全区域值 - 缓存计算结果\n        const safeAreaTop = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-top')) || 0;\n        const safeAreaBottom = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-bottom')) || 0;\n        let keyboardHeight = 0;\n        if (isAndroid.current) {\n            // 安卓设备特殊处理\n            const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n            const screenHeight = window.screen.height;\n            const windowHeight = window.innerHeight;\n            const navBarHeight = (0, layoutUtils_1.getAndroidNavigationBarHeight)();\n            // 计算键盘高度，减去导航栏高度\n            if (viewportHeight < windowHeight * 0.8) {\n                keyboardHeight = windowHeight - viewportHeight - navBarHeight;\n            }\n            // 确保键盘高度合理，且不为负数\n            keyboardHeight = Math.max(0, Math.min(keyboardHeight, screenHeight * 0.5));\n        }\n        else {\n            // iOS和其他设备使用原有逻辑\n            keyboardHeight = (0, layoutUtils_1.getKeyboardHeight)({\n                isMobile: true,\n                headerHeight: 60,\n                keyboardHeight: 0,\n                safeAreaTop,\n                safeAreaBottom,\n            });\n        }\n        updateKeyboardState({ keyboardHeight });\n    }, 200), [updateKeyboardState]); // 增加节流时间到200ms，减少计算频率\n    // 处理输入框焦点事件\n    const handleInputFocus = (0, react_1.useCallback)(() => {\n        if (!isMobile.current)\n            return;\n        // 延迟检测，确保键盘完全弹出\n        setTimeout(handleViewportResize, 300);\n    }, [handleViewportResize]);\n    const handleInputBlur = (0, react_1.useCallback)(() => {\n        if (!isMobile.current)\n            return;\n        // 延迟检测，确保键盘完全收起\n        setTimeout(() => {\n            updateKeyboardState({ keyboardHeight: 0 });\n        }, 100);\n    }, [updateKeyboardState]);\n    // 设置输入框事件监听\n    const setupInputListeners = (0, react_1.useCallback)((inputElement) => {\n        if (!inputElement || !isMobile.current)\n            return;\n        inputElement.addEventListener('focus', handleInputFocus);\n        inputElement.addEventListener('blur', handleInputBlur);\n        return () => {\n            inputElement.removeEventListener('focus', handleInputFocus);\n            inputElement.removeEventListener('blur', handleInputBlur);\n        };\n    }, [handleInputFocus, handleInputBlur]);\n    // 初始化监听器 - 优化性能，减少事件监听器数量\n    (0, react_1.useEffect)(() => {\n        if (!isMobile.current)\n            return;\n        // 监听视口大小变化 - 优先使用visualViewport\n        if (window.visualViewport) {\n            window.visualViewport.addEventListener('resize', handleViewportResize);\n        }\n        else {\n            // 如果不支持visualViewport，则使用window.resize\n            window.addEventListener('resize', handleViewportResize);\n        }\n        // 创建 ResizeObserver 监听根元素变化 - 增加防抖延迟\n        observerRef.current = new ResizeObserver((0, layoutUtils_1.debounce)(handleViewportResize, 200) // 增加到200ms\n        );\n        observerRef.current.observe(document.documentElement);\n        // 初始检测\n        handleViewportResize();\n        return () => {\n            // 清理监听器\n            if (window.visualViewport) {\n                window.visualViewport.removeEventListener('resize', handleViewportResize);\n            }\n            else {\n                window.removeEventListener('resize', handleViewportResize);\n            }\n            if (observerRef.current) {\n                observerRef.current.disconnect();\n            }\n        };\n    }, [handleViewportResize]);\n    // 添加键盘状态变化的 body 类\n    (0, react_1.useEffect)(() => {\n        if (keyboardState.isVisible) {\n            document.body.classList.add('keyboard-visible');\n        }\n        else {\n            document.body.classList.remove('keyboard-visible');\n        }\n    }, [keyboardState.isVisible]);\n    // 添加安卓设备检测类\n    (0, react_1.useEffect)(() => {\n        if (isAndroid.current) {\n            document.body.classList.add('android-device');\n            // 初始化安卓导航栏高度变量\n            const navHeight = (0, layoutUtils_1.getAndroidNavigationBarHeight)();\n            navigationBarHeight.current = navHeight;\n            document.documentElement.style.setProperty('--android-navigation-bar-height', `${navHeight}px`);\n        }\n        else {\n            document.body.classList.remove('android-device');\n        }\n    }, []);\n    return {\n        keyboardState,\n        setupInputListeners,\n        hideKeyboard: () => updateKeyboardState({ keyboardHeight: 0 }),\n    };\n};\nexports.useVirtualKeyboard = useVirtualKeyboard;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst AIChatContext_1 = require(\"../AIChatContext\");\nconst useMessageScroll_1 = require(\"../hooks/useMessageScroll\");\nconst useVirtualKeyboard_1 = require(\"../hooks/useVirtualKeyboard\");\nconst useAIChatService_1 = require(\"../hooks/useAIChatService\");\nconst useChatLayout_1 = require(\"../hooks/useChatLayout\");\nconst MessageList_1 = __importDefault(require(\"./MessageList\"));\nconst ChatInput_1 = __importDefault(require(\"./ChatInput\"));\nconst QuickActions_1 = __importDefault(require(\"./QuickActions\"));\nconst QuestionPanel_1 = __importDefault(require(\"./QuestionPanel\"));\nconst SkeletonLoader_1 = __importDefault(require(\"./SkeletonLoader\"));\nconst ScrollToBottomButton_1 = __importDefault(require(\"./ScrollToBottomButton\"));\n// 使用React.memo优化组件重渲染\nconst ChatContainerComponent = ({ astrolabe, synastryAstrolabe, isSynastryMode = false, personNames = { person1: \"第一个人\", person2: \"第二个人\" }, isVisible = true, }) => {\n    const { messages, setMessages, isLoading, setIsLoading, addMessage, updateLastMessage, } = (0, AIChatContext_1.useAIChat)();\n    // 本地状态管理\n    const [inputValue, setInputValue] = (0, react_1.useState)(\"\");\n    const [showQuestionPanel, setShowQuestionPanel] = (0, react_1.useState)(false);\n    const [isGenerating, setIsGenerating] = (0, react_1.useState)(false);\n    const [isStreaming, setIsStreaming] = (0, react_1.useState)(false);\n    const [generationFailed, setGenerationFailed] = (0, react_1.useState)(false);\n    const [lastFailedMessage, setLastFailedMessage] = (0, react_1.useState)(\"\");\n    const [activeQuestionTab, setActiveQuestionTab] = (0, react_1.useState)(\"感情\");\n    // 输入框引用\n    const inputRef = react_1.default.useRef(null);\n    // 懒加载数据\n    const [quickActionsData, setQuickActionsData] = (0, react_1.useState)([]);\n    const [synastryQuickActionsData, setSynastryQuickActionsData] = (0, react_1.useState)([]);\n    const [questionCategoriesData, setQuestionCategoriesData] = (0, react_1.useState)([]);\n    const [dataLoaded, setDataLoaded] = (0, react_1.useState)(false);\n    // 使用自定义 Hooks\n    const { messagesContainerRef, lastMessageRef, userScrolledUp, setUserScrolledUp, scrollToBottom, resetScrollState, } = (0, useMessageScroll_1.useMessageScroll)(messages, isVisible, isStreaming);\n    const { keyboardState, setupInputListeners } = (0, useVirtualKeyboard_1.useVirtualKeyboard)();\n    const { getContainerStyle, getMessagesContainerStyle, getInputContainerStyle } = (0, useChatLayout_1.useChatLayout)();\n    // AI 聊天服务\n    const { sendMessage, regenerateResponse, stopGeneration } = (0, useAIChatService_1.useAIChatService)({\n        astrolabe,\n        synastryAstrolabe,\n        isSynastryMode,\n        personNames,\n        onMessageUpdate: updateLastMessage,\n        onMessagesChange: setMessages,\n        onLoadingChange: setIsLoading,\n        onGeneratingChange: setIsGenerating,\n        onStreamingChange: setIsStreaming,\n        onError: (error, message) => {\n            setGenerationFailed(error);\n            if (message)\n                setLastFailedMessage(message);\n        },\n    });\n    // 懒加载数据\n    (0, react_1.useEffect)(() => {\n        const loadData = () => __awaiter(void 0, void 0, void 0, function* () {\n            try {\n                // 动态导入快捷操作数据\n                const { quickActions, synastryQuickActions } = yield Promise.resolve().then(() => __importStar(require('../quickActions')));\n                setQuickActionsData(quickActions);\n                setSynastryQuickActionsData(synastryQuickActions);\n                // 动态导入问题数据\n                const { questionCategories } = yield Promise.resolve().then(() => __importStar(require('../questionData')));\n                setQuestionCategoriesData(questionCategories);\n                setDataLoaded(true);\n            }\n            catch (error) {\n                console.error('加载数据失败:', error);\n                setDataLoaded(true); // 即使失败也设置为已加载，避免无限加载状态\n            }\n        });\n        loadData();\n    }, []);\n    // 处理虚拟键盘弹出时隐藏问题面板\n    (0, react_1.useEffect)(() => {\n        if (keyboardState.isVisible && showQuestionPanel) {\n            setShowQuestionPanel(false);\n        }\n    }, [keyboardState.isVisible, showQuestionPanel]);\n    // 使用useCallback优化事件处理函数\n    const handleSendMessage = (0, react_1.useCallback)((content) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!content.trim() || isLoading)\n            return;\n        const userMessage = { role: \"user\", content };\n        const updatedMessages = [...messages, userMessage];\n        setMessages(updatedMessages);\n        setInputValue(\"\");\n        setGenerationFailed(false);\n        setLastFailedMessage(content);\n        setShowQuestionPanel(false);\n        yield sendMessage(userMessage, updatedMessages);\n    }), [isLoading, messages, sendMessage]);\n    const handleQuickActionClick = (0, react_1.useCallback)((name, prompt) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!name.trim() || isLoading)\n            return;\n        const userMessage = { role: \"user\", content: name };\n        const updatedMessages = [...messages, userMessage];\n        setMessages(updatedMessages);\n        setInputValue(\"\");\n        setGenerationFailed(false);\n        setLastFailedMessage(name);\n        setShowQuestionPanel(false);\n        yield sendMessage(Object.assign(Object.assign({}, userMessage), { content: prompt }), updatedMessages);\n    }), [isLoading, messages, sendMessage]);\n    const handlePresetQuestionClick = (0, react_1.useCallback)((question) => {\n        handleSendMessage(question);\n    }, [handleSendMessage]);\n    const handleSubmit = (0, react_1.useCallback)((e) => {\n        e.preventDefault();\n        handleSendMessage(inputValue);\n    }, [handleSendMessage, inputValue]);\n    const toggleQuestionPanel = (0, react_1.useCallback)(() => {\n        setShowQuestionPanel(!showQuestionPanel);\n    }, [showQuestionPanel]);\n    const handleRegenerate = (0, react_1.useCallback)(() => __awaiter(void 0, void 0, void 0, function* () {\n        if (!lastFailedMessage.trim())\n            return;\n        setGenerationFailed(false);\n        yield regenerateResponse(lastFailedMessage, messages);\n    }), [lastFailedMessage, messages, regenerateResponse]);\n    const handleMessagesClick = (0, react_1.useCallback)(() => {\n        if (showQuestionPanel) {\n            setShowQuestionPanel(false);\n        }\n    }, [showQuestionPanel]);\n    if (!isVisible) {\n        return null;\n    }\n    return (react_1.default.createElement(\"div\", { className: `ai-chat ${isVisible ? \"visible\" : \"hidden\"}` },\n        react_1.default.createElement(MessageList_1.default, { messages: messages, isLoading: isLoading, generationFailed: generationFailed, lastFailedMessage: lastFailedMessage, onRegenerate: handleRegenerate, messagesContainerRef: messagesContainerRef, lastMessageRef: lastMessageRef, isStreaming: isStreaming }),\n        react_1.default.createElement(\"div\", { className: \"chat-input-container\", onClick: (e) => e.stopPropagation() }, !dataLoaded ? (\n        // 数据加载时显示骨架屏\n        react_1.default.createElement(\"div\", { className: \"chat-skeleton-fallback\" },\n            react_1.default.createElement(SkeletonLoader_1.default, { type: \"input\", animate: true }))) : (react_1.default.createElement(react_1.default.Fragment, null,\n            react_1.default.createElement(QuickActions_1.default, { quickActions: isSynastryMode ? synastryQuickActionsData : quickActionsData, onQuickActionClick: handleQuickActionClick, isLoading: isLoading }),\n            react_1.default.createElement(ChatInput_1.default, { inputValue: inputValue, onInputChange: setInputValue, onSubmit: handleSubmit, onToggleQuestionPanel: toggleQuestionPanel, onStopGeneration: stopGeneration, isGenerating: isGenerating, isLoading: isLoading, showQuestionPanel: showQuestionPanel, inputRef: inputRef, setupInputListeners: setupInputListeners }),\n            react_1.default.createElement(QuestionPanel_1.default, { questionCategories: questionCategoriesData, activeQuestionTab: activeQuestionTab, onTabChange: setActiveQuestionTab, onQuestionClick: handlePresetQuestionClick, showQuestionPanel: showQuestionPanel })))),\n        react_1.default.createElement(ScrollToBottomButton_1.default, { isVisible: userScrolledUp && (isStreaming || isLoading), onClick: () => {\n                scrollToBottom(true);\n                setUserScrolledUp(false);\n            } })));\n};\n// 使用React.memo优化组件重渲染\nconst ChatContainer = react_1.default.memo(ChatContainerComponent);\nexports.default = ChatContainer;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst client_1 = __importDefault(require(\"react-dom/client\"));\nconst App_1 = __importDefault(require(\"./App\"));\n// 注册 Service Worker\nconst registerServiceWorker = () => {\n    if ('serviceWorker' in navigator) {\n        window.addEventListener('load', () => {\n            // 在生产环境中使用 Workbox 生成的 service worker\n            // 在开发环境中使用手动创建的 service worker\n            const swUrl = process.env.NODE_ENV === 'production' ? '/service-worker.js' : '/service-worker.js';\n            navigator.serviceWorker.register(swUrl)\n                .then(registration => {\n                console.log('ServiceWorker registration successful with scope: ', registration.scope);\n            })\n                .catch(error => {\n                console.log('ServiceWorker registration failed: ', error);\n            });\n        });\n    }\n};\nconst root = client_1.default.createRoot(document.getElementById(\"root\"));\nroot.render(react_1.default.createElement(react_1.default.StrictMode, null,\n    react_1.default.createElement(App_1.default, null)));\n// 注册 Service Worker\nregisterServiceWorker();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useMessageScroll = void 0;\nconst react_1 = require(\"react\");\n/**\n * 消息滚动处理 Hook\n * 提供自动滚动和用户滚动检测功能\n */\nconst useMessageScroll = (messages, isVisible, isStreaming = false) => {\n    const [userScrolledUp, setUserScrolledUp] = (0, react_1.useState)(false);\n    const [isUserActivelyScrolling, setIsUserActivelyScrolling] = (0, react_1.useState)(false);\n    const messagesContainerRef = (0, react_1.useRef)(null);\n    const lastMessageRef = (0, react_1.useRef)(null);\n    const observerRef = (0, react_1.useRef)(null);\n    const scrollTimeoutRef = (0, react_1.useRef)(null);\n    const userScrollTimeoutRef = (0, react_1.useRef)(null);\n    // 检查是否滚动到底部\n    const isAtBottom = (0, react_1.useCallback)(() => {\n        const container = messagesContainerRef.current;\n        if (!container)\n            return true;\n        const { scrollTop, scrollHeight, clientHeight } = container;\n        const threshold = 100; // 100px 的阈值\n        return scrollHeight - scrollTop <= clientHeight + threshold;\n    }, []);\n    // 滚动到底部\n    const scrollToBottom = (0, react_1.useCallback)((force = false) => {\n        if (!isVisible)\n            return;\n        // 如果用户正在主动滚动或者向上滚动了且不是强制滚动，则不自动滚动\n        if ((isUserActivelyScrolling || userScrolledUp) && !force)\n            return;\n        const container = messagesContainerRef.current;\n        if (!container)\n            return;\n        // 使用 requestAnimationFrame 优化滚动性能\n        requestAnimationFrame(() => {\n            // 强制滚动到绝对底部，确保完全可见\n            container.scrollTo({\n                top: container.scrollHeight,\n                behavior: force ? 'auto' : 'smooth',\n            });\n            // 如果是强制滚动，再次确保滚动到底部（处理移动端可能的延迟）\n            if (force) {\n                setTimeout(() => {\n                    container.scrollTo({\n                        top: container.scrollHeight,\n                        behavior: 'auto',\n                    });\n                }, 50);\n            }\n        });\n    }, [isVisible, userScrolledUp, isUserActivelyScrolling]);\n    // 处理滚动事件 - 优化性能，减少状态更新频率\n    const handleScroll = (0, react_1.useCallback)(() => {\n        // 清除之前的超时\n        if (scrollTimeoutRef.current) {\n            clearTimeout(scrollTimeoutRef.current);\n        }\n        // 清除用户滚动状态的超时\n        if (userScrollTimeoutRef.current) {\n            clearTimeout(userScrollTimeoutRef.current);\n        }\n        // 标记用户正在主动滚动\n        setIsUserActivelyScrolling(true);\n        // 防抖处理滚动事件 - 增加延迟时间，减少频繁更新\n        scrollTimeoutRef.current = setTimeout(() => {\n            const atBottom = isAtBottom();\n            setUserScrolledUp(!atBottom);\n            // 如果用户停止滚动一段时间后，重置主动滚动状态 - 增加延迟时间\n            userScrollTimeoutRef.current = setTimeout(() => {\n                setIsUserActivelyScrolling(false);\n            }, 1500); // 增加到1.5秒\n        }, 150); // 增加到150ms\n    }, [isAtBottom]);\n    // 设置 Intersection Observer 监听最后一条消息\n    (0, react_1.useEffect)(() => {\n        if (!isVisible)\n            return;\n        observerRef.current = new IntersectionObserver(([entry]) => {\n            // 如果最后一条消息可见，说明用户在底部\n            if (entry.isIntersecting) {\n                setUserScrolledUp(false);\n                setIsUserActivelyScrolling(false);\n            }\n        }, {\n            root: messagesContainerRef.current,\n            threshold: 0.1,\n        });\n        if (lastMessageRef.current) {\n            observerRef.current.observe(lastMessageRef.current);\n        }\n        return () => {\n            if (observerRef.current) {\n                observerRef.current.disconnect();\n            }\n        };\n    }, [isVisible, messages.length]);\n    // 监听消息容器滚动 - 优化性能\n    (0, react_1.useEffect)(() => {\n        const container = messagesContainerRef.current;\n        if (!container || !isVisible)\n            return;\n        // 使用被动事件监听器提高滚动性能\n        container.addEventListener('scroll', handleScroll, { passive: true });\n        return () => {\n            container.removeEventListener('scroll', handleScroll);\n            if (scrollTimeoutRef.current) {\n                clearTimeout(scrollTimeoutRef.current);\n            }\n            if (userScrollTimeoutRef.current) {\n                clearTimeout(userScrollTimeoutRef.current);\n            }\n        };\n    }, [isVisible, handleScroll]);\n    // 当消息变化时，自动滚动到底部\n    (0, react_1.useEffect)(() => {\n        if (messages.length === 0)\n            return;\n        // 如果是用户发送的消息，强制滚动到底部\n        const lastMessage = messages[messages.length - 1];\n        if (lastMessage.role === 'user') {\n            setUserScrolledUp(false);\n            setIsUserActivelyScrolling(false);\n            // 延迟滚动确保 DOM 更新完成\n            setTimeout(() => scrollToBottom(true), 100);\n        }\n        else if (!userScrolledUp && !isUserActivelyScrolling) {\n            // 如果是 AI 回复且用户没有向上滚动且没有主动滚动，自动滚动\n            scrollToBottom();\n        }\n    }, [messages, userScrolledUp, isUserActivelyScrolling, scrollToBottom]);\n    // 当组件显示/隐藏时处理滚动\n    (0, react_1.useEffect)(() => {\n        if (isVisible && !userScrolledUp && !isUserActivelyScrolling) {\n            scrollToBottom();\n        }\n    }, [isVisible, userScrolledUp, isUserActivelyScrolling, scrollToBottom]);\n    // 当流式传输状态变化时，重置用户滚动状态\n    (0, react_1.useEffect)(() => {\n        if (!isStreaming) {\n            setIsUserActivelyScrolling(false);\n        }\n    }, [isStreaming]);\n    // 重置滚动状态\n    const resetScrollState = (0, react_1.useCallback)(() => {\n        setUserScrolledUp(false);\n        setIsUserActivelyScrolling(false);\n        scrollToBottom(true);\n    }, [scrollToBottom]);\n    return {\n        messagesContainerRef,\n        lastMessageRef,\n        userScrolledUp,\n        setUserScrolledUp,\n        scrollToBottom,\n        resetScrollState,\n    };\n};\nexports.useMessageScroll = useMessageScroll;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AIChat = void 0;\nvar AIChat_1 = require(\"./AIChat\");\nObject.defineProperty(exports, \"AIChat\", { enumerable: true, get: function () { return __importDefault(AIChat_1).default; } });\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAIChatService = void 0;\nconst react_1 = require(\"react\");\nconst messageUtils_1 = require(\"../utils/messageUtils\");\nconst useNetworkRequest_1 = require(\"./useNetworkRequest\");\n/**\n * AI 聊天服务 Hook\n * 处理与 AI 服务的交互，包括发送消息、处理响应等\n */\nconst useAIChatService = ({ astrolabe, synastryAstrolabe, isSynastryMode = false, personNames = { person1: \"第一个人\", person2: \"第二个人\" }, onMessageUpdate, onMessagesChange, onLoadingChange, onGeneratingChange, onStreamingChange, onError, }) => {\n    const [isGenerating, setIsGenerating] = (0, react_1.useState)(false);\n    const abortControllerRef = (0, react_1.useRef)(null);\n    // 使用AI聊天请求Hook\n    const { sendChatRequest, isLoading: isNetworkLoading, error: networkError } = (0, useNetworkRequest_1.useAIChatRequest)();\n    // 提取公共的流式处理逻辑\n    const processStreamResponse = (0, react_1.useCallback)((response, existingMessages) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a;\n        // 处理流式响应\n        const reader = (_a = response.body) === null || _a === void 0 ? void 0 : _a.getReader();\n        const decoder = new TextDecoder();\n        let assistantMessageContent = \"\";\n        let buffer = \"\";\n        if (reader) {\n            // 通知开始流式传输\n            if (onStreamingChange) {\n                onStreamingChange(true);\n            }\n            try {\n                while (true) {\n                    const { done, value } = yield reader.read();\n                    if (done)\n                        break;\n                    const chunk = decoder.decode(value, { stream: true });\n                    const result = (0, messageUtils_1.processStreamChunk)(chunk, buffer, (newContent) => {\n                        assistantMessageContent += newContent;\n                        onMessageUpdate(assistantMessageContent);\n                    });\n                    buffer = result.newBuffer;\n                }\n            }\n            catch (error) {\n                // 如果是手动中止的错误，不显示错误消息\n                if (error instanceof Error && error.name === 'AbortError') {\n                    console.log('用户手动停止了生成');\n                    return { content: \"\", shouldUpdate: false };\n                }\n                throw error;\n            }\n            // 处理缓冲区中剩余的数据\n            buffer = (0, messageUtils_1.processRemainingBuffer)(buffer, (newContent) => {\n                assistantMessageContent += newContent;\n                onMessageUpdate(assistantMessageContent);\n            });\n            // 通知流式传输结束\n            if (onStreamingChange) {\n                onStreamingChange(false);\n            }\n        }\n        return { content: assistantMessageContent, shouldUpdate: true };\n    }), [onMessageUpdate, onStreamingChange]);\n    // 提取公共的AI服务调用逻辑\n    const callAIService = (0, react_1.useCallback)((messages) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a;\n        // 直接使用原始fetch方法，保持流式处理功能\n        const response = yield fetch(\"https://flow.ovo.gs/ai\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n                model: \"sydf-v1-250520\",\n                messages,\n                temperature: 0.7,\n            }),\n            signal: (_a = abortControllerRef.current) === null || _a === void 0 ? void 0 : _a.signal,\n        });\n        if (!response.ok) {\n            throw new Error(`AI 服务错误: ${response.status}`);\n        }\n        return response;\n    }), []);\n    // 提取公共的错误处理逻辑\n    const handleError = (0, react_1.useCallback)((error, userMessage, existingMessages) => {\n        var _a, _b;\n        console.error(\"发送消息时出错:\", error);\n        // 移除最后一条空消息并添加错误消息\n        const currentMessages = [...existingMessages];\n        if (((_a = currentMessages[currentMessages.length - 1]) === null || _a === void 0 ? void 0 : _a.role) === \"assistant\" &&\n            !((_b = currentMessages[currentMessages.length - 1]) === null || _b === void 0 ? void 0 : _b.content.trim())) {\n            currentMessages.pop();\n        }\n        const errorMessage = (0, messageUtils_1.createErrorMessage)(error);\n        currentMessages.push(errorMessage);\n        onMessagesChange(currentMessages);\n        onError(true, userMessage.content);\n    }, [onMessagesChange, onError]);\n    // 发送消息到 AI 服务\n    const sendMessage = (0, react_1.useCallback)((userMessage, existingMessages) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!userMessage.content.trim())\n            return;\n        onLoadingChange(true);\n        setIsGenerating(true);\n        onError(false);\n        try {\n            // 创建新的 AbortController\n            abortControllerRef.current = new AbortController();\n            // 添加一个空的助手消息用于流式更新（用户消息已经在 existingMessages 中）\n            const assistantMessage = { role: \"assistant\", content: \"\" };\n            const updatedMessages = [...existingMessages, assistantMessage];\n            onMessagesChange(updatedMessages);\n            // 构建系统提示\n            const systemPrompt = (0, messageUtils_1.buildSystemPrompt)(astrolabe !== null && astrolabe !== void 0 ? astrolabe : null, synastryAstrolabe !== null && synastryAstrolabe !== void 0 ? synastryAstrolabe : null, isSynastryMode, personNames);\n            // 构建发送给AI的消息数组\n            const aiMessages = (0, messageUtils_1.buildAIMessages)(systemPrompt, existingMessages, userMessage);\n            // 调用 AI 服务\n            const response = yield callAIService(aiMessages);\n            // 处理流式响应\n            const { content: assistantMessageContent, shouldUpdate } = yield processStreamResponse(response, existingMessages);\n            // 更新最终消息（用户消息已经在 existingMessages 中）\n            if (shouldUpdate && assistantMessageContent.trim()) {\n                const finalMessages = [...existingMessages, {\n                        role: \"assistant\",\n                        content: assistantMessageContent\n                    }];\n                onMessagesChange(finalMessages);\n            }\n            else {\n                // 如果没有内容，移除空消息\n                onMessagesChange(existingMessages);\n            }\n        }\n        catch (error) {\n            handleError(error, userMessage, existingMessages);\n        }\n        finally {\n            onLoadingChange(false);\n            setIsGenerating(false);\n        }\n    }), [\n        astrolabe,\n        synastryAstrolabe,\n        isSynastryMode,\n        personNames,\n        onLoadingChange,\n        onError,\n        callAIService,\n        processStreamResponse,\n        handleError,\n        onMessagesChange,\n    ]);\n    // 重新生成失败的回复\n    const regenerateResponse = (0, react_1.useCallback)((failedMessage, existingMessages) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!failedMessage.trim())\n            return;\n        onError(false);\n        onLoadingChange(true);\n        setIsGenerating(true);\n        try {\n            // 创建新的 AbortController\n            abortControllerRef.current = new AbortController();\n            // 添加一个空的助手消息用于流式更新（用户消息已经在 existingMessages 中）\n            const assistantMessage = { role: \"assistant\", content: \"\" };\n            const updatedMessages = [...existingMessages, assistantMessage];\n            onMessagesChange(updatedMessages);\n            // 构建系统提示\n            const systemPrompt = (0, messageUtils_1.buildSystemPrompt)(astrolabe !== null && astrolabe !== void 0 ? astrolabe : null, synastryAstrolabe !== null && synastryAstrolabe !== void 0 ? synastryAstrolabe : null, isSynastryMode, personNames);\n            // 构建发送给AI的消息数组（排除最后一条失败的助手消息）\n            const messagesWithoutLastAssistant = existingMessages.filter(msg => !(msg.role === \"assistant\" && msg === existingMessages[existingMessages.length - 1]));\n            const aiMessages = [\n                { role: \"system\", content: systemPrompt },\n                ...messagesWithoutLastAssistant,\n                { role: \"user\", content: failedMessage }\n            ];\n            // 调用 AI 服务\n            const response = yield callAIService(aiMessages);\n            // 处理流式响应\n            const { content: assistantMessageContent, shouldUpdate } = yield processStreamResponse(response, existingMessages);\n            // 更新最终消息（用户消息已经在 messagesWithoutLastAssistant 中）\n            if (shouldUpdate && assistantMessageContent.trim()) {\n                const finalMessages = [...messagesWithoutLastAssistant, {\n                        role: \"assistant\",\n                        content: assistantMessageContent\n                    }];\n                onMessagesChange(finalMessages);\n            }\n            else {\n                // 如果没有内容，恢复原始消息\n                onMessagesChange(existingMessages);\n            }\n        }\n        catch (error) {\n            console.error(\"重新生成消息时出错:\", error);\n            // 恢复原始消息并添加错误消息\n            const errorMessage = (0, messageUtils_1.createErrorMessage)(error);\n            const finalMessages = [...existingMessages, errorMessage];\n            onMessagesChange(finalMessages);\n            onError(true, failedMessage);\n        }\n        finally {\n            onLoadingChange(false);\n            setIsGenerating(false);\n        }\n    }), [\n        astrolabe,\n        synastryAstrolabe,\n        isSynastryMode,\n        personNames,\n        onError,\n        onLoadingChange,\n        callAIService,\n        processStreamResponse,\n        onMessagesChange,\n    ]);\n    // 停止生成\n    const stopGeneration = (0, react_1.useCallback)(() => {\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n            abortControllerRef.current = null;\n        }\n        setIsGenerating(false);\n        onGeneratingChange(false);\n        onLoadingChange(false);\n    }, [onGeneratingChange, onLoadingChange]);\n    return {\n        isGenerating,\n        sendMessage,\n        regenerateResponse,\n        stopGeneration,\n    };\n};\nexports.useAIChatService = useAIChatService;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Iztrolabe = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst Izpalace_1 = require(\"../Izpalace/Izpalace\");\nconst IzpalaceCenter_1 = require(\"../IzpalaceCenter\");\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst iztro_hook_1 = require(\"iztro-hook\");\nrequire(\"../styles/index.css\");\nconst astro_1 = require(\"iztro/lib/astro\");\nconst Iztrolabe = (props) => {\n    const [taichiPoint, setTaichiPoint] = (0, react_1.useState)(-1);\n    const [taichiPalaces, setTaichiPalaces] = (0, react_1.useState)();\n    const [activeHeavenlyStem, setActiveHeavenlyStem] = (0, react_1.useState)();\n    const [hoverHeavenlyStem, setHoverHeavenlyStem] = (0, react_1.useState)();\n    const [focusedIndex, setFocusedIndex] = (0, react_1.useState)();\n    const [showDecadal, setShowDecadal] = (0, react_1.useState)(false);\n    const [showYearly, setShowYearly] = (0, react_1.useState)(false);\n    const [showMonthly, setShowMonthly] = (0, react_1.useState)(false);\n    const [showDaily, setShowDaily] = (0, react_1.useState)(false);\n    const [showHourly, setShowShowHourly] = (0, react_1.useState)(false);\n    const [horoscopeDate, setHoroscopeDate] = (0, react_1.useState)();\n    const [horoscopeHour, setHoroscopeHour] = (0, react_1.useState)();\n    const { astrolabe, horoscope, setHoroscope } = (0, iztro_hook_1.useIztro)({\n        birthday: props.birthday,\n        birthTime: props.birthTime,\n        gender: props.gender,\n        birthdayType: props.birthdayType,\n        fixLeap: props.fixLeap,\n        isLeapMonth: props.isLeapMonth,\n        lang: props.lang,\n        astroType: props.astroType,\n        options: props.options,\n    });\n    const toggleShowScope = (scope) => {\n        switch (scope) {\n            case \"decadal\":\n                setShowDecadal(!showDecadal);\n                break;\n            case \"yearly\":\n                setShowYearly(!showYearly);\n                break;\n            case \"monthly\":\n                setShowMonthly(!showMonthly);\n                break;\n            case \"daily\":\n                setShowDaily(!showDaily);\n                break;\n            case \"hourly\":\n                setShowShowHourly(!showHourly);\n                break;\n        }\n    };\n    const toggleActiveHeavenlyStem = (heavenlyStem) => {\n        if (heavenlyStem === activeHeavenlyStem) {\n            setActiveHeavenlyStem(undefined);\n        }\n        else {\n            setActiveHeavenlyStem(heavenlyStem);\n        }\n    };\n    const dynamic = (0, react_1.useMemo)(() => {\n        if (showHourly) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.hourly.index,\n                arrowScope: \"hourly\",\n            };\n        }\n        if (showDaily) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.daily.index,\n                arrowScope: \"daily\",\n            };\n        }\n        if (showMonthly) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.monthly.index,\n                arrowScope: \"monthly\",\n            };\n        }\n        if (showYearly) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.index,\n                arrowScope: \"yearly\",\n            };\n        }\n        if (showDecadal) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal.index,\n                arrowScope: \"decadal\",\n            };\n        }\n    }, [showDecadal, showYearly, showMonthly, showDaily, showHourly, horoscope]);\n    (0, react_1.useEffect)(() => {\n        var _a, _b;\n        setHoroscopeDate((_a = props.horoscopeDate) !== null && _a !== void 0 ? _a : new Date());\n        setHoroscopeHour((_b = props.horoscopeHour) !== null && _b !== void 0 ? _b : 0);\n    }, [props.horoscopeDate, props.horoscopeHour]);\n    (0, react_1.useEffect)(() => {\n        setHoroscope(horoscopeDate !== null && horoscopeDate !== void 0 ? horoscopeDate : new Date(), horoscopeHour);\n    }, [horoscopeDate, horoscopeHour]);\n    (0, react_1.useEffect)(() => {\n        if (taichiPoint < 0) {\n            setTaichiPalaces(undefined);\n        }\n        else {\n            const palaces = (0, astro_1.getPalaceNames)(taichiPoint);\n            setTaichiPalaces(palaces);\n        }\n    }, [taichiPoint]);\n    const toggleTaichiPoint = (index) => {\n        if (taichiPoint === index) {\n            setTaichiPoint(-1);\n        }\n        else {\n            setTaichiPoint(index);\n        }\n    };\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-astrolabe\", \"iztro-astrolabe-theme-default\") }, astrolabe === null || astrolabe === void 0 ? void 0 :\n        astrolabe.palaces.map((palace) => {\n            return (react_1.default.createElement(Izpalace_1.Izpalace, Object.assign({ key: palace.earthlyBranch, focusedIndex: focusedIndex, onFocused: setFocusedIndex, horoscope: horoscope, showDecadalScope: showDecadal, showYearlyScope: showYearly, showMonthlyScope: showMonthly, showDailyScope: showDaily, showHourlyScope: showHourly, taichiPalace: taichiPalaces === null || taichiPalaces === void 0 ? void 0 : taichiPalaces[palace.index], toggleScope: toggleShowScope, activeHeavenlyStem: activeHeavenlyStem, toggleActiveHeavenlyStem: toggleActiveHeavenlyStem, hoverHeavenlyStem: hoverHeavenlyStem, setHoverHeavenlyStem: setHoverHeavenlyStem, toggleTaichiPoint: toggleTaichiPoint }, palace)));\n        }),\n        react_1.default.createElement(IzpalaceCenter_1.IzpalaceCenter, Object.assign({ astrolabe: astrolabe, horoscope: horoscope, horoscopeDate: horoscopeDate, horoscopeHour: horoscopeHour, setHoroscopeDate: setHoroscopeDate, setHoroscopeHour: setHoroscopeHour, centerPalaceAlign: props.centerPalaceAlign }, dynamic))));\n};\nexports.Iztrolabe = Iztrolabe;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.questionCategories = void 0;\n// 预设问题数据结构\nexports.questionCategories = [\n    {\n        name: \"感情\",\n        subCategories: [\n            { name: \"情感发展\", questions: [\"我近期的桃花运怎么样？\", \"我们目前的感情走向如何？\", \"他/她对我的真实情感是什么？\", \"我们之间有未来吗？\", \"如何改善我们目前的关系？\", \"这段感情对我的影响？\", \"我该如何表达我的感情？\", \"我们的感情会遇到什么考验？\"] },\n            { name: \"正缘婚姻\", questions: [\"我的正缘什么时候出现？\", \"我的另一半是什么样的人？\", \"我何时会结婚？\", \"我适合和现在的对象结婚吗？\", \"我的婚姻生活会幸福吗？\", \"如何吸引我的正缘桃花？\", \"我的配偶会来自哪个方向？\", \"婚姻中需要注意什么问题？\"] },\n            { name: \"关系难题\", questions: [\"我们之间出了什么问题？\", \"如何解决现在的感情危机？\", \"我们有机会复合吗？\", \"我应该放弃这段感情吗？\", \"我和Ta的缘分有多深？\", \"我的灵魂伴侣有什么特征？\", \"如何处理感情中的第三者？\", \"如何应对感情中的欺骗？\"] },\n            { name: \"恋爱技巧\", questions: [\"如何提高我的恋爱成功率？\", \"我该如何追求喜欢的人？\", \"如何让感情保持新鲜感？\", \"恋爱中如何保持自我？\", \"如何判断对方是否真心？\", \"如何处理异地恋？\", \"恋爱中如何避免争吵？\", \"如何提升我的魅力值？\"] },\n            { name: \"分手挽回\", questions: [\"分手后还能复合吗？\", \"如何有效挽回前任？\", \"分手是我做错了吗？\", \"什么时候是挽回的最佳时机？\", \"分手后如何调整心态？\", \"如何判断是否值得挽回？\", \"分手后还能做朋友吗？\", \"如何避免再次失恋？\"] },\n        ],\n    },\n    {\n        name: \"事业\",\n        subCategories: [\n            { name: \"事业发展\", questions: [\"我适合现在的工作/行业吗？\", \"我的事业什么时候能成功？\", \"我适合跳槽还是继续坚守？\", \"我事业上的贵人会是谁？\", \"我未来的事业走向怎么样？\", \"我什么时候能找到如意的工作？\", \"我的事业瓶颈期在什么时候？\", \"如何突破事业发展的困境？\"] },\n            { name: \"职场机遇\", questions: [\"我今年有机会升职加薪吗？\", \"如何得到领导的赏识和重用？\", \"我在公司的发展前景如何？\", \"如何改善当前的工作状态？\", \"我最近的职场人际运如何？\", \"什么时候是换工作的好时机？\", \"我适合独立工作还是团队合作？\", \"如何在职场中脱颖而出？\"] },\n            { name: \"创业之路\", questions: [\"我适合创业吗？\", \"我的创业最佳时机是什么时候？\", \"我该和什么样的人合作？\", \"我的创业项目前景如何？\", \"创业过程中需要注意哪些风险？\", \"我的创业会成功吗？\", \"我适合什么类型的创业？\", \"如何解决创业初期的资金问题？\"] },\n            { name: \"职场沟通\", questions: [\"如何与难相处的同事相处？\", \"我该如何向领导提出建议？\", \"如何在会议中有效表达？\", \"如何处理职场中的冲突？\", \"如何建立良好的职场形象？\", \"如何拒绝不合理的工作要求？\", \"如何进行有效的绩效谈判？\", \"如何提升我的职场说服力？\"] },\n            { name: \"团队管理\", questions: [\"我适合做管理岗位吗？\", \"如何有效激励团队成员？\", \"如何处理团队内部矛盾？\", \"如何提升团队的执行力？\", \"我适合带领什么样的团队？\", \"如何培养团队的核心竞争力？\", \"如何在管理中保持权威？\", \"如何处理团队中的问题员工？\"] },\n        ],\n    },\n    {\n        name: \"财富\",\n        subCategories: [\n            { name: \"财运趋势\", questions: [\"我近期的财运怎么样？\", \"我这辈子财运的整体趋势？\", \"我什么时候能发财？\", \"我适合靠什么方式赚钱？\", \"如何有效提升我的财运？\", \"我近期会有意外之财吗？\", \"我的财运高峰期在什么时候？\", \"如何避免财运波动的影响？\"] },\n            { name: \"投资理财\", questions: [\"我适合做投资吗？\", \"我应该选择什么样的投资方向？\", \"这个投资项目能赚钱吗？\", \"如何才能守住我的财富？\", \"我的投资风险大吗？\", \"如何更好地管理我的财富？\", \"我适合股票还是基金投资？\", \"如何制定长期理财计划？\"] },\n            { name: \"财务状况\", questions: [\"我为什么总是存不住钱？\", \"是什么原因导致我财务紧张？\", \"我最近会有破财风险吗？\", \"如何避免不必要的财务损失？\", \"我需要注意哪些年份的破财？\", \"我该如何处理我的债务问题？\", \"如何建立良好的财务习惯？\", \"我的收入什么时候能增加？\"] },\n            { name: \"债务处理\", questions: [\"我该如何处理现有债务？\", \"什么时候能还清所有债务？\", \"我适合贷款投资吗？\", \"如何避免陷入债务危机？\", \"债务会对我的生活产生什么影响？\", \"如何与债权人协商？\", \"我适合做担保人吗？\", \"如何重建信用记录？\"] },\n            { name: \"购房决策\", questions: [\"我现在适合买房吗？\", \"买房还是租房更适合我？\", \"我该在哪个城市买房？\", \"购房的最佳时机是什么时候？\", \"我适合买什么类型的房子？\", \"如何选择有升值潜力的房产？\", \"贷款买房有什么风险？\", \"如何处理房产投资中的纠纷？\"] },\n        ],\n    },\n    {\n        name: \"人际\",\n        subCategories: [\n            { name: \"社交模式\", questions: [\"我的人际交往模式有何优缺点？\", \"如何拓展我的高质量社交圈？\", \"我目前的人际关系状态如何？\", \"我会吸引哪些人进入我的生活？\", \"如何获得他人的信任与支持？\", \"如何处理与朋友的矛盾？\", \"我适合什么样的社交场合？\", \"如何提升我的社交魅力？\"] },\n            { name: \"贵人善缘\", questions: [\"什么样的朋友是我的贵人？\", \"我应该远离什么样的朋友？\", \"如何结交更多志同道合的朋友？\", \"我该如何维系重要的友谊？\", \"我该信任我身边的朋友吗？\", \"如何获得领导或长辈的赏识？\", \"我的贵人会在什么时候出现？\", \"如何识别真正的贵人？\"] },\n            { name: \"职场人际\", questions: [\"如何与难相处的上司相处？\", \"我在职场中的人际关系如何？\", \"如何处理同事间的竞争关系？\", \"如何在职场中建立人脉？\", \"我适合什么样的工作环境？\", \"如何应对职场中的排挤？\", \"如何获得同事的认可？\", \"职场中如何保持适当的距离？\"] },\n            { name: \"社交技巧\", questions: [\"如何提高我的沟通能力？\", \"我该如何打破社交尴尬？\", \"如何在聚会中表现自然？\", \"如何与陌生人建立联系？\", \"如何进行有效的倾听？\", \"如何拒绝他人的不合理要求？\", \"如何提升我的说服力？\", \"如何处理社交中的冲突？\"] },\n            { name: \"冲突处理\", questions: [\"我该如何处理人际冲突？\", \"如何避免不必要的争论？\", \"如何化解与他人的误会？\", \"面对指责我该如何回应？\", \"如何处理家庭矛盾？\", \"如何在冲突中保持冷静？\", \"如何修复破裂的关系？\", \"如何设定健康的人际边界？\"] },\n        ],\n    },\n    {\n        name: \"人生\",\n        subCategories: [\n            { name: \"学业规划\", questions: [\"我的学业运势如何？\", \"我适合考研/考公吗？\", \"我适合继续深造还是工作？\", \"如何提升我的学习效率？\", \"我该选择哪个专业/学校？\", \"我这次考试能通过吗？\", \"我适合出国留学吗？\", \"如何克服学习中的困难？\"] },\n            { name: \"个人成长\", questions: [\"我的性格优势和劣势是什么？\", \"我的人生主要课题是什么？\", \"如何找到我的人生方向？\", \"如何克服我性格中的弱点？\", \"如何有效提升自己的能量状态？\", \"我的人生转折点在何时？\", \"如何建立自信？\", \"如何实现自我价值？\"] },\n            { name: \"人生机遇\", questions: [\"我未来十年的人生大运怎么样？\", \"我该如何实现我的人生目标？\", \"我的人生会有什么重大机遇？\", \"我应该注意哪些健康问题？\", \"如何才能活出更精彩的人生？\", \"未来的人生之路走向如何？\", \"我的人生贵人会在什么时候出现？\", \"如何把握人生中的重要机会？\"] },\n            { name: \"人生抉择\", questions: [\"我该如何做出重要的人生决定？\", \"我适合留在当前城市还是迁移？\", \"我该选择稳定还是挑战？\", \"如何判断一个机会是否值得把握？\", \"我的人生道路该如何选择？\", \"如何平衡工作与生活？\", \"我适合什么样的生活方式？\", \"如何面对人生的十字路口？\"] },\n            { name: \"目标设定\", questions: [\"如何设定适合我的人生目标？\", \"我该制定短期还是长期目标？\", \"如何确保目标的可实现性？\", \"如何分解大目标为小步骤？\", \"如何保持对目标的专注？\", \"如何调整不合适的目标？\", \"如何衡量目标的进展？\", \"如何应对目标实现中的挫折？\"] },\n            { name: \"时间管理\", questions: [\"如何提高我的时间利用效率？\", \"我该如何平衡各项事务？\", \"如何避免拖延症？\", \"如何制定有效的时间计划？\", \"如何处理突发事务的干扰？\", \"如何保证充足的休息时间？\", \"如何区分事务的优先级？\", \"如何在忙碌中保持生活质量？\"] },\n        ],\n    },\n    {\n        name: \"健康\",\n        subCategories: [\n            { name: \"健康状况\", questions: [\"我的整体健康状况如何？\", \"我容易患哪些疾病？\", \"我需要注意哪些健康问题？\", \"我的体质属于什么类型？\", \"如何提升我的免疫力？\", \"我最近会有健康风险吗？\", \"我的健康运势怎么样？\", \"如何预防常见疾病？\"] },\n            { name: \"养生保健\", questions: [\"我适合什么样的养生方式？\", \"如何根据季节调整养生方法？\", \"我该注意哪些饮食禁忌？\", \"如何改善我的睡眠质量？\", \"我适合什么类型的运动？\", \"如何缓解工作压力？\", \"如何进行有效的排毒？\", \"如何保持年轻态？\"] },\n            { name: \"疾病预防\", questions: [\"我该如何预防慢性疾病？\", \"哪些疾病我需要特别警惕？\", \"如何通过饮食预防疾病？\", \"我的身体哪些部位需要重点保养？\", \"如何避免亚健康状态？\", \"定期体检有必要吗？\", \"如何识别疾病的早期信号？\", \"如何建立健康的生活习惯？\"] },\n            { name: \"心理健康\", questions: [\"我的心理状态健康吗？\", \"如何缓解焦虑和压力？\", \"我该如何调节情绪？\", \"如何避免抑郁情绪？\", \"如何提升心理韧性？\", \"我适合什么样的减压方式？\", \"如何保持积极的心态？\", \"如何处理心理创伤？\"] },\n            { name: \"运动健身\", questions: [\"我适合什么类型的运动？\", \"如何制定科学的健身计划？\", \"运动时需要注意什么？\", \"如何避免运动损伤？\", \"我适合晨练还是晚练？\", \"如何坚持运动习惯？\", \"运动对我的健康有什么好处？\", \"如何选择适合的健身场所？\"] },\n        ],\n    },\n    {\n        name: \"家庭\",\n        subCategories: [\n            { name: \"家庭和谐\", questions: [\"我的家庭关系和谐吗？\", \"如何改善家庭氛围？\", \"我该如何处理家庭矛盾？\", \"如何增进家庭成员的感情？\", \"家庭中如何有效沟通？\", \"如何平衡家庭与工作？\", \"如何建立幸福的家庭？\", \"家庭对我的影响是什么？\"] },\n            { name: \"亲子关系\", questions: [\"我该如何教育孩子？\", \"如何与孩子建立良好关系？\", \"孩子的教育问题该如何处理？\", \"如何培养孩子的独立性？\", \"我适合什么样的教育方式？\", \"如何处理孩子的叛逆期？\", \"如何帮助孩子健康成长？\", \"如何平衡严格与宽容？\"] },\n            { name: \"婚姻生活\", questions: [\"我的婚姻生活幸福吗？\", \"如何保持婚姻的新鲜感？\", \"如何处理婚姻中的矛盾？\", \"我该如何与配偶沟通？\", \"如何平衡婚姻与个人空间？\", \"婚姻中需要避免什么问题？\", \"如何经营长久的婚姻？\", \"如何应对婚姻危机？\"] },\n            { name: \"老人赡养\", questions: [\"我该如何赡养老人？\", \"如何与老人和谐相处？\", \"老人的健康问题该如何处理？\", \"如何平衡工作与照顾老人？\", \"我适合什么样的养老方式？\", \"如何让老人安享晚年？\", \"如何处理老人的固执？\", \"如何关注老人的心理健康？\"] },\n            { name: \"家族关系\", questions: [\"我在家族中的地位如何？\", \"如何处理复杂的家族关系？\", \"家族对我的发展有什么影响？\", \"如何维护家族和谐？\", \"我该如何面对家族期望？\", \"如何处理家族财产问题？\", \"如何平衡小家庭与大家族？\", \"如何建立良好的家族声誉？\"] },\n        ],\n    },\n    {\n        name: \"运势\",\n        subCategories: [\n            { name: \"流年运势\", questions: [\"我今年的整体运势如何？\", \"今年的事业运势怎么样？\", \"今年的财运会有什么变化？\", \"今年的感情运势如何？\", \"今年的健康状况需要注意什么？\", \"今年我会有什么机遇？\", \"今年需要防范什么风险？\", \"如何把握今年的好运势？\"] },\n            { name: \"大运分析\", questions: [\"我当前的大运怎么样？\", \"这个大运会持续多久？\", \"大运期间我需要注意什么？\", \"如何把握大运的机遇？\", \"大运对事业有什么影响？\", \"大运对感情有什么影响？\", \"大运对健康有什么影响？\", \"如何顺利度过不利大运？\"] },\n            { name: \"时机选择\", questions: [\"什么时候是做重要决定的最佳时机？\", \"我什么时候适合换工作？\", \"什么时候适合投资创业？\", \"什么时候适合结婚？\", \"什么时候适合搬家？\", \"什么时候适合出国？\", \"什么时候适合开始新项目？\", \"如何识别有利时机？\"] },\n            { name: \"运势提升\", questions: [\"如何提升我的整体运势？\", \"什么方法可以改善我的运势？\", \"我适合佩戴什么吉祥物？\", \"如何通过风水改善运势？\", \"什么颜色对我的运势有利？\", \"什么方位对我的运势有帮助？\", \"如何通过行为改善运势？\", \"如何保持好运的持续性？\"] },\n            { name: \"风险预警\", questions: [\"我近期会遇到什么风险？\", \"哪些年份我需要特别注意？\", \"如何防范事业风险？\", \"如何防范财务风险？\", \"如何防范感情风险？\", \"如何防范健康风险？\", \"如何识别潜在的危险？\", \"如何应对突发的不利事件？\"] },\n        ],\n    },\n];\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.throttle = exports.debounce = exports.createLayoutObserver = exports.updateLayoutCSSVariables = exports.getKeyboardHeight = exports.isKeyboardVisible = exports.calculateAvailableHeight = exports.getSafeAreaInset = exports.getLayoutConfig = exports.getAndroidNavigationBarHeight = exports.isAndroidDevice = exports.isMobileDevice = void 0;\n/**\n * 检测是否为移动设备\n */\nconst isMobileDevice = () => {\n    return /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\n};\nexports.isMobileDevice = isMobileDevice;\n/**\n * 检测是否为安卓设备\n */\nconst isAndroidDevice = () => {\n    return /Android/i.test(navigator.userAgent);\n};\nexports.isAndroidDevice = isAndroidDevice;\n/**\n * 检测安卓设备上的小白条（导航手势区域）\n * 返回小白条的估计高度（像素）\n */\nconst getAndroidNavigationBarHeight = () => {\n    var _a;\n    if (!(0, exports.isAndroidDevice)())\n        return 0;\n    // 方法1：通过CSS env()变量获取\n    const safeAreaBottom = (0, exports.getSafeAreaInset)('bottom');\n    // 方法2：通过屏幕和窗口高度差计算\n    const screenHeight = window.screen.height;\n    const windowHeight = window.innerHeight;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || windowHeight;\n    // 如果窗口高度小于屏幕高度，可能存在导航栏\n    const heightDiff = screenHeight - windowHeight;\n    // 方法3：通过window.innerWidth和screen.width判断是否有导航栏\n    const screenWidth = window.screen.width;\n    const windowWidth = window.innerWidth;\n    const widthDiff = Math.abs(screenWidth - windowWidth);\n    // 综合判断：如果安全区域底部大于0，或者高度差大于0，或者宽度差大于0\n    // 则认为存在导航栏，返回估计的高度\n    if (safeAreaBottom > 0) {\n        return safeAreaBottom;\n    }\n    // 安卓导航栏通常在24-48px之间\n    if (heightDiff > 0 && heightDiff <= 100) {\n        return heightDiff;\n    }\n    // 如果高度差太大，可能是键盘弹出，不计算为导航栏\n    if (heightDiff > 100) {\n        return 0;\n    }\n    // 默认安卓导航栏高度\n    return widthDiff > 0 ? 48 : 0;\n};\nexports.getAndroidNavigationBarHeight = getAndroidNavigationBarHeight;\n/**\n * 获取设备布局配置\n */\nconst getLayoutConfig = () => {\n    const isMobile = (0, exports.isMobileDevice)();\n    return {\n        isMobile,\n        headerHeight: isMobile ? 60 : 0,\n        keyboardHeight: 0,\n        safeAreaTop: (0, exports.getSafeAreaInset)('top'),\n        safeAreaBottom: (0, exports.getSafeAreaInset)('bottom'),\n    };\n};\nexports.getLayoutConfig = getLayoutConfig;\n/**\n * 获取安全区域插入值\n */\nconst getSafeAreaInset = (position) => {\n    if (typeof CSS !== 'undefined' && CSS.supports && CSS.supports('env', 'safe-area-inset-top')) {\n        const value = getComputedStyle(document.documentElement)\n            .getPropertyValue(`env(safe-area-inset-${position})`);\n        return parseInt(value) || 0;\n    }\n    return 0;\n};\nexports.getSafeAreaInset = getSafeAreaInset;\n/**\n * 计算可用高度\n */\nconst calculateAvailableHeight = (config) => {\n    var _a;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n    return viewportHeight - config.headerHeight - config.safeAreaTop - config.safeAreaBottom;\n};\nexports.calculateAvailableHeight = calculateAvailableHeight;\n/**\n * 检测虚拟键盘是否可见\n */\nconst isKeyboardVisible = (config) => {\n    var _a;\n    if (!config.isMobile)\n        return false;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n    const windowHeight = window.innerHeight;\n    // 如果视口高度明显小于窗口高度，说明键盘可能弹出了\n    return viewportHeight < windowHeight * 0.75;\n};\nexports.isKeyboardVisible = isKeyboardVisible;\n/**\n * 获取虚拟键盘高度\n */\nconst getKeyboardHeight = (config) => {\n    var _a;\n    if (!(0, exports.isKeyboardVisible)(config))\n        return 0;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n    const windowHeight = window.innerHeight;\n    return windowHeight - viewportHeight;\n};\nexports.getKeyboardHeight = getKeyboardHeight;\n/**\n * 更新 CSS 变量以响应布局变化\n */\nconst updateLayoutCSSVariables = (config) => {\n    const root = document.documentElement;\n    root.style.setProperty('--keyboard-height', `${config.keyboardHeight}px`);\n    root.style.setProperty('--safe-area-top', `${config.safeAreaTop}px`);\n    root.style.setProperty('--safe-area-bottom', `${config.safeAreaBottom}px`);\n    root.style.setProperty('--header-height', `${config.headerHeight}px`);\n};\nexports.updateLayoutCSSVariables = updateLayoutCSSVariables;\n/**\n * 创建响应式布局观察器\n */\nconst createLayoutObserver = (onLayoutChange) => {\n    return new ResizeObserver(() => {\n        const config = (0, exports.getLayoutConfig)();\n        config.keyboardHeight = (0, exports.getKeyboardHeight)(config);\n        (0, exports.updateLayoutCSSVariables)(config);\n        onLayoutChange(config);\n    });\n};\nexports.createLayoutObserver = createLayoutObserver;\n/**\n * 防抖函数\n */\nconst debounce = (func, delay) => {\n    let timeoutId;\n    return ((...args) => {\n        clearTimeout(timeoutId);\n        timeoutId = setTimeout(() => func.apply(null, args), delay);\n    });\n};\nexports.debounce = debounce;\n/**\n * 节流函数\n */\nconst throttle = (func, delay) => {\n    let lastCall = 0;\n    return ((...args) => {\n        const now = Date.now();\n        if (now - lastCall >= delay) {\n            lastCall = now;\n            func.apply(null, args);\n        }\n    });\n};\nexports.throttle = throttle;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ResultContainer = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst Iztrolabe_1 = require(\"../Iztrolabe\");\nconst SegmentedControl_1 = require(\"../SegmentedControl/SegmentedControl\");\n// 懒加载AIChat组件\nconst AIChat = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require(\"../AIChat\"))).then(module => ({ default: module.AIChat })));\n// 懒加载后台AI生成指示器组件\nconst BackgroundAIIndicator = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require(\"../AIChat/BackgroundAIIndicator\"))));\n/**\n * 结果容器组件\n * 负责处理星盘和AI聊天结果的显示\n */\nconst ResultContainer = ({ chartMode, formData, synastryData, astrolabe, astrolabe1, astrolabe2, onShowInputPanel, }) => {\n    const [activeTab, setActiveTab] = (0, react_1.useState)(\"ai\");\n    return (react_1.default.createElement(\"div\", { className: \"result-section\" },\n        react_1.default.createElement(\"div\", { className: \"tab-navigation\" },\n            react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"activeTab\", options: [\n                    { label: \"星盘\", value: \"astrolabe\" },\n                    { label: \"AI 解读\", value: \"ai\" },\n                ], value: activeTab, onChange: (value) => setActiveTab(value) }),\n            react_1.default.createElement(react_1.Suspense, { fallback: null },\n                react_1.default.createElement(BackgroundAIIndicator, null))),\n        react_1.default.createElement(\"div\", { className: \"tab-content\" },\n            activeTab === \"astrolabe\" && (react_1.default.createElement(\"div\", { className: \"astrolabe-content\" },\n                react_1.default.createElement(\"div\", { className: \"astrolabe-container\" },\n                    chartMode === \"single\" ? (react_1.default.createElement(Iztrolabe_1.Iztrolabe, { birthday: `${formData.year}-${String(formData.month).padStart(2, '0')}-${String(formData.day).padStart(2, '0')}`, birthTime: formData.birthTime, birthdayType: formData.birthdayType, gender: formData.gender })) : (react_1.default.createElement(\"div\", { className: \"synastry-container\" },\n                        react_1.default.createElement(\"div\", { className: \"synastry-person\" },\n                            react_1.default.createElement(\"h3\", null, synastryData.person1.name || \"第一个人\"),\n                            react_1.default.createElement(Iztrolabe_1.Iztrolabe, { birthday: `${synastryData.person1.year}-${String(synastryData.person1.month).padStart(2, '0')}-${String(synastryData.person1.day).padStart(2, '0')}`, birthTime: synastryData.person1.birthTime, birthdayType: synastryData.person1.birthdayType, gender: synastryData.person1.gender })),\n                        react_1.default.createElement(\"div\", { className: \"synastry-person\" },\n                            react_1.default.createElement(\"h3\", null, synastryData.person2.name || \"第二个人\"),\n                            react_1.default.createElement(Iztrolabe_1.Iztrolabe, { birthday: `${synastryData.person2.year}-${String(synastryData.person2.month).padStart(2, '0')}-${String(synastryData.person2.day).padStart(2, '0')}`, birthTime: synastryData.person2.birthTime, birthdayType: synastryData.person2.birthdayType, gender: synastryData.person2.gender })))),\n                    react_1.default.createElement(\"div\", { className: \"rechart-button-container\" },\n                        react_1.default.createElement(\"button\", { onClick: onShowInputPanel, className: \"rechart-button\" }, chartMode === \"single\" ? \"重新排盘\" : \"重新合盘\"))))),\n            react_1.default.createElement(\"div\", { className: `ai-content ${activeTab === \"ai\" ? \"visible\" : \"hidden\"}` },\n                react_1.default.createElement(react_1.Suspense, { fallback: react_1.default.createElement(\"div\", { className: \"loading-indicator\" }, \"\\u52A0\\u8F7DAI\\u804A\\u5929\\u529F\\u80FD\\u4E2D...\") },\n                    react_1.default.createElement(AIChat, { astrolabe: chartMode === \"single\" ? astrolabe : astrolabe1, synastryAstrolabe: chartMode === \"synastry\" ? astrolabe2 : undefined, isSynastryMode: chartMode === \"synastry\", personNames: {\n                            person1: synastryData.person1.name || \"第一个人\",\n                            person2: synastryData.person2.name || \"第二个人\"\n                        }, isVisible: activeTab === \"ai\" }))))));\n};\nexports.ResultContainer = ResultContainer;\nexports.default = exports.ResultContainer;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\n// 使用React.memo优化组件重渲染\nconst ChatInputComponent = ({ inputValue, onInputChange, onSubmit, onToggleQuestionPanel, onStopGeneration, isGenerating, isLoading, showQuestionPanel, inputRef, setupInputListeners, }) => {\n    // 检测是否为 PWA 模式\n    const [isPWA, setIsPWA] = (0, react_1.useState)(false);\n    // 检测是否为 iOS 设备\n    const [isIOS, setIsIOS] = (0, react_1.useState)(false);\n    // 检测是否为安卓设备\n    const [isAndroid, setIsAndroid] = (0, react_1.useState)(false);\n    // 安卓导航栏高度\n    const [androidNavBarHeight, setAndroidNavBarHeight] = (0, react_1.useState)(0);\n    // iOS 刘海区域高度\n    const [iosNotchHeight, setIosNotchHeight] = (0, react_1.useState)(0);\n    // 优化设备检测逻辑，使用useMemo缓存检测结果\n    const deviceInfo = (0, react_1.useMemo)(() => {\n        const isIOSDevice = /iPhone|iPad|iPod/i.test(navigator.userAgent);\n        const isAndroidDevice = /Android/i.test(navigator.userAgent);\n        const isStandalone = window.matchMedia('(display-mode: standalone)').matches ||\n            window.navigator.standalone ||\n            document.referrer.includes('android-app://');\n        return {\n            isIOSDevice,\n            isAndroidDevice,\n            isStandalone\n        };\n    }, []);\n    // 优化高度计算逻辑，使用useMemo缓存计算结果\n    const heights = (0, react_1.useMemo)(() => {\n        const getIosNotchHeight = () => {\n            if (!deviceInfo.isIOSDevice)\n                return 0;\n            const safeAreaTop = parseInt(getComputedStyle(document.documentElement)\n                .getPropertyValue('--safe-area-inset-top')) || 0;\n            // iOS 刘海区域通常在 20-44px 之间\n            return safeAreaTop > 0 ? Math.max(safeAreaTop, 20) : 0;\n        };\n        const getAndroidNavBarHeight = () => {\n            if (!deviceInfo.isAndroidDevice)\n                return 0;\n            const safeAreaBottom = parseInt(getComputedStyle(document.documentElement)\n                .getPropertyValue('--safe-area-inset-bottom')) || 0;\n            const androidNavBarHeight = parseInt(getComputedStyle(document.documentElement)\n                .getPropertyValue('--android-navigation-bar-height')) || 0;\n            return Math.max(safeAreaBottom, androidNavBarHeight);\n        };\n        return {\n            iosNotchHeight: getIosNotchHeight(),\n            androidNavBarHeight: getAndroidNavBarHeight()\n        };\n    }, [deviceInfo]);\n    // 优化事件处理函数，使用useCallback\n    const handleInputChange = (0, react_1.useCallback)((e) => {\n        onInputChange(e.target.value);\n    }, [onInputChange]);\n    const handleButtonClick = (0, react_1.useCallback)(() => {\n        if (isGenerating) {\n            onStopGeneration();\n        }\n        else if (inputValue.trim()) {\n            onSubmit(new Event('submit'));\n        }\n        else {\n            onToggleQuestionPanel();\n        }\n    }, [isGenerating, inputValue, onStopGeneration, onSubmit, onToggleQuestionPanel]);\n    // 优化设备检测和状态更新\n    (0, react_1.useEffect)(() => {\n        setIsPWA(deviceInfo.isStandalone);\n        setIsIOS(deviceInfo.isIOSDevice);\n        setIsAndroid(deviceInfo.isAndroidDevice);\n        setIosNotchHeight(heights.iosNotchHeight);\n        setAndroidNavBarHeight(heights.androidNavBarHeight);\n    }, [deviceInfo, heights]);\n    // 优化事件监听器设置\n    (0, react_1.useEffect)(() => {\n        // 监听显示模式变化\n        const mediaQuery = window.matchMedia('(display-mode: standalone)');\n        const handlePWAChange = () => setIsPWA(mediaQuery.matches);\n        mediaQuery.addEventListener('change', handlePWAChange);\n        // 监听CSS变量变化（导航栏高度可能会变化）\n        const observer = new MutationObserver(() => {\n            if (deviceInfo.isAndroidDevice) {\n                const safeAreaBottom = parseInt(getComputedStyle(document.documentElement)\n                    .getPropertyValue('--safe-area-inset-bottom')) || 0;\n                const androidNavBarHeight = parseInt(getComputedStyle(document.documentElement)\n                    .getPropertyValue('--android-navigation-bar-height')) || 0;\n                setAndroidNavBarHeight(Math.max(safeAreaBottom, androidNavBarHeight));\n            }\n        });\n        observer.observe(document.documentElement, {\n            attributes: true,\n            attributeFilter: ['style']\n        });\n        return () => {\n            mediaQuery.removeEventListener('change', handlePWAChange);\n            observer.disconnect();\n        };\n    }, [deviceInfo]);\n    // 设置输入框监听器\n    (0, react_1.useEffect)(() => {\n        if (inputRef.current) {\n            setupInputListeners(inputRef.current);\n        }\n    }, [inputRef, setupInputListeners]);\n    return (react_1.default.createElement(\"form\", { className: `chat-input chat-input-form ${isPWA ? 'pwa-mode' : ''} ${isIOS ? 'ios-mode' : ''} ${isAndroid ? 'android-mode' : ''}`, onSubmit: onSubmit },\n        react_1.default.createElement(\"input\", { ref: inputRef, type: \"text\", value: inputValue, onChange: handleInputChange, placeholder: \"\\u8F93\\u5165\\u60A8\\u7684\\u95EE\\u9898...\", disabled: isLoading, className: \"chat-input-field\" }),\n        react_1.default.createElement(\"button\", { type: isGenerating ? \"button\" : (inputValue.trim() ? \"submit\" : \"button\"), onClick: handleButtonClick, disabled: isLoading && !isGenerating, className: \"chat-action-button chat-send-button\" }, isGenerating ? (react_1.default.createElement(\"span\", { className: \"chat-stop-icon\" }, \"\\u25A0\")) : inputValue.trim() ? (react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"24\", height: \"24\", viewBox: \"0 0 24 24\", fill: \"#ffffff\", stroke: \"#ffffff\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\", className: \"chat-send-icon\" },\n            react_1.default.createElement(\"line\", { x1: \"22\", y1: \"2\", x2: \"11\", y2: \"13\" }),\n            react_1.default.createElement(\"polygon\", { points: \"22 2 15 22 11 13 2 9 22 2\" }))) : (react_1.default.createElement(\"span\", { className: \"chat-toggle-icon\" }, showQuestionPanel ? \"✕\" : \"+\")))));\n};\n// 使用React.memo优化组件重渲染\nconst ChatInput = react_1.default.memo(ChatInputComponent);\nexports.default = ChatInput;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./Izstar\"), exports);\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CloudStorageService = void 0;\n/**\n * 云存储服务类，用于与 Cloudflare Worker + KV 交互\n */\nclass CloudStorageService {\n    /**\n     * 初始化方法，在类加载时调用\n     */\n    static initialize() {\n        // 不需要在初始化时做任何事\n    }\n    /**\n     * 检查是否已认证\n     * @returns 是否已认证\n     */\n    static isAuth() {\n        const cloudEnabled = localStorage.getItem(this.CLOUD_ENABLED_KEY);\n        return cloudEnabled === 'true';\n    }\n    /**\n     * 验证密码\n     * @param password 要验证的密码\n     * @returns 是否验证成功\n     */\n    static authenticate(password) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // 直接比较硬编码的密码\n                if (password === this.CLOUD_PASSWORD) {\n                    // 保存云存储开关状态到本地\n                    localStorage.setItem(this.CLOUD_ENABLED_KEY, 'true');\n                    return true;\n                }\n                // 清除云存储开关状态\n                localStorage.removeItem(this.CLOUD_ENABLED_KEY);\n                return false;\n            }\n            catch (error) {\n                console.error('密码验证失败:', error);\n                return false;\n            }\n        });\n    }\n    /**\n     * 清除认证状态\n     */\n    static clearAuthentication() {\n        // 清除云存储开关状态\n        localStorage.removeItem(this.CLOUD_ENABLED_KEY);\n    }\n    /**\n     * 上传单个历史记录到云存储\n     * @param item 历史记录项\n     * @returns 上传是否成功\n     */\n    static uploadHistoryItem(item) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                console.log('上传历史记录项:', item);\n                const response = yield fetch(`${this.WORKER_URL}/api/history/item`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                    body: JSON.stringify({ item }),\n                });\n                if (!response.ok) {\n                    throw new Error(`上传失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                console.log('上传历史记录项结果:', result);\n                return result.success;\n            }\n            catch (error) {\n                console.error('上传历史记录项失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 从云存储下载单个历史记录\n     * @param id 历史记录ID\n     * @returns 历史记录项\n     */\n    static downloadHistoryItem(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/history/item/${id}`, {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`下载失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                return result.item;\n            }\n            catch (error) {\n                console.error('下载历史记录项失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 从云存储删除单个历史记录\n     * @param id 历史记录ID\n     * @returns 删除是否成功\n     */\n    static deleteHistoryItem(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/history/item/${id}`, {\n                    method: 'DELETE',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`删除失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                return result.success;\n            }\n            catch (error) {\n                console.error('删除历史记录项失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 获取所有历史记录ID列表\n     * @returns 历史记录ID数组\n     */\n    static getHistoryIds() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                console.log('获取历史记录ID列表...');\n                const response = yield fetch(`${this.WORKER_URL}/api/history/ids`, {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`获取ID列表失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                console.log('获取到的ID列表结果:', result);\n                console.log('ID列表:', result.ids);\n                return result.ids || [];\n            }\n            catch (error) {\n                console.error('获取历史记录ID列表失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 批量获取历史记录\n     * @param ids 历史记录ID数组\n     * @returns 历史记录数组\n     */\n    static batchDownloadHistoryItems(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                console.log('批量下载历史记录，IDs:', ids);\n                const response = yield fetch(`${this.WORKER_URL}/api/history/batch`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                    body: JSON.stringify({ ids }),\n                });\n                if (!response.ok) {\n                    throw new Error(`批量下载失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                console.log('从云端获取的原始数据:', result);\n                console.log('从云端获取的历史记录项:', result.items);\n                return result.items || [];\n            }\n            catch (error) {\n                console.error('批量下载历史记录失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 清空所有历史记录\n     * @returns 清空是否成功\n     */\n    static clearAllHistory() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/history/clear`, {\n                    method: 'DELETE',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`清空失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                return result.success;\n            }\n            catch (error) {\n                console.error('清空历史记录失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 检查网络连接状态\n     * @returns 是否在线\n     */\n    static isOnline() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/health`, {\n                    method: 'GET',\n                    mode: 'no-cors',\n                    cache: 'no-cache'\n                });\n                return true;\n            }\n            catch (_a) {\n                return false;\n            }\n        });\n    }\n}\nexports.CloudStorageService = CloudStorageService;\nCloudStorageService.WORKER_URL = 'https://ziwei.sydf.cc'; // 需要替换为实际的 Worker URL\nCloudStorageService.CLOUD_PASSWORD = 'ovo'; // 硬编码的云存储密码\nCloudStorageService.CLOUD_ENABLED_KEY = 'iztro_cloud_enabled'; // 云存储开关状态键\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Izpalace = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst classnames_1 = __importDefault(require(\"classnames\"));\nrequire(\"../styles/index.css\");\nconst Izstar_1 = require(\"../Izstar\");\nconst i18n_1 = require(\"iztro/lib/i18n\");\nconst utils_1 = require(\"iztro/lib/utils\");\nconst Izpalace = (_a) => {\n    var _b, _c, _d, _e;\n    var { index, taichiPalace, focusedIndex, onFocused, horoscope, activeHeavenlyStem, toggleActiveHeavenlyStem, hoverHeavenlyStem, setHoverHeavenlyStem, showDecadalScope = false, showYearlyScope = false, showMonthlyScope = false, showDailyScope = false, showHourlyScope = false, toggleScope, toggleTaichiPoint } = _a, palace = __rest(_a, [\"index\", \"taichiPalace\", \"focusedIndex\", \"onFocused\", \"horoscope\", \"activeHeavenlyStem\", \"toggleActiveHeavenlyStem\", \"hoverHeavenlyStem\", \"setHoverHeavenlyStem\", \"showDecadalScope\", \"showYearlyScope\", \"showMonthlyScope\", \"showDailyScope\", \"showHourlyScope\", \"toggleScope\", \"toggleTaichiPoint\"]);\n    const horoscopeNames = (0, react_1.useMemo)(() => {\n        const horoscopeNames = [];\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.decadal), { scope: \"decadal\", show: showDecadalScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.yearly), { scope: \"yearly\", show: showYearlyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.monthly.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.monthly), { scope: \"monthly\", show: showMonthlyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.daily.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.daily), { scope: \"daily\", show: showDailyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.hourly.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.hourly), { scope: \"hourly\", show: showHourlyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.age.index) === index) {\n            horoscopeNames.push({\n                name: horoscope.age.name,\n                heavenlyStem: undefined,\n                scope: \"age\",\n                show: false,\n            });\n        }\n        return horoscopeNames;\n    }, [\n        horoscope,\n        showDecadalScope,\n        showYearlyScope,\n        showMonthlyScope,\n        showDailyScope,\n        showHourlyScope,\n    ]);\n    const horoscopeMutagens = (0, react_1.useMemo)(() => {\n        if (!horoscope) {\n            return [];\n        }\n        return [\n            {\n                mutagen: horoscope.decadal.mutagen,\n                scope: \"decadal\",\n                show: showDecadalScope,\n            },\n            {\n                mutagen: horoscope.yearly.mutagen,\n                scope: \"yearly\",\n                show: showYearlyScope,\n            },\n            {\n                mutagen: horoscope.monthly.mutagen,\n                scope: \"monthly\",\n                show: showMonthlyScope,\n            },\n            {\n                mutagen: horoscope.daily.mutagen,\n                scope: \"daily\",\n                show: showDailyScope,\n            },\n            {\n                mutagen: horoscope.hourly.mutagen,\n                scope: \"hourly\",\n                show: showHourlyScope,\n            },\n        ];\n    }, [\n        horoscope,\n        showDecadalScope,\n        showYearlyScope,\n        showMonthlyScope,\n        showDailyScope,\n        showHourlyScope,\n    ]);\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(`iztro-palace g${index}`, {\n            \"focused-palace\": focusedIndex === index,\n            \"opposite-palace\": focusedIndex != undefined && index === (0, utils_1.fixIndex)(focusedIndex + 6),\n            \"surrounded-palace\": focusedIndex != undefined &&\n                (index === (0, utils_1.fixIndex)(focusedIndex + 4) ||\n                    index === (0, utils_1.fixIndex)(focusedIndex - 4)),\n        }), onMouseEnter: () => onFocused === null || onFocused === void 0 ? void 0 : onFocused(index), onMouseLeave: () => onFocused === null || onFocused === void 0 ? void 0 : onFocused(undefined) },\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-major\") }, palace.majorStars.map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name, activeHeavenlyStem: activeHeavenlyStem, hoverHeavenlyStem: hoverHeavenlyStem, palaceHeavenlyStem: (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"), horoscopeMutagens: horoscopeMutagens }, star))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-minor\") }, palace.minorStars.map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name, activeHeavenlyStem: activeHeavenlyStem, hoverHeavenlyStem: hoverHeavenlyStem, palaceHeavenlyStem: (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"), horoscopeMutagens: horoscopeMutagens }, star))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-adj\") },\n            react_1.default.createElement(\"div\", null, palace.adjectiveStars.slice(5).map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star))))),\n            react_1.default.createElement(\"div\", null, palace.adjectiveStars.slice(0, 5).map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star)))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-horo-star\") },\n            react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"stars\") }, ((_b = horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal) === null || _b === void 0 ? void 0 : _b.stars) &&\n                ((_c = horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal) === null || _c === void 0 ? void 0 : _c.stars[index].map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star)))))),\n            react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"stars\") }, ((_d = horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly) === null || _d === void 0 ? void 0 : _d.stars) &&\n                ((_e = horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly) === null || _e === void 0 ? void 0 : _e.stars[index].map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star))))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-fate\") }, horoscopeNames === null || horoscopeNames === void 0 ? void 0 : horoscopeNames.map((item) => (react_1.default.createElement(\"span\", { key: item.name, className: (0, classnames_1.default)({\n                [`iztro-palace-${item.scope}-active`]: item.show,\n            }), onClick: item.scope ? () => toggleScope === null || toggleScope === void 0 ? void 0 : toggleScope(item.scope) : undefined },\n            item.name,\n            item.heavenlyStem && `·${item.heavenlyStem}`)))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-footer\") },\n            react_1.default.createElement(\"div\", null,\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-lft24\") },\n                    react_1.default.createElement(\"div\", null, palace.changsheng12),\n                    react_1.default.createElement(\"div\", null, palace.boshi12)),\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-name\"), onClick: () => toggleTaichiPoint === null || toggleTaichiPoint === void 0 ? void 0 : toggleTaichiPoint(index) },\n                    react_1.default.createElement(\"span\", { className: \"iztro-palace-name-wrapper\" },\n                        palace.name,\n                        react_1.default.createElement(\"span\", { className: \"iztro-palace-name-taichi\" }, taichiPalace &&\n                            ((0, i18n_1.kot)(taichiPalace) === (0, i18n_1.kot)(\"命宫\")\n                                ? \"☯\"\n                                : taichiPalace))),\n                    palace.isBodyPalace && (react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"iztro-palace-name-body\") },\n                        \"\\u00B7\",\n                        (0, i18n_1.t)(\"bodyPalace\"))))),\n            react_1.default.createElement(\"div\", null,\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-scope\") },\n                    react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-scope-age\") }, palace.ages.slice(0, 7).join(\" \")),\n                    react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-scope-decadal\") }, palace.decadal.range.join(\" - \"))),\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-dynamic-name\") },\n                    showDecadalScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-decadal\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal.palaceNames[index])),\n                    showYearlyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-yearly\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.palaceNames[index])),\n                    showMonthlyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-monthly\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.monthly.palaceNames[index])),\n                    showDailyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-daily\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.daily.palaceNames[index])),\n                    showHourlyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-hourly\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.hourly.palaceNames[index])))),\n            react_1.default.createElement(\"div\", null,\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-rgt24\") },\n                    react_1.default.createElement(\"div\", null, showYearlyScope\n                        ? horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.yearlyDecStar.suiqian12[index]\n                        : palace.suiqian12),\n                    react_1.default.createElement(\"div\", null, showYearlyScope\n                        ? horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.yearlyDecStar.jiangqian12[index]\n                        : palace.jiangqian12)),\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-gz\", {\n                        \"iztro-palace-gz-active\": activeHeavenlyStem ===\n                            (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"),\n                    }), onClick: () => toggleActiveHeavenlyStem === null || toggleActiveHeavenlyStem === void 0 ? void 0 : toggleActiveHeavenlyStem((0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\")), onMouseEnter: () => setHoverHeavenlyStem === null || setHoverHeavenlyStem === void 0 ? void 0 : setHoverHeavenlyStem((0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\")), onMouseLeave: () => setHoverHeavenlyStem === null || setHoverHeavenlyStem === void 0 ? void 0 : setHoverHeavenlyStem(undefined) },\n                    react_1.default.createElement(\"span\", { className: (0, classnames_1.default)({\n                            \"iztro-palace-gz-active\": activeHeavenlyStem ===\n                                (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"),\n                        }) },\n                        palace.heavenlyStem,\n                        palace.earthlyBranch))))));\n};\nexports.Izpalace = Izpalace;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SegmentedControl = void 0;\nconst react_1 = __importStar(require(\"react\"));\nrequire(\"../styles/index.css\");\nconst SegmentedControl = ({ name, options, value, onChange }) => {\n    const controlRef = (0, react_1.useRef)(null);\n    const sliderRef = (0, react_1.useRef)(null);\n    // 防止移动端点击时页面滚动和元素上移，但不影响点击功能\n    const handleTouchStart = (e) => {\n        // 只阻止多点触控的默认行为，防止页面缩放\n        if (e.touches.length > 1) {\n            e.preventDefault();\n        }\n        // 阻止事件冒泡，防止父元素的滚动行为\n        e.stopPropagation();\n        // 记录触摸开始位置，用于判断是否为点击操作\n        const touch = e.touches[0];\n        e.currentTarget.dataset.touchStartX = touch.clientX.toString();\n        e.currentTarget.dataset.touchStartY = touch.clientY.toString();\n    };\n    // 防止移动端点击时页面滚动和元素上移，但不影响点击功能\n    const handleTouchMove = (e) => {\n        // 只阻止多点触控的默认行为，防止页面缩放\n        if (e.touches.length > 1) {\n            e.preventDefault();\n        }\n        // 获取触摸开始位置\n        const touchStartX = parseFloat(e.currentTarget.dataset.touchStartX || '0');\n        const touchStartY = parseFloat(e.currentTarget.dataset.touchStartY || '0');\n        // 计算触摸移动距离\n        const touch = e.touches[0];\n        const deltaX = Math.abs(touch.clientX - touchStartX);\n        const deltaY = Math.abs(touch.clientY - touchStartY);\n        // 如果移动距离超过阈值，则认为是滑动操作，阻止默认行为\n        if (deltaX > 5 || deltaY > 5) {\n            e.preventDefault();\n        }\n        // 阻止事件冒泡，防止父元素的滚动行为\n        e.stopPropagation();\n    };\n    // 防止移动端点击时页面滚动和元素上移，但不影响点击功能\n    const handleTouchEnd = (e) => {\n        // 阻止事件冒泡，防止父元素的滚动行为\n        e.stopPropagation();\n        // 清除触摸开始位置记录\n        delete e.currentTarget.dataset.touchStartX;\n        delete e.currentTarget.dataset.touchStartY;\n    };\n    (0, react_1.useEffect)(() => {\n        if (!controlRef.current)\n            return;\n        const activeElement = controlRef.current.querySelector('.segmented-control-input:checked');\n        if (!activeElement)\n            return;\n        const buttonElement = activeElement.nextElementSibling;\n        if (!buttonElement || !sliderRef.current)\n            return;\n        // 使用 requestAnimationFrame 确保在浏览器重绘后计算位置\n        const updateSliderPosition = () => {\n            const buttonRect = buttonElement.getBoundingClientRect();\n            const controlRect = controlRef.current.getBoundingClientRect();\n            // 直接设置滑块样式，而不是使用状态\n            sliderRef.current.style.width = `${buttonRect.width}px`;\n            sliderRef.current.style.left = `${buttonRect.left - controlRect.left}px`;\n            sliderRef.current.style.opacity = '1';\n        };\n        // 立即更新一次\n        updateSliderPosition();\n        // 使用 requestAnimationFrame 确保在下一帧再次更新，处理可能的布局变化\n        const animationId = requestAnimationFrame(updateSliderPosition);\n        // 添加 resize 监听器，处理窗口大小变化\n        const resizeObserver = new ResizeObserver(() => {\n            updateSliderPosition();\n        });\n        resizeObserver.observe(controlRef.current);\n        // 清理函数\n        return () => {\n            cancelAnimationFrame(animationId);\n            resizeObserver.disconnect();\n        };\n    }, [value, options]);\n    // 处理按钮点击事件，防止移动端的默认行为\n    const handleButtonClick = (optionValue) => (e) => {\n        // 阻止事件冒泡和默认行为\n        e.preventDefault();\n        e.stopPropagation();\n        // 调用 onChange 回调\n        onChange(optionValue);\n    };\n    return (react_1.default.createElement(\"div\", { className: \"segmented-control\", ref: controlRef, onTouchStart: handleTouchStart, onTouchMove: handleTouchMove, onTouchEnd: handleTouchEnd },\n        react_1.default.createElement(\"div\", { className: \"segmented-control-slider\", ref: sliderRef }),\n        options.map((option) => (react_1.default.createElement(\"label\", { key: option.value, className: \"segmented-control-label\" },\n            react_1.default.createElement(\"input\", { type: \"radio\", name: name, value: option.value, checked: value === option.value, onChange: () => onChange(option.value), className: \"segmented-control-input\" }),\n            react_1.default.createElement(\"span\", { className: \"segmented-control-button\", onClick: handleButtonClick(option.value), onTouchEnd: handleButtonClick(option.value) }, option.label))))));\n};\nexports.SegmentedControl = SegmentedControl;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.synastryQuickActions = exports.quickActions = void 0;\n// 快捷操作按钮的数据结构\nexports.quickActions = [\n    {\n        id: \"astro-analysis\",\n        name: \"命盘分析\",\n        prompt: \"请对我的紫微斗数星盘进行全面而深入的专业分析，包括：\\n1. 命宫分析：详细解读命宫的主星、辅星、四化星，分析我的先天性格特质、核心优势与潜在挑战\\n2. 身宫分析：身宫与命宫的关系，对我的后天发展的影响\\n3. 十二宫位系统分析：逐一解析夫妻宫、事业宫、财帛宫、迁移宫、疾厄宫、奴仆宫、官禄宫、田宅宫、福德宫、父母宫的星曜组合及其人生意义\\n4. 核心星曜解读：重点分析紫微星、天府星、太阳星、太阴星等主星在命盘中的位置和影响力\\n5. 四化星影响：详细解释化禄、化权、化科、化忌在我的命盘中的具体体现和影响\\n6. 三方四正：分析命宫、财帛宫、官禄宫的三方四正关系，揭示我的人生发展主线\\n7. 大运流年：结合当前大运和流年运势，分析我当前所处的人生阶段和未来发展趋势\\n8. 综合建议：基于以上分析，为我提供具体的人生规划建议和发展方向指导\"\n    },\n    {\n        id: \"career-finance\",\n        name: \"事业财运\",\n        prompt: \"请对我的事业和财运进行专业的紫微斗数分析，包括：\\n1. 事业宫深度解析：事业宫的主星组合、吉凶星曜配置，对我的职业倾向、工作能力、领导力的影响\\n2. 官禄宫分析：官禄宫的星曜配置，反映我的社会地位、职业成就和事业发展潜力\\n3. 财帛宫详解：财帛宫的星曜组合，分析我的财运特质、财富获取能力、理财观念\\n4. 福德宫影响：福德宫的星曜配置，对我财富积累和财运持久性的影响\\n5. 适合行业分析：基于星盘特征，推荐最适合我的行业类型和职业方向\\n6. 事业发展阶段：分析我当前大运对事业的影响，未来事业发展的关键时间节点\\n7. 贵人运分析：哪些宫位和星曜代表我的事业贵人，如何识别和把握贵人机会\\n8. 财运类型：正财与偏财的配置比例，适合的财富获取方式\\n9. 投资理财建议：基于星盘特征，提供适合我的投资策略和理财建议\\n10. 风险提示：需要注意的事业和财务风险，以及规避方法\\n11. 实用建议：具体的职业发展路径、技能提升方向、财富管理策略\"\n    },\n    {\n        id: \"love-marriage\",\n        name: \"感情婚姻\",\n        prompt: \"请对我的感情和婚姻状况进行专业的紫微斗数深度分析，包括：\\n1. 夫妻宫全面解析：夫妻宫的主星、辅星、四化星配置，分析我的婚姻观、择偶标准、婚姻质量\\n2. 子女宫分析：子女宫的星曜配置，对生育、子女教育、家庭关系的影响\\n3. 命宫与感情：命宫星曜如何影响我的性格特质和感情表达方式\\n4. 感情模式分析：基于星盘特征，分析我的恋爱模式、感情需求、亲密关系特点\\n5. 正缘特征：详细描述我的正缘对象的外貌、性格、职业、家庭背景等特征\\n6. 婚姻时机：分析大运流年，指出适合结婚的时间段和需要注意的年份\\n7. 感情发展：当前感情关系的走势，未来可能的发展方向和转折点\\n8. 配偶情况：配偶的事业、财运、性格、家庭背景等方面的预测\\n9. 婚姻质量：婚姻生活的和谐度、稳定性、幸福指数预测\\n10. 潜在问题：可能出现的感情问题、婚姻危机，以及其星盘根源\\n11. 解决方案：针对潜在问题，提供具体的改善建议和化解方法\\n12. 桃花运分析：桃花星的配置，桃花运的强弱、时机和质量\"\n    },\n    {\n        id: \"academic-exam\",\n        name: \"学业考试\",\n        prompt: \"请对我的学业和考试运势进行专业的紫微斗数分析，包括：\\n1. 文昌文曲分析：文昌星、文曲星在命盘中的位置和影响力，对我的学习能力、考试运的影响\\n2. 官禄宫学业：官禄宫星曜配置对学业成就、考试表现的影响\\n3. 命宫与学习：命宫星曜反映的学习态度、专注力、记忆力特点\\n4. 福德宫智慧：福德宫星曜对智慧开发、思维能力、创新精神的影响\\n5. 适合学科：基于星盘特征，推荐最适合我的学科方向和专业选择\\n6. 考试运势：当前大运流年对各类考试的影响，重要考试的成功率预测\\n7. 学习方法：适合我的学习方式、记忆技巧、时间管理策略\\n8. 升学机会：升学、考研、考公等教育发展机会的时机和成功率\\n9. 竞争优势：在学业竞争中的优势领域和需要加强的方面\\n10. 实用建议：具体的备考策略、考试技巧、学业规划建议\"\n    },\n    {\n        id: \"health-status\",\n        name: \"健康\",\n        prompt: \"请根据我的紫微斗数星盘进行专业的健康状况分析，包括：\\n1. 疾厄宫深度解析：疾厄宫的主星组合、吉凶星曜配置，分析我的先天体质特征\\n2. 命宫与健康：命宫星曜对整体健康状况、生命力、抵抗力的影响\\n3. 身宫与健康：身宫位置对后天健康状况、疾病恢复能力的影响\\n4. 弱势系统识别：根据星盘特征，指出我身体上相对薄弱的系统和器官\\n5. 常见疾病倾向：基于星盘配置，分析我容易出现的健康问题和疾病类型\\n6. 健康运势起伏：结合大运流年，分析我健康状况的变化趋势和关键时间点\\n7. 心理健康：星盘反映的心理特征、情绪管理能力、压力承受度\\n8. 养生方向：适合我的养生方式、保健重点、预防措施\\n9. 饮食建议：基于体质特征，提供适合的饮食结构和营养建议\\n10. 运动指导：推荐适合我的运动类型、运动强度和运动时间\\n11. 生活方式：作息规律、环境选择、生活习惯等方面的建议\\n12. 季节性调理：不同季节的健康注意事项和调理方法\\n13. 年龄段健康：人生不同阶段的健康重点和保健策略\"\n    },\n    {\n        id: \"fortune-analysis\",\n        name: \"运势\",\n        prompt: \"请对我的整体运势进行全面的紫微斗数专业分析，包括：\\n1. 大运系统分析：详细解析我当前所处的大运阶段，大运星曜对各方面运势的影响\\n2. 流年运势：当前流年的整体运势，流年星曜与命盘的相互作用\\n3. 事业运势：事业发展的机遇与挑战，职场人际关系，升职加薪的可能性\\n4. 财运走势：正财偏财的运势变化，投资理财的时机，需要注意的财务风险\\n5. 感情运势：单身者的桃花运，恋爱者的关系发展，已婚者的婚姻稳定性\\n6. 健康运势：身体状况的变化趋势，需要注意的健康问题，养生保健的重点\\n7. 人际关系：贵人运的表现，人际关系的和谐度，社交网络的扩展机会\\n8. 学业运势：学习效率，考试运，知识获取和技能发展的有利时机\\n9. 家庭运势：家庭关系的和谐度，家庭成员的状况，家庭事务的发展趋势\\n10. 机遇识别：未来一年内的重要机遇时间窗口，如何把握这些机遇\\n11. 挑战预警：可能遇到的困难和挑战，提前做好心理准备和应对策略\\n12. 化解方法：针对不利运势，提供具体的化解方法和改善建议\\n13. 提升策略：通过什么方式可以提升整体运势，增强正能量\\n14. 时间规划：基于运势分析，提供重要决策和行动的最佳时间安排\"\n    },\n    {\n        id: \"interpersonal\",\n        name: \"人际\",\n        prompt: \"请对我的人际关系进行专业的紫微斗数分析，包括：\\n1. 奴仆宫分析：奴仆宫星曜配置，反映我的人际关系模式、社交能力\\n2. 兄弟宫影响：兄弟宫星曜对朋友关系、同辈关系的影响\\n3. 命宫社交特质：命宫星曜反映的性格特点如何影响人际交往\\n4. 贵人星分析：命盘中的贵人星配置，贵人出现的时机和特征\\n5. 社交网络：我的社交圈特点、人脉质量、人际关系广度\\n6. 沟通模式：我的沟通风格、表达能力、人际互动特点\\n7. 冲突处理：面对人际冲突时的应对方式、解决能力\\n8. 信任建立：建立信任的能力、维持长期关系的特质\\n9. 社交障碍：可能存在的人际关系障碍及其化解方法\\n10. 实用建议：拓展人脉的具体方法、改善人际关系的实用技巧\"\n    },\n    {\n        id: \"family-relations\",\n        name: \"家庭\",\n        prompt: \"请对我的家庭关系进行专业的紫微斗数分析，包括：\\n1. 父母宫分析：父母宫星曜配置，反映与父母的关系、家庭背景影响\\n2. 田宅宫影响：田宅宫星曜对家庭环境、房产运势、家庭稳定性的影响\\n3. 兄弟宫家庭：兄弟宫星曜对兄弟姐妹关系、家族关系的影响\\n4. 夫妻宫家庭：夫妻宫星曜对婚姻家庭、配偶家庭关系的影响\\n5. 子女宫亲情：子女宫星曜对亲子关系、子女教育的影响\\n6. 家庭和谐度：家庭成员间的和谐程度、家庭氛围特点\\n7. 家庭责任：我在家庭中的责任担当、家庭角色定位\\n8. 家族运势：家族整体运势、家族传承、家族发展前景\\n9. 家庭问题：可能出现的家庭矛盾、家庭危机及其根源\\n10. 改善建议：促进家庭和谐的具体方法、改善家庭关系的实用策略\"\n    },\n    {\n        id: \"psychology-personality\",\n        name: \"心性\",\n        prompt: \"请对我的心理性格进行专业的紫微斗数深度分析，包括：\\n1. 命宫性格核心：命宫主星反映的核心性格特质、人格本质\\n2. 身宫性格表现：身宫星曜反映的外在性格表现、行为模式\\n3. 福德宫心理：福德宫星曜反映的心理状态、精神追求、幸福感来源\\n4. 疾厄宫情绪：疾厄宫星曜对情绪管理、压力承受能力的影响\\n5. 性格优势：我的主要性格优势、积极特质、天赋潜能\\n6. 性格挑战：需要克服的性格弱点、心理障碍、成长课题\\n7. 情绪模式：情绪波动特点、情绪管理能力、情绪表达方式\\n8. 思维方式：思维模式、决策风格、问题解决能力特点\\n9. 心理健康：心理健康状况、可能的心理问题、心理调适能力\\n10. 成长建议：性格优化的具体方法、心理成长的发展方向\"\n    },\n    {\n        id: \"yearly-prediction\",\n        name: \"流年\",\n        prompt: \"请对我当前和未来几年的流年运势进行专业的紫微斗数预测分析，包括：\\n1. 当前流年：详细分析当前流年的整体运势、各宫位影响\\n2. 未来3年流年：逐年分析未来3年的重要流年运势变化趋势\\n3. 流年吉凶：流年中的吉星凶星配置、吉凶事件的时间分布\\n4. 事业流年：未来几年事业发展的关键节点、机遇挑战\\n5. 财运流年：未来几年财运的起伏变化、财富积累的重要时期\\n6. 感情流年：未来几年感情发展的关键时机、重要情感事件\\n7. 健康流年：未来几年健康运势的变化、需要注意的健康问题\\n8. 转折点分析：流年中的重要转折点、人生阶段的转换时机\\n9. 流年化解：针对不利流年的具体化解方法和应对策略\\n10. 年度规划：基于流年预测，提供年度规划和行动建议\"\n    },\n    {\n        id: \"resolution-suggestions\",\n        name: \"建议\",\n        prompt: \"请针对我命盘中的不利因素提供专业的紫微斗数化解建议，包括：\\n1. 化忌星分析：命盘中化忌星的位置和影响，需要重点化解的方面\\n2. 凶星配置：命盘中的凶星组合及其潜在风险，化解的优先级\\n3. 宫位化解：各宫位中需要化解的不利因素和对应方法\\n4. 风水化解：通过环境布局、方位选择、色彩运用等方式化解不利因素\\n5. 行为化解：通过行为改变、习惯调整、心态转变等方式改善运势\\n6. 时间化解：选择有利时机进行重要决策，避开不利时间\\n7. 人际化解：通过贵人帮助、人际关系调整来化解不利因素\\n8. 修身养性：通过修身养性、积德行善来提升正能量\\n9. 具体方法：针对每个不利因素提供具体、可操作的化解方法\\n10. 预期效果：各种化解方法的预期效果和实施建议\"\n    },\n    {\n        id: \"life-planning\",\n        name: \"规划\",\n        prompt: \"请基于我的紫微斗数星盘提供专业的人生规划建议，包括：\\n1. 人生主线：基于命宫、身宫、三方四正分析我的人生发展主线\\n2. 阶段规划：根据大运变化，将人生划分为不同的发展阶段\\n3. 事业规划：长期事业发展方向、职业发展路径、事业高峰期预测\\n4. 财富规划：财富积累策略、投资理财方向、财务安全规划\\n5. 感情规划：感情发展时机、婚姻规划、家庭建设时间表\\n6. 健康规划：长期健康管理策略、疾病预防重点、养生规划\\n7. 教育规划：学习提升方向、技能发展规划、知识储备策略\\n8. 风险管理：人生各阶段的主要风险识别和防范策略\\n9. 机遇把握：重要机遇的识别方法和把握策略\\n10. 实施步骤：将长期规划分解为具体的短期目标和行动步骤\"\n    }\n];\n// 合盘模式下的快捷操作按钮\nexports.synastryQuickActions = [\n    {\n        id: \"friendship-compatibility\",\n        name: \"交友\",\n        prompt: `请对{person1}和{person2}的交友合盘进行专业的紫微斗数分析，包括：\n1. 命宫对比：分析两人命宫星曜的相容性、互补性和冲突性\n2. 性格匹配：对比两人的性格特质，分析交友中的优势和挑战\n3. 兄弟宫关系：兄弟宫星曜配置对友谊发展的影响\n4. 交友模式：两人各自的交友特点和偏好，以及相互适应性\n5. 友谊潜力：基于星盘分析，评估两人友谊的发展潜力和持久性\n6. 沟通方式：两人的沟通风格差异和协调方法\n7. 共同兴趣：基于星盘特征，分析两人可能共同感兴趣的领域\n8. 友谊阶段：预测友谊发展的不同阶段和特点\n9. 潜在问题：可能影响友谊的星盘因素和应对策略\n10. 友谊建议：基于星盘分析，提供促进友谊发展的具体建议`\n    },\n    {\n        id: \"love-compatibility\",\n        name: \"恋爱\",\n        prompt: `请对{person1}和{person2}的恋爱合盘进行专业的紫微斗数分析，包括：\n1. 夫妻宫分析：两人夫妻宫星曜的相容性和互动模式\n2. 感情特质：两人各自的感情特点和恋爱模式\n3. 桃花运对比：两人桃花运的强弱、时机和类型匹配度\n4. 情感需求：分析两人情感需求的异同和满足方式\n5. 恋爱阶段：预测恋爱关系发展的不同阶段和特点\n6. 吸引力分析：基于星盘分析两人之间的吸引力和化学反应\n7. 沟通模式：两人在恋爱中的沟通风格和协调方法\n8. 感情挑战：可能影响恋爱关系的星盘因素和挑战\n9. 恋爱时机：分析当前时期两人恋爱的有利和不利因素\n10. 恋爱建议：基于星盘分析，提供促进恋爱关系发展的具体建议`\n    },\n    {\n        id: \"marriage-compatibility\",\n        name: \"合婚\",\n        prompt: `请对{person1}和{person2}的婚姻合盘进行专业的紫微斗数分析，包括：\n1. 婚姻宫位分析：夫妻宫、子女宫等与婚姻相关的宫位星曜配置\n2. 婚姻相容性：两人星盘的整体相容性和婚姻和谐度\n3. 子女缘分：子女宫星曜配置，分析生育、子女教育等方面的配合\n4. 财运配合：两人财运的配合度和共同财富管理能力\n5. 事业支持：两人事业发展中的相互支持和影响\n6. 家庭责任：两人在家庭责任分担方面的配合度\n7. 婚姻挑战：可能影响婚姻的星盘因素和潜在问题\n8. 婚姻时机：分析适合结婚的时机和年份\n9. 婚姻质量：基于星盘预测婚姻生活的整体质量和稳定性\n10. 婚姻建议：基于星盘分析，提供促进婚姻和谐的具体建议和化解方法`\n    },\n    {\n        id: \"business-partnership\",\n        name: \"合伙\",\n        prompt: `请对{person1}和{person2}的合伙合盘进行专业的紫微斗数分析，包括：\n1. 事业宫配合：两人事业宫星曜的配合度和互补性\n2. 财运合作：两人财运的配合度和共同财富管理能力\n3. 性格互补：两人在性格、能力方面的互补性和合作潜力\n4. 决策模式：两人决策风格的差异和协调方法\n5. 责任分担：两人在责任分担方面的配合度\n6. 事业时机：分析合伙创业或合作的最佳时机\n7. 风险评估：基于星盘分析合伙可能面临的风险和挑战\n8. 利益分配：两人在利益分配方面的协调和公平性\n9. 长期合作：基于星盘预测长期合作的发展趋势和稳定性\n10. 合伙建议：基于星盘分析，提供促进合伙成功的具体建议和注意事项`\n    },\n    {\n        id: \"family-harmony\",\n        name: \"家庭\",\n        prompt: `请对{person1}和{person2}的家庭关系合盘进行专业的紫微斗数分析，包括：\n1. 家庭宫位分析：父母宫、田宅宫等与家庭相关的宫位星曜配置\n2. 家庭角色：两人在家庭中的角色定位和配合度\n3. 亲子关系：基于星盘分析两人作为亲子关系的和谐度\n4. 家庭责任：两人在家庭责任分担方面的配合度\n5. 家庭价值观：两人家庭价值观的相容性和差异\n6. 家庭沟通：两人在家庭沟通中的风格和效果\n7. 家庭挑战：可能影响家庭和谐的星盘因素和挑战\n8. 家庭支持：两人在家庭支持方面的相互配合\n9. 家庭发展：基于星盘预测家庭关系的发展趋势\n10. 家庭建议：基于星盘分析，提供促进家庭和谐的具体建议`\n    },\n    {\n        id: \"communication-style\",\n        name: \"沟通\",\n        prompt: `请对{person1}和{person2}的沟通合盘进行专业的紫微斗数分析，包括：\n1. 沟通宫位：分析影响沟通的相关宫位星曜配置\n2. 沟通风格：两人各自的沟通特点和风格差异\n3. 表达方式：两人在表达方式和接收信息方面的差异\n4. 冲突处理：两人处理沟通冲突的方式和效果\n5. 理解能力：两人相互理解的能力和障碍\n6. 沟通时机：分析有效沟通的最佳时机和方式\n7. 沟通挑战：可能影响沟通的星盘因素和挑战\n8. 沟通改进：基于星盘分析提供改进沟通的方法\n9. 深度交流：两人进行深度交流的相容性和效果\n10. 沟通建议：基于星盘分析，提供促进有效沟通的具体建议`\n    },\n    {\n        id: \"life-path\",\n        name: \"人生\",\n        prompt: `请对{person1}和{person2}的人生道路合盘进行专业的紫微斗数分析，包括：\n1. 命宫对比：两人命宫星曜的对比和人生方向分析\n2. 大运配合：两人大运的配合度和相互影响\n3. 人生阶段：两人人生阶段的同步性和相互支持\n4. 价值观对比：两人核心价值观的相容性和差异\n5. 人生目标：两人人生目标的协调性和相互支持\n6. 成长轨迹：两人成长轨迹的相似性和互补性\n7. 人生挑战：两人在人生道路上可能面临的共同挑战\n8. 机遇共享：两人共享人生机遇的可能性和方式\n9. 人生转折：两人人生转折点的同步性和相互影响\n10. 人生建议：基于星盘分析，提供两人共同发展的建议`\n    }\n];\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst QuestionPanel = ({ questionCategories, activeQuestionTab, onTabChange, onQuestionClick, showQuestionPanel, }) => {\n    if (!showQuestionPanel)\n        return null;\n    const activeCategory = questionCategories.find(c => c.name === activeQuestionTab);\n    return (react_1.default.createElement(\"div\", { className: \"question-panel\" },\n        react_1.default.createElement(\"div\", { className: \"question-tabs\" }, questionCategories.map((category) => (react_1.default.createElement(\"button\", { key: category.name, className: `tab-button question-tab-button ${activeQuestionTab === category.name ? \"active\" : \"\"}`, onClick: () => onTabChange(category.name) }, category.name)))),\n        react_1.default.createElement(\"div\", { className: \"question-content\" }, activeCategory === null || activeCategory === void 0 ? void 0 : activeCategory.subCategories.map((subCategory) => (react_1.default.createElement(\"div\", { key: subCategory.name, className: \"question-group\" },\n            react_1.default.createElement(\"h4\", { className: \"category-heading\" }, subCategory.name),\n            react_1.default.createElement(\"div\", { className: \"questions-wrapper\" }, subCategory.questions.map((question, index) => (react_1.default.createElement(\"p\", { key: index, onClick: () => onQuestionClick(question), className: \"question-text\" }, question))))))))));\n};\nexports.default = QuestionPanel;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst markdownFormatter_1 = __importDefault(require(\"../../utils/markdownFormatter\"));\n// 使用React.memo优化组件重渲染\nconst MessageItemComponent = ({ message, isLastMessage = false, showRegenerate = false, onRegenerate, messageRef, isStreaming = false, showActions = false, }) => {\n    const isUser = message.role === 'user';\n    const [displayedContent, setDisplayedContent] = (0, react_1.useState)('');\n    const [hasStartedStreaming, setHasStartedStreaming] = (0, react_1.useState)(false);\n    const contentRef = (0, react_1.useRef)(null);\n    // 使用useCallback优化函数\n    const handleCopy = (0, react_1.useCallback)(() => {\n        navigator.clipboard.writeText(message.content)\n            .then(() => {\n            // 可以添加复制成功的提示\n            console.log('内容已复制到剪贴板');\n        })\n            .catch(err => {\n            console.error('复制失败:', err);\n        });\n    }, [message.content]);\n    const handleShare = (0, react_1.useCallback)(() => {\n        if (navigator.share) {\n            const shareData = {\n                title: '紫微斗数AI回复',\n                text: message.content,\n            };\n            navigator.share(shareData)\n                .catch(err => {\n                console.error('分享失败:', err);\n                // 如果分享失败，尝试复制到剪贴板\n                handleCopy();\n            });\n        }\n        else {\n            // 如果不支持Web Share API，则复制到剪贴板\n            handleCopy();\n        }\n    }, [message.content, handleCopy]);\n    // 优化状态计算逻辑\n    const shouldShowActions = (0, react_1.useMemo)(() => {\n        return showActions && !isStreaming && !isUser && hasStartedStreaming;\n    }, [showActions, isStreaming, isUser, hasStartedStreaming]);\n    // 合并多个useEffect为一个，减少渲染次数\n    (0, react_1.useEffect)(() => {\n        // 直接使用message.content，不需要previousContent状态\n        setDisplayedContent(message.content);\n        if (!isUser && isStreaming) {\n            setHasStartedStreaming(true);\n        }\n    }, [message.content, isUser, isStreaming]);\n    return (react_1.default.createElement(\"div\", { ref: messageRef, className: `message-item ${isUser ? 'user-message' : 'assistant-message'}` },\n        react_1.default.createElement(\"div\", { className: `message-wrapper ${isUser ? 'user-message' : 'assistant-message'}` },\n            react_1.default.createElement(\"div\", { className: `message-content ${isUser ? 'user-message' : 'assistant-message'}` }, isUser ? (displayedContent) : (react_1.default.createElement(\"div\", { ref: contentRef, className: \"markdown-content message-markdown\" },\n                react_1.default.createElement(markdownFormatter_1.default, { content: displayedContent })))),\n            showRegenerate && (react_1.default.createElement(react_1.default.Fragment, null,\n                react_1.default.createElement(\"div\", { className: \"message-spacer\" }),\n                react_1.default.createElement(\"div\", { className: \"regenerate-container\" },\n                    react_1.default.createElement(\"button\", { className: \"regenerate-button quick-action-button\", onClick: onRegenerate, title: \"\\u91CD\\u65B0\\u751F\\u6210\" },\n                        react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"14\", height: \"14\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                            react_1.default.createElement(\"path\", { d: \"M1 4v6h6\" }),\n                            react_1.default.createElement(\"path\", { d: \"M3.51 15a9 9 0 1 0 2.13-9.36L1 10\" })),\n                        react_1.default.createElement(\"span\", null, \"\\u91CD\\u65B0\\u751F\\u6210\"))))),\n            shouldShowActions && (react_1.default.createElement(react_1.default.Fragment, null,\n                react_1.default.createElement(\"div\", { className: \"message-spacer\" }),\n                react_1.default.createElement(\"div\", { className: \"message-actions-container\" },\n                    react_1.default.createElement(\"button\", { className: \"copy-button\", onClick: handleCopy, title: \"\\u590D\\u5236\", \"aria-label\": \"\\u590D\\u5236\" },\n                        react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"16\", height: \"16\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                            react_1.default.createElement(\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\" }),\n                            react_1.default.createElement(\"path\", { d: \"m4 16c-1.1 0-2-.9-2-2v-10c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\" }))),\n                    react_1.default.createElement(\"button\", { className: \"share-button\", onClick: handleShare, title: \"\\u5206\\u4EAB\", \"aria-label\": \"\\u5206\\u4EAB\" },\n                        react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"16\", height: \"16\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                            react_1.default.createElement(\"circle\", { cx: \"18\", cy: \"5\", r: \"3\" }),\n                            react_1.default.createElement(\"circle\", { cx: \"6\", cy: \"12\", r: \"3\" }),\n                            react_1.default.createElement(\"circle\", { cx: \"18\", cy: \"19\", r: \"3\" }),\n                            react_1.default.createElement(\"line\", { x1: \"8.59\", y1: \"13.51\", x2: \"15.42\", y2: \"17.49\" }),\n                            react_1.default.createElement(\"line\", { x1: \"15.41\", y1: \"6.51\", x2: \"8.59\", y2: \"10.49\" })))))))));\n};\n// 使用React.memo优化组件重渲染，避免不必要的重新渲染\nconst MessageItem = react_1.default.memo(MessageItemComponent);\nexports.default = MessageItem;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.formatAstrolabeForAI = void 0;\n/**\n * 格式化星耀数据为可读字符串\n * @param stars 星耀数组\n * @returns 格式化后的星耀字符串\n */\nconst formatStars = (stars) => {\n    if (!stars || stars.length === 0)\n        return '无';\n    return stars.join('、');\n};\n/**\n * 格式化宫位数据为可读字符串\n * @param palace 宫位数据\n * @returns 格式化后的宫位信息字符串\n */\nconst formatPalace = (palace) => {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    const majorStars = ((_a = palace.majorStars) === null || _a === void 0 ? void 0 : _a.map(star => star.name)) || [];\n    const minorStars = ((_b = palace.minorStars) === null || _b === void 0 ? void 0 : _b.map(star => star.name)) || [];\n    const adjectiveStars = ((_c = palace.adjectiveStars) === null || _c === void 0 ? void 0 : _c.map(star => star.name)) || [];\n    return `\n宫位：${palace.name}\n天干地支：${palace.heavenlyStem}${palace.earthlyBranch}\n主星：${formatStars(majorStars)}\n辅星：${formatStars(minorStars)}\n杂耀：${formatStars(adjectiveStars)}\n长生12神：${palace.changsheng12 || '无'}\n博士12神：${palace.boshi12 || '无'}\n将前12神：${palace.jiangqian12 || '无'}\n岁前12神：${palace.suiqian12 || '无'}\n大限：${(_e = (_d = palace.decadal) === null || _d === void 0 ? void 0 : _d.range) === null || _e === void 0 ? void 0 : _e[0]}-${(_g = (_f = palace.decadal) === null || _f === void 0 ? void 0 : _f.range) === null || _g === void 0 ? void 0 : _g[1]}岁\n小限：${((_h = palace.ages) === null || _h === void 0 ? void 0 : _h.join('、')) || '无'}\n${palace.isBodyPalace ? '【身宫】' : ''}\n${palace.isOriginalPalace ? '【来因宫】' : ''}\n  `.trim();\n};\n/**\n * 将星盘数据格式化为AI可理解的文本格式\n * @param astrolabe 星盘数据\n * @param currentTime 当前时间\n * @returns 格式化后的星盘信息文本\n */\nconst formatAstrolabeForAI = (astrolabe, currentTime = new Date()) => {\n    if (!astrolabe) {\n        return '暂无星盘数据';\n    }\n    const formattedTime = currentTime.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        hour12: false\n    });\n    let result = `\n=== 紫微斗数星盘数据 ===\n当前时间：${formattedTime}\n\n基本信息：\n姓名：${astrolabe.gender === 'male' ? '男' : '女'}\n阳历日期：${astrolabe.solarDate}\n农历日期：${astrolabe.lunarDate}\n干支纪年：${astrolabe.chineseDate}\n出生时辰：${astrolabe.time}（${astrolabe.timeRange}）\n星座：${astrolabe.sign}\n生肖：${astrolabe.zodiac}\n命宫地支：${astrolabe.earthlyBranchOfSoulPalace}\n身宫地支：${astrolabe.earthlyBranchOfBodyPalace}\n命主：${astrolabe.soul}\n身主：${astrolabe.body}\n五行局：${astrolabe.fiveElementsClass}\n\n十二宫位详情：\n`;\n    // 添加十二宫位信息\n    if (astrolabe.palaces && astrolabe.palaces.length > 0) {\n        astrolabe.palaces.forEach((palace, index) => {\n            result += `\\n--- 第${index + 1}宫 ---\\n`;\n            result += formatPalace(palace);\n            result += '\\n\\n';\n        });\n    }\n    // 添加当前运限信息\n    if (astrolabe.horoscope) {\n        const horoscope = astrolabe.horoscope();\n        if (horoscope) {\n            result += `\n=== 当前运限信息 ===\n查询日期：${horoscope.solarDate}\n农历日期：${horoscope.lunarDate}\n\n大限：\n天干地支：${horoscope.decadal.heavenlyStem}${horoscope.decadal.earthlyBranch}\n四化星：${formatStars(horoscope.decadal.mutagen || [])}\n\n小限：\n虚岁：${horoscope.age.nominalAge}\n天干地支：${horoscope.age.heavenlyStem}${horoscope.age.earthlyBranch}\n\n流年：\n天干地支：${horoscope.yearly.heavenlyStem}${horoscope.yearly.earthlyBranch}\n四化星：${formatStars(horoscope.yearly.mutagen || [])}\n\n流月：\n天干地支：${horoscope.monthly.heavenlyStem}${horoscope.monthly.earthlyBranch}\n\n流日：\n天干地支：${horoscope.daily.heavenlyStem}${horoscope.daily.earthlyBranch}\n\n流时：\n天干地支：${horoscope.hourly.heavenlyStem}${horoscope.hourly.earthlyBranch}\n`;\n        }\n    }\n    return result.trim();\n};\nexports.formatAstrolabeForAI = formatAstrolabeForAI;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Line = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst utils_1 = require(\"iztro/lib/utils\");\nconst Line = ({ index, scope }) => {\n    const line = (0, react_1.useRef)(null);\n    const strokeColor = (0, react_1.useMemo)(() => {\n        if (scope) {\n            const element = document.getElementsByClassName(\"iztro-astrolabe-theme-default\")[0];\n            const computedStyle = getComputedStyle(element);\n            // 获取CSS中定义的变量的值\n            return computedStyle.getPropertyValue(`--iztro-color-${scope}`);\n        }\n        return \"rgba(245,0,0)\";\n    }, [scope]);\n    (0, react_1.useEffect)(() => {\n        const idx = index;\n        const canvasDom = line.current;\n        if (!canvasDom || idx < 0) {\n            return;\n        }\n        const { height, width } = canvasDom.getBoundingClientRect();\n        canvasDom.width = width;\n        canvasDom.height = height;\n        const w = width / 2;\n        const h = height / 2;\n        const points = [\n            [0, h * 2],\n            [0, h * 1.5],\n            [0, h * 0.5],\n            [0, 0],\n            [w * 0.5, 0],\n            [w * 1.5, 0],\n            [w * 2, 0],\n            [w * 2, h * 0.5],\n            [w * 2, h * 1.5],\n            [w * 2, h * 2],\n            [w * 1.5, h * 2],\n            [w * 0.5, h * 2],\n        ];\n        //第二步：获取上下文\n        const canvasCtx = canvasDom.getContext(\"2d\");\n        if (!canvasCtx) {\n            return;\n        }\n        canvasCtx.clearRect(0, 0, canvasDom.width, canvasDom.height);\n        canvasCtx.strokeStyle = strokeColor;\n        canvasCtx.lineWidth = 1;\n        canvasCtx.globalAlpha = 0.5;\n        const dgIdx = (0, utils_1.fixIndex)(idx + 6);\n        const q4Idx = (0, utils_1.fixIndex)(idx + 4);\n        const h4Idx = (0, utils_1.fixIndex)(idx - 4);\n        canvasCtx.beginPath();\n        canvasCtx.moveTo(points[dgIdx][0], points[dgIdx][1]);\n        canvasCtx.lineTo(points[idx][0], points[idx][1]);\n        canvasCtx.lineTo(points[q4Idx][0], points[q4Idx][1]);\n        canvasCtx.lineTo(points[h4Idx][0], points[h4Idx][1]);\n        canvasCtx.lineTo(points[idx][0], points[idx][1]);\n        canvasCtx.stroke();\n    }, [index, strokeColor]);\n    return (react_1.default.createElement(\"canvas\", { id: \"palace-line\", className: `palace-line ${scope || ''}`, ref: line }));\n};\nexports.Line = Line;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst HistoryModal = ({ history, showHistoryModal, setShowHistoryModal, searchTerm, setSearchTerm, showPasswordInput, setShowPasswordInput, password, setPassword, isCloudStorageEnabled, isLoading, editingHistoryId, setEditingHistoryId, handlePasswordSubmit, handleDeleteHistory, handleClearHistory, onLoadHistory, onEditHistory, chartMode, }) => {\n    const handlePasswordKeyDown = (0, react_1.useCallback)((e) => {\n        if (e.key === 'Enter') {\n            handlePasswordSubmit();\n        }\n    }, [handlePasswordSubmit]);\n    if (!showHistoryModal)\n        return null;\n    return (react_1.default.createElement(\"div\", { className: \"history-modal-overlay\", onClick: () => setShowHistoryModal(false) },\n        react_1.default.createElement(\"div\", { className: \"history-modal\", onClick: (e) => e.stopPropagation() },\n            react_1.default.createElement(\"div\", { className: \"history-modal-header\" },\n                react_1.default.createElement(\"h2\", { className: \"history-title\", title: isCloudStorageEnabled ? \"云存储已启用\" : \"点击输入密码启用云存储\", onClick: () => !isCloudStorageEnabled && setShowPasswordInput(!showPasswordInput) },\n                    \"\\u5386\\u53F2\\u8BB0\\u5F55 \",\n                    isCloudStorageEnabled && \"☁️\")),\n            showPasswordInput && (react_1.default.createElement(\"div\", { className: \"history-password-container\" },\n                react_1.default.createElement(\"input\", { type: \"password\", className: \"history-password-input\", placeholder: \"\\u8F93\\u5165\\u4E91\\u5B58\\u50A8\\u5BC6\\u7801\", value: password, onChange: (e) => setPassword(e.target.value), onKeyDown: handlePasswordKeyDown, disabled: isLoading }),\n                react_1.default.createElement(\"button\", { className: \"history-password-button\", onClick: handlePasswordSubmit, disabled: isLoading || !password.trim() }, isLoading ? \"验证中...\" : \"确认\"))),\n            react_1.default.createElement(\"div\", { className: \"history-search-container\" },\n                react_1.default.createElement(\"input\", { type: \"text\", className: \"history-search-input\", placeholder: \"\\u641C\\u7D22\\u5386\\u53F2\\u8BB0\\u5F55...\", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value) })),\n            react_1.default.createElement(\"div\", { className: \"history-modal-content\" }, history.length === 0 ? (react_1.default.createElement(\"div\", { className: \"history-empty\" }, \"\\u6682\\u65E0\\u5386\\u53F2\\u8BB0\\u5F55\")) : (react_1.default.createElement(\"div\", { className: \"history-list\" }, history\n                .filter(item => item.type === chartMode)\n                .map((item) => {\n                var _a;\n                return (react_1.default.createElement(\"div\", { key: item.id, className: \"history-item\" },\n                    react_1.default.createElement(\"div\", { className: \"history-item-content\", onClick: () => {\n                            onLoadHistory(item);\n                            setShowHistoryModal(false);\n                        } },\n                        react_1.default.createElement(\"div\", { className: \"history-item-main\" },\n                            react_1.default.createElement(\"span\", { className: \"history-item-name\" }, item.type === 'single' ? item.name : `${item.name} 和 ${((_a = item.person2) === null || _a === void 0 ? void 0 : _a.name) || '第二个人'}`),\n                            react_1.default.createElement(\"span\", { className: \"history-item-info\" },\n                                item.year,\n                                \"-\",\n                                item.month,\n                                \"-\",\n                                item.day)),\n                        react_1.default.createElement(\"div\", { className: \"history-item-actions\" },\n                            react_1.default.createElement(\"button\", { className: \"history-edit-icon\", onClick: (e) => {\n                                    e.stopPropagation();\n                                    onEditHistory(item);\n                                    setEditingHistoryId(item.id);\n                                    setShowHistoryModal(false);\n                                }, title: \"\\u7F16\\u8F91\" }, \"\\u270F\\uFE0F\"),\n                            react_1.default.createElement(\"button\", { className: \"history-delete-icon\", onClick: (e) => {\n                                    e.stopPropagation();\n                                    if (confirm('确定要删除这条历史记录吗？')) {\n                                        handleDeleteHistory(item.id);\n                                    }\n                                }, title: \"\\u5220\\u9664\" }, \"\\uD83D\\uDDD1\\uFE0F\")))));\n            })))),\n            react_1.default.createElement(\"div\", { className: \"history-modal-footer\" },\n                react_1.default.createElement(\"button\", { className: \"history-clear-button\", onClick: handleClearHistory, disabled: isCloudStorageEnabled, title: isCloudStorageEnabled ? \"云存储已启用，无法清空历史记录\" : \"清空所有历史记录\" }, \"\\u6E05\\u7A7A\\u5386\\u53F2\\u8BB0\\u5F55\")))));\n};\nexports.default = react_1.default.memo(HistoryModal);\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FormContainer = void 0;\nconst react_1 = __importDefault(require(\"react\"));\nconst SegmentedControl_1 = require(\"../SegmentedControl/SegmentedControl\");\n/**\n * 表单容器组件\n * 负责处理排盘和合盘表单的显示和交互\n */\nconst FormContainer = ({ chartMode, setChartMode, formData, synastryData, onFormChange, onSynastryChange, onRadioChange, onSynastryRadioChange, onSubmit, onSynastrySubmit, onShowHistory, }) => {\n    const handleFormChange = (e) => {\n        const { name, value } = e.target;\n        onFormChange(Object.assign(Object.assign({}, formData), { [name]: name === 'birthTime' ? parseInt(value) : value }));\n    };\n    const handleSynastryChange = (person, e) => {\n        const { name, value } = e.target;\n        onSynastryChange(person, Object.assign(Object.assign({}, synastryData[person]), { [name]: name === 'birthTime' ? parseInt(value) : value }));\n    };\n    return (react_1.default.createElement(\"div\", { className: \"form-section\" },\n        react_1.default.createElement(\"div\", { className: \"form-group form-group-segmented\" },\n            react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"chartMode\", options: [\n                    { label: \"排盘\", value: \"single\" },\n                    { label: \"合盘\", value: \"synastry\" },\n                ], value: chartMode, onChange: (value) => setChartMode(value) })),\n        chartMode === \"single\" && (react_1.default.createElement(\"form\", { onSubmit: onSubmit },\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"name\" }, \"\\u59D3\\u540D\\uFF08\\u53EF\\u9009\\uFF09\"),\n                react_1.default.createElement(\"input\", { type: \"text\", id: \"name\", name: \"name\", value: formData.name, onChange: handleFormChange })),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile gender-date\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u6027\\u522B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"gender\", options: [\n                            { label: \"男\", value: \"male\" },\n                            { label: \"女\", value: \"female\" },\n                        ], value: formData.gender, onChange: (value) => onRadioChange(\"gender\", value) })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u65E5\\u671F\\u7C7B\\u578B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"birthdayType\", options: [\n                            { label: \"阳历\", value: \"solar\" },\n                            { label: \"农历\", value: \"lunar\" },\n                        ], value: formData.birthdayType, onChange: (value) => onRadioChange(\"birthdayType\", value) }))),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile date-fields\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"year\" }, \"\\u5E74\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"year\", name: \"year\", value: formData.year, onChange: handleFormChange, min: \"1900\", max: \"2100\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"month\" }, \"\\u6708\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"month\", name: \"month\", value: formData.month, onChange: handleFormChange, min: \"1\", max: \"12\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"day\" }, \"\\u65E5\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"day\", name: \"day\", value: formData.day, onChange: handleFormChange, min: \"1\", max: \"31\" }))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"birthTime\" }, \"\\u51FA\\u751F\\u65F6\\u8FB0\"),\n                react_1.default.createElement(\"select\", { id: \"birthTime\", name: \"birthTime\", value: formData.birthTime, onChange: handleFormChange },\n                    react_1.default.createElement(\"option\", { value: 0 }, \"\\u65E9\\u5B50\\u65F6(00:00~01:00)\"),\n                    react_1.default.createElement(\"option\", { value: 1 }, \"\\u4E11\\u65F6(01:00~03:00)\"),\n                    react_1.default.createElement(\"option\", { value: 2 }, \"\\u5BC5\\u65F6(03:00~05:00)\"),\n                    react_1.default.createElement(\"option\", { value: 3 }, \"\\u536F\\u65F6(05:00~07:00)\"),\n                    react_1.default.createElement(\"option\", { value: 4 }, \"\\u8FB0\\u65F6(07:00~09:00)\"),\n                    react_1.default.createElement(\"option\", { value: 5 }, \"\\u5DF3\\u65F6(09:00~11:00)\"),\n                    react_1.default.createElement(\"option\", { value: 6 }, \"\\u5348\\u65F6(11:00~13:00)\"),\n                    react_1.default.createElement(\"option\", { value: 7 }, \"\\u672A\\u65F6(13:00~15:00)\"),\n                    react_1.default.createElement(\"option\", { value: 8 }, \"\\u7533\\u65F6(15:00~17:00)\"),\n                    react_1.default.createElement(\"option\", { value: 9 }, \"\\u9149\\u65F6(17:00~19:00)\"),\n                    react_1.default.createElement(\"option\", { value: 10 }, \"\\u620C\\u65F6(19:00~21:00)\"),\n                    react_1.default.createElement(\"option\", { value: 11 }, \"\\u4EA5\\u65F6(21:00~23:00)\"),\n                    react_1.default.createElement(\"option\", { value: 12 }, \"\\u665A\\u5B50\\u65F6(23:00~00:00)\"))),\n            react_1.default.createElement(\"button\", { type: \"submit\" }, \"\\u5F00\\u59CB\\u6392\\u76D8\"),\n            react_1.default.createElement(\"button\", { type: \"button\", className: \"history-button\", onClick: onShowHistory }, \"\\u5386\\u53F2\\u8BB0\\u5F55\"))),\n        chartMode === \"synastry\" && (react_1.default.createElement(\"form\", { onSubmit: onSynastrySubmit },\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"h3\", null, \"\\u7B2C\\u4E00\\u4E2A\\u4EBA\")),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person1-name\" }, \"\\u59D3\\u540D\\uFF08\\u53EF\\u9009\\uFF09\"),\n                react_1.default.createElement(\"input\", { type: \"text\", id: \"person1-name\", name: \"name\", value: synastryData.person1.name, onChange: (e) => handleSynastryChange(\"person1\", e) })),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile gender-date\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u6027\\u522B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person1-gender\", options: [\n                            { label: \"男\", value: \"male\" },\n                            { label: \"女\", value: \"female\" },\n                        ], value: synastryData.person1.gender, onChange: (value) => onSynastryRadioChange(\"person1\", \"gender\", value) })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u65E5\\u671F\\u7C7B\\u578B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person1-birthdayType\", options: [\n                            { label: \"阳历\", value: \"solar\" },\n                            { label: \"农历\", value: \"lunar\" },\n                        ], value: synastryData.person1.birthdayType, onChange: (value) => onSynastryRadioChange(\"person1\", \"birthdayType\", value) }))),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile date-fields\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person1-year\" }, \"\\u5E74\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person1-year\", name: \"year\", value: synastryData.person1.year, onChange: (e) => handleSynastryChange(\"person1\", e), min: \"1900\", max: \"2100\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person1-month\" }, \"\\u6708\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person1-month\", name: \"month\", value: synastryData.person1.month, onChange: (e) => handleSynastryChange(\"person1\", e), min: \"1\", max: \"12\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person1-day\" }, \"\\u65E5\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person1-day\", name: \"day\", value: synastryData.person1.day, onChange: (e) => handleSynastryChange(\"person1\", e), min: \"1\", max: \"31\" }))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person1-birthTime\" }, \"\\u51FA\\u751F\\u65F6\\u8FB0\"),\n                react_1.default.createElement(\"select\", { id: \"person1-birthTime\", name: \"birthTime\", value: synastryData.person1.birthTime, onChange: (e) => handleSynastryChange(\"person1\", e) },\n                    react_1.default.createElement(\"option\", { value: 0 }, \"\\u65E9\\u5B50\\u65F6(00:00~01:00)\"),\n                    react_1.default.createElement(\"option\", { value: 1 }, \"\\u4E11\\u65F6(01:00~03:00)\"),\n                    react_1.default.createElement(\"option\", { value: 2 }, \"\\u5BC5\\u65F6(03:00~05:00)\"),\n                    react_1.default.createElement(\"option\", { value: 3 }, \"\\u536F\\u65F6(05:00~07:00)\"),\n                    react_1.default.createElement(\"option\", { value: 4 }, \"\\u8FB0\\u65F6(07:00~09:00)\"),\n                    react_1.default.createElement(\"option\", { value: 5 }, \"\\u5DF3\\u65F6(09:00~11:00)\"),\n                    react_1.default.createElement(\"option\", { value: 6 }, \"\\u5348\\u65F6(11:00~13:00)\"),\n                    react_1.default.createElement(\"option\", { value: 7 }, \"\\u672A\\u65F6(13:00~15:00)\"),\n                    react_1.default.createElement(\"option\", { value: 8 }, \"\\u7533\\u65F6(15:00~17:00)\"),\n                    react_1.default.createElement(\"option\", { value: 9 }, \"\\u9149\\u65F6(17:00~19:00)\"),\n                    react_1.default.createElement(\"option\", { value: 10 }, \"\\u620C\\u65F6(19:00~21:00)\"),\n                    react_1.default.createElement(\"option\", { value: 11 }, \"\\u4EA5\\u65F6(21:00~23:00)\"),\n                    react_1.default.createElement(\"option\", { value: 12 }, \"\\u665A\\u5B50\\u65F6(23:00~00:00)\"))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"h3\", null, \"\\u7B2C\\u4E8C\\u4E2A\\u4EBA\")),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person2-name\" }, \"\\u59D3\\u540D\\uFF08\\u53EF\\u9009\\uFF09\"),\n                react_1.default.createElement(\"input\", { type: \"text\", id: \"person2-name\", name: \"name\", value: synastryData.person2.name, onChange: (e) => handleSynastryChange(\"person2\", e) })),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile gender-date\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u6027\\u522B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person2-gender\", options: [\n                            { label: \"男\", value: \"male\" },\n                            { label: \"女\", value: \"female\" },\n                        ], value: synastryData.person2.gender, onChange: (value) => onSynastryRadioChange(\"person2\", \"gender\", value) })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u65E5\\u671F\\u7C7B\\u578B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person2-birthdayType\", options: [\n                            { label: \"阳历\", value: \"solar\" },\n                            { label: \"农历\", value: \"lunar\" },\n                        ], value: synastryData.person2.birthdayType, onChange: (value) => onSynastryRadioChange(\"person2\", \"birthdayType\", value) }))),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile date-fields\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person2-year\" }, \"\\u5E74\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person2-year\", name: \"year\", value: synastryData.person2.year, onChange: (e) => handleSynastryChange(\"person2\", e), min: \"1900\", max: \"2100\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person2-month\" }, \"\\u6708\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person2-month\", name: \"month\", value: synastryData.person2.month, onChange: (e) => handleSynastryChange(\"person2\", e), min: \"1\", max: \"12\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person2-day\" }, \"\\u65E5\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person2-day\", name: \"day\", value: synastryData.person2.day, onChange: (e) => handleSynastryChange(\"person2\", e), min: \"1\", max: \"31\" }))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person2-birthTime\" }, \"\\u51FA\\u751F\\u65F6\\u8FB0\"),\n                react_1.default.createElement(\"select\", { id: \"person2-birthTime\", name: \"birthTime\", value: synastryData.person2.birthTime, onChange: (e) => handleSynastryChange(\"person2\", e) },\n                    react_1.default.createElement(\"option\", { value: 0 }, \"\\u65E9\\u5B50\\u65F6(00:00~01:00)\"),\n                    react_1.default.createElement(\"option\", { value: 1 }, \"\\u4E11\\u65F6(01:00~03:00)\"),\n                    react_1.default.createElement(\"option\", { value: 2 }, \"\\u5BC5\\u65F6(03:00~05:00)\"),\n                    react_1.default.createElement(\"option\", { value: 3 }, \"\\u536F\\u65F6(05:00~07:00)\"),\n                    react_1.default.createElement(\"option\", { value: 4 }, \"\\u8FB0\\u65F6(07:00~09:00)\"),\n                    react_1.default.createElement(\"option\", { value: 5 }, \"\\u5DF3\\u65F6(09:00~11:00)\"),\n                    react_1.default.createElement(\"option\", { value: 6 }, \"\\u5348\\u65F6(11:00~13:00)\"),\n                    react_1.default.createElement(\"option\", { value: 7 }, \"\\u672A\\u65F6(13:00~15:00)\"),\n                    react_1.default.createElement(\"option\", { value: 8 }, \"\\u7533\\u65F6(15:00~17:00)\"),\n                    react_1.default.createElement(\"option\", { value: 9 }, \"\\u9149\\u65F6(17:00~19:00)\"),\n                    react_1.default.createElement(\"option\", { value: 10 }, \"\\u620C\\u65F6(19:00~21:00)\"),\n                    react_1.default.createElement(\"option\", { value: 11 }, \"\\u4EA5\\u65F6(21:00~23:00)\"),\n                    react_1.default.createElement(\"option\", { value: 12 }, \"\\u665A\\u5B50\\u65F6(23:00~00:00)\"))),\n            react_1.default.createElement(\"button\", { type: \"submit\" }, \"\\u5F00\\u59CB\\u5408\\u76D8\"),\n            react_1.default.createElement(\"button\", { type: \"button\", className: \"history-button\", onClick: onShowHistory }, \"\\u5386\\u53F2\\u8BB0\\u5F55\")))));\n};\nexports.FormContainer = FormContainer;\nexports.default = exports.FormContainer;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst TypingIndicator = () => {\n    return (react_1.default.createElement(\"div\", { className: \"typing-indicator\" },\n        react_1.default.createElement(\"span\", { className: \"typing-dot\" }),\n        react_1.default.createElement(\"span\", { className: \"typing-dot\" }),\n        react_1.default.createElement(\"span\", { className: \"typing-dot\" })));\n};\nexports.default = TypingIndicator;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAIChatRequest = exports.useNetworkRequest = void 0;\nconst react_1 = require(\"react\");\n/**\n * 网络请求Hook\n * 提供缓存、重试和错误处理功能\n */\nconst useNetworkRequest = (options = {}) => {\n    const { cacheKey, cacheTTL = 5 * 60 * 1000, // 默认缓存5分钟\n    maxRetries = 2, retryDelay = 1000, // 默认重试延迟1秒\n    retryBackoff = 2, // 默认重试延迟倍数\n     } = options;\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [error, setError] = (0, react_1.useState)(null);\n    const abortControllerRef = (0, react_1.useRef)(null);\n    // 内存缓存\n    const cacheRef = (0, react_1.useRef)(new Map());\n    // 检查缓存是否有效\n    const isCacheValid = (0, react_1.useCallback)((entry) => {\n        return Date.now() - entry.timestamp < cacheTTL;\n    }, [cacheTTL]);\n    // 从缓存获取数据\n    const getFromCache = (0, react_1.useCallback)((key) => {\n        if (!cacheKey)\n            return null;\n        const fullKey = `${cacheKey}:${key}`;\n        const entry = cacheRef.current.get(fullKey);\n        if (entry && isCacheValid(entry)) {\n            return entry.data;\n        }\n        return null;\n    }, [cacheKey, isCacheValid]);\n    // 设置缓存\n    const setCache = (0, react_1.useCallback)((key, data) => {\n        if (!cacheKey)\n            return;\n        const fullKey = `${cacheKey}:${key}`;\n        cacheRef.current.set(fullKey, {\n            data,\n            timestamp: Date.now(),\n        });\n    }, [cacheKey]);\n    // 清除缓存\n    const clearCache = (0, react_1.useCallback)(() => {\n        if (!cacheKey)\n            return;\n        // 清除特定前缀的缓存\n        const keys = Array.from(cacheRef.current.keys());\n        for (const key of keys) {\n            if (key.startsWith(`${cacheKey}:`)) {\n                cacheRef.current.delete(key);\n            }\n        }\n    }, [cacheKey]);\n    // 延迟函数\n    const delay = (0, react_1.useCallback)((ms) => {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }, []);\n    // 发送请求\n    const sendRequest = (0, react_1.useCallback)((requestConfig, customCacheKey) => __awaiter(void 0, void 0, void 0, function* () {\n        const { url, options = {}, body } = requestConfig;\n        // 如果有缓存，直接返回缓存数据\n        const cacheData = getFromCache(customCacheKey || url);\n        if (cacheData) {\n            return cacheData;\n        }\n        // 取消之前的请求\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n        }\n        // 创建新的AbortController\n        abortControllerRef.current = new AbortController();\n        setIsLoading(true);\n        setError(null);\n        let retryCount = 0;\n        let currentRetryDelay = retryDelay;\n        const attemptRequest = () => __awaiter(void 0, void 0, void 0, function* () {\n            var _a;\n            try {\n                const fetchOptions = Object.assign(Object.assign({}, options), { signal: (_a = abortControllerRef.current) === null || _a === void 0 ? void 0 : _a.signal });\n                if (body) {\n                    fetchOptions.body = JSON.stringify(body);\n                    if (!fetchOptions.headers) {\n                        fetchOptions.headers = {};\n                    }\n                    fetchOptions.headers['Content-Type'] = 'application/json';\n                }\n                const response = yield fetch(url, fetchOptions);\n                if (!response.ok) {\n                    throw new Error(`HTTP error! status: ${response.status}`);\n                }\n                const data = yield response.json();\n                // 缓存响应数据\n                setCache(customCacheKey || url, data);\n                return data;\n            }\n            catch (err) {\n                // 如果是手动中止的错误，不重试\n                if (err instanceof Error && err.name === 'AbortError') {\n                    throw err;\n                }\n                retryCount++;\n                // 如果达到最大重试次数，抛出错误\n                if (retryCount > maxRetries) {\n                    setError(err);\n                    throw err;\n                }\n                // 指数退避重试\n                yield delay(currentRetryDelay);\n                currentRetryDelay *= retryBackoff;\n                // 递归重试\n                return attemptRequest();\n            }\n        });\n        try {\n            const result = yield attemptRequest();\n            return result;\n        }\n        finally {\n            setIsLoading(false);\n        }\n    }), [\n        getFromCache,\n        setCache,\n        retryDelay,\n        retryBackoff,\n        maxRetries,\n        delay,\n    ]);\n    // 取消请求\n    const cancelRequest = (0, react_1.useCallback)(() => {\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n            abortControllerRef.current = null;\n        }\n        setIsLoading(false);\n    }, []);\n    return {\n        isLoading,\n        error,\n        sendRequest,\n        cancelRequest,\n        clearCache,\n    };\n};\nexports.useNetworkRequest = useNetworkRequest;\n/**\n * AI聊天专用的网络请求Hook\n * 针对AI聊天接口进行优化\n */\nconst useAIChatRequest = () => {\n    const { sendRequest, isLoading, error, clearCache } = (0, exports.useNetworkRequest)({\n        cacheKey: 'ai-chat',\n        cacheTTL: 10 * 60 * 1000, // AI聊天缓存10分钟\n        maxRetries: 3,\n        retryDelay: 1000,\n        retryBackoff: 1.5,\n    });\n    // 发送AI聊天请求\n    const sendChatRequest = (0, react_1.useCallback)((messages_1, ...args_1) => __awaiter(void 0, [messages_1, ...args_1], void 0, function* (messages, options = {}) {\n        const { model = \"sydf-v1-250520\", temperature = 0.7, stream = true } = options;\n        return sendRequest({\n            url: \"https://flow.ovo.gs/ai\",\n            options: {\n                method: \"POST\",\n            },\n            body: {\n                model,\n                messages,\n                temperature,\n                stream,\n            },\n        }, `chat:${JSON.stringify(messages.slice(-5))}`); // 使用最后5条消息作为缓存键\n    }), [sendRequest]);\n    return {\n        isLoading,\n        error,\n        sendChatRequest,\n        clearCache,\n    };\n};\nexports.useAIChatRequest = useAIChatRequest;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Item = void 0;\nconst react_1 = __importDefault(require(\"react\"));\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst Item = ({ title, content }) => {\n    return (react_1.default.createElement(\"li\", { className: (0, classnames_1.default)(\"iztro-palace-center-item\") },\n        react_1.default.createElement(\"label\", null, title),\n        react_1.default.createElement(\"span\", null, content)));\n};\nexports.Item = Item;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useChatLayout = void 0;\nconst react_1 = require(\"react\");\nconst layoutUtils_1 = require(\"../utils/layoutUtils\");\n/**\n * 聊天布局 Hook\n * 提供响应式布局管理和 CSS Grid 布局配置\n */\nconst useChatLayout = () => {\n    const [layoutConfig, setLayoutConfig] = (0, react_1.useState)((0, layoutUtils_1.getLayoutConfig)());\n    const [isInitialized, setIsInitialized] = (0, react_1.useState)(false);\n    // 更新布局配置\n    const updateLayout = (0, react_1.useCallback)((newConfig) => {\n        const updatedConfig = Object.assign(Object.assign({}, layoutConfig), newConfig);\n        setLayoutConfig(updatedConfig);\n        (0, layoutUtils_1.updateLayoutCSSVariables)(updatedConfig);\n    }, [layoutConfig]);\n    // 初始化布局\n    const initializeLayout = (0, react_1.useCallback)(() => {\n        const config = (0, layoutUtils_1.getLayoutConfig)();\n        (0, layoutUtils_1.updateLayoutCSSVariables)(config);\n        setLayoutConfig(config);\n        setIsInitialized(true);\n    }, []);\n    // 处理窗口大小变化\n    const handleResize = (0, react_1.useCallback)(() => {\n        const config = (0, layoutUtils_1.getLayoutConfig)();\n        updateLayout(config);\n    }, [updateLayout]);\n    // 处理移动端特殊布局\n    const handleMobileLayout = (0, react_1.useCallback)(() => {\n        if (!layoutConfig.isMobile)\n            return;\n        // 为移动端添加特殊的 body 类\n        document.body.classList.add('mobile-chat');\n        // 设置移动端特定的 CSS 变量\n        document.documentElement.style.setProperty('--chat-font-size', '16px');\n    }, [layoutConfig.isMobile]);\n    // 处理桌面端布局\n    const handleDesktopLayout = (0, react_1.useCallback)(() => {\n        document.body.classList.remove('mobile-chat');\n        document.documentElement.style.setProperty('--chat-font-size', '14px');\n    }, []);\n    // 初始化监听器\n    (0, react_1.useEffect)(() => {\n        if (isInitialized)\n            return;\n        // 初始化布局\n        initializeLayout();\n        // 创建布局观察器\n        const observer = (0, layoutUtils_1.createLayoutObserver)(handleResize);\n        observer.observe(document.documentElement);\n        // 监听窗口大小变化\n        window.addEventListener('resize', handleResize);\n        // 根据设备类型处理布局\n        if (layoutConfig.isMobile) {\n            handleMobileLayout();\n        }\n        else {\n            handleDesktopLayout();\n        }\n        return () => {\n            observer.disconnect();\n            window.removeEventListener('resize', handleResize);\n        };\n    }, [\n        isInitialized,\n        initializeLayout,\n        handleResize,\n        layoutConfig.isMobile,\n        handleMobileLayout,\n        handleDesktopLayout\n    ]);\n    // 监听设备类型变化\n    (0, react_1.useEffect)(() => {\n        const handleOrientationChange = () => {\n            const currentIsMobile = (0, layoutUtils_1.isMobileDevice)();\n            if (currentIsMobile !== layoutConfig.isMobile) {\n                updateLayout({ isMobile: currentIsMobile });\n            }\n        };\n        window.addEventListener('orientationchange', handleOrientationChange);\n        return () => {\n            window.removeEventListener('orientationchange', handleOrientationChange);\n        };\n    }, [layoutConfig.isMobile, updateLayout]);\n    // 生成 CSS Grid 模板样式\n    const getGridTemplateStyle = (0, react_1.useCallback)(() => {\n        if (layoutConfig.isMobile) {\n            // 检查键盘是否可见\n            const isKeyboardVisible = document.body.classList.contains('keyboard-visible');\n            if (isKeyboardVisible) {\n                return {\n                    gridTemplateRows: `\n            var(--header-height)\n            minmax(0, 1fr)\n            var(--keyboard-height)\n            auto\n          `,\n                };\n            }\n            return {\n                gridTemplateRows: `\n          var(--header-height)\n          minmax(0, 1fr)\n          auto\n        `,\n            };\n        }\n        return {\n            gridTemplateRows: '1fr auto',\n        };\n    }, [layoutConfig.isMobile]);\n    // 生成容器样式\n    const getContainerStyle = (0, react_1.useCallback)(() => {\n        const baseStyle = {\n            display: 'grid',\n            height: '100%',\n            minHeight: 0,\n            overflow: 'hidden',\n        };\n        if (layoutConfig.isMobile) {\n            return Object.assign(Object.assign(Object.assign({}, baseStyle), { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, height: '100dvh', width: '100%' }), getGridTemplateStyle());\n        }\n        return Object.assign(Object.assign({}, baseStyle), getGridTemplateStyle());\n    }, [layoutConfig.isMobile, getGridTemplateStyle]);\n    // 生成消息区域样式\n    const getMessagesContainerStyle = (0, react_1.useCallback)(() => {\n        const baseStyle = {\n            overflowY: 'auto',\n            minHeight: 0,\n            scrollSnapType: 'y proximity',\n        };\n        if (layoutConfig.isMobile) {\n            return Object.assign(Object.assign({}, baseStyle), { paddingTop: 'var(--safe-area-top)', paddingBottom: 'var(--safe-area-bottom)', \n                // 移除固定 margin 计算，使用 Grid 自动分配空间\n                marginTop: 0, marginBottom: 0 });\n        }\n        return Object.assign(Object.assign({}, baseStyle), { padding: '15px' });\n    }, [layoutConfig.isMobile]);\n    // 生成输入区域样式\n    const getInputContainerStyle = (0, react_1.useCallback)(() => {\n        const baseStyle = {\n            flexShrink: 0,\n            backgroundColor: 'var(--background-color)',\n        };\n        if (layoutConfig.isMobile) {\n            return Object.assign(Object.assign({}, baseStyle), { position: 'sticky', bottom: 0, zIndex: 100, paddingBottom: 'var(--safe-area-bottom)', borderTop: '1px solid var(--border-color)' });\n        }\n        return Object.assign(Object.assign({}, baseStyle), { padding: '10px' });\n    }, [layoutConfig.isMobile]);\n    return {\n        layoutConfig,\n        isInitialized,\n        getContainerStyle,\n        getMessagesContainerStyle,\n        getInputContainerStyle,\n        updateLayout,\n    };\n};\nexports.useChatLayout = useChatLayout;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst iztro_hook_1 = require(\"iztro-hook\");\nconst AppContainer_1 = require(\"./containers/AppContainer\");\nconst ResultContainer_1 = require(\"./containers/ResultContainer\");\nconst AIChatContext_1 = require(\"./AIChat/AIChatContext\");\nconst useHistoryManager_1 = require(\"./hooks/useHistoryManager\");\nconst FormPanel_1 = __importDefault(require(\"./components/FormPanel\"));\nconst HistoryModal_1 = __importDefault(require(\"./components/HistoryModal\"));\nrequire(\"./styles/index.css\");\nrequire(\"./styles/history-modal.css\");\nfunction App() {\n    // 控制当前模式（排盘或合盘）\n    const [chartMode, setChartMode] = (0, react_1.useState)(\"single\");\n    // 初始化表单状态\n    const [formData, setFormData] = (0, react_1.useState)({\n        name: \"\",\n        year: \"\",\n        month: \"\",\n        day: \"\",\n        birthTime: 0,\n        birthdayType: \"solar\",\n        gender: \"male\",\n    });\n    // 初始化合盘表单状态\n    const [synastryData, setSynastryData] = (0, react_1.useState)({\n        person1: {\n            name: \"\",\n            year: \"\",\n            month: \"\",\n            day: \"\",\n            birthTime: 0,\n            birthdayType: \"solar\",\n            gender: \"male\",\n        },\n        person2: {\n            name: \"\",\n            year: \"\",\n            month: \"\",\n            day: \"\",\n            birthTime: 0,\n            birthdayType: \"solar\",\n            gender: \"female\",\n        },\n    });\n    // 控制星盘显示的状态\n    const [showAstrolabe, setShowAstrolabe] = (0, react_1.useState)(false);\n    // 控制输入面板显示的状态\n    const [showInputPanel, setShowInputPanel] = (0, react_1.useState)(true);\n    // 使用历史管理Hook\n    const { history, showHistoryModal, setShowHistoryModal, searchTerm, setSearchTerm, showPasswordInput, setShowPasswordInput, password, setPassword, isCloudStorageEnabled, isLoading, editingHistoryId, setEditingHistoryId, handlePasswordSubmit, handleSaveHistory, handleDeleteHistory, handleClearHistory, } = (0, useHistoryManager_1.useHistoryManager)();\n    // 获取星盘数据\n    const { astrolabe } = (0, iztro_hook_1.useIztro)({\n        birthday: `${formData.year}-${String(formData.month).padStart(2, '0')}-${String(formData.day).padStart(2, '0')}`,\n        birthTime: formData.birthTime,\n        gender: formData.gender,\n        birthdayType: formData.birthdayType,\n    });\n    // 获取第一个人星盘数据\n    const { astrolabe: astrolabe1 } = (0, iztro_hook_1.useIztro)({\n        birthday: `${synastryData.person1.year}-${String(synastryData.person1.month).padStart(2, '0')}-${String(synastryData.person1.day).padStart(2, '0')}`,\n        birthTime: synastryData.person1.birthTime,\n        gender: synastryData.person1.gender,\n        birthdayType: synastryData.person1.birthdayType,\n    });\n    // 获取第二个人星盘数据\n    const { astrolabe: astrolabe2 } = (0, iztro_hook_1.useIztro)({\n        birthday: `${synastryData.person2.year}-${String(synastryData.person2.month).padStart(2, '0')}-${String(synastryData.person2.day).padStart(2, '0')}`,\n        birthTime: synastryData.person2.birthTime,\n        gender: synastryData.person2.gender,\n        birthdayType: synastryData.person2.birthdayType,\n    });\n    // 从URL参数中读取数据并设置表单状态\n    (0, react_1.useEffect)(() => {\n        const urlParams = new URLSearchParams(window.location.search);\n        // 从URL参数中读取各个字段\n        const name = urlParams.get('n') || \"\";\n        const year = urlParams.get('y') || \"\";\n        const month = urlParams.get('m') || \"\";\n        const day = urlParams.get('d') || \"\";\n        const birthTime = urlParams.get('t') ? parseInt(urlParams.get('t') || \"1\") : 0;\n        const birthdayType = urlParams.get('type') || \"solar\";\n        const gender = urlParams.get('g') || \"male\";\n        // 检查是否有完整的日期参数（年、月、日都是必需的）\n        const hasCompleteDateParams = !!(urlParams.get('y') && urlParams.get('m') && urlParams.get('d'));\n        setFormData({\n            name,\n            year,\n            month,\n            day,\n            birthTime,\n            birthdayType,\n            gender,\n        });\n        // 只有当日期参数完整时才显示星盘，否则显示输入页面\n        if (hasCompleteDateParams) {\n            setShowAstrolabe(true);\n            setShowInputPanel(false);\n        }\n        else {\n            setShowAstrolabe(false);\n            setShowInputPanel(true);\n        }\n    }, []);\n    // 动态更新主题颜色以适应暗色模式\n    (0, react_1.useEffect)(() => {\n        const updateThemeColor = (isDarkMode) => {\n            const themeColor = isDarkMode ? \"#1B1B1B\" : \"#ffffff\";\n            let metaThemeColor = document.querySelector(\"meta[name=theme-color]\");\n            if (metaThemeColor) {\n                metaThemeColor.setAttribute(\"content\", themeColor);\n            }\n            else {\n                metaThemeColor = document.createElement(\"meta\");\n                metaThemeColor.setAttribute(\"name\", \"theme-color\");\n                metaThemeColor.setAttribute(\"content\", themeColor);\n                document.getElementsByTagName(\"head\")[0].appendChild(metaThemeColor);\n            }\n        };\n        const darkModeMediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n        // 初始化主题颜色\n        updateThemeColor(darkModeMediaQuery.matches);\n        // 监听主题变化\n        const darkModeListener = (e) => {\n            updateThemeColor(e.matches);\n        };\n        darkModeMediaQuery.addEventListener(\"change\", darkModeListener);\n        // 清理监听器\n        return () => {\n            darkModeMediaQuery.removeEventListener(\"change\", darkModeListener);\n        };\n    }, []);\n    // 将表单数据编码到URL参数中\n    const updateUrlParams = (0, react_1.useCallback)((data) => {\n        try {\n            // 构建查询参数\n            const params = new URLSearchParams();\n            // 添加所有参数\n            if (data.name)\n                params.set('n', data.name);\n            params.set('y', data.year);\n            params.set('m', data.month);\n            params.set('d', data.day);\n            params.set('t', data.birthTime.toString());\n            params.set('type', data.birthdayType);\n            params.set('g', data.gender);\n            const newUrl = `${window.location.pathname}?${params.toString()}`;\n            window.history.replaceState({}, '', newUrl);\n        }\n        catch (error) {\n            console.error(\"编码URL参数失败:\", error);\n        }\n    }, []);\n    // 处理历史记录加载\n    const handleLoadHistory = (0, react_1.useCallback)((item) => {\n        if (item.type === 'single') {\n            setFormData({\n                name: item.name,\n                year: item.year,\n                month: item.month,\n                day: item.day,\n                birthTime: item.birthTime,\n                birthdayType: item.birthdayType,\n                gender: item.gender,\n            });\n            setChartMode('single');\n            updateUrlParams({\n                name: item.name,\n                year: item.year,\n                month: item.month,\n                day: item.day,\n                birthTime: item.birthTime,\n                birthdayType: item.birthdayType,\n                gender: item.gender,\n            });\n            setShowAstrolabe(true);\n            setShowInputPanel(false);\n        }\n        else {\n            setSynastryData({\n                person1: {\n                    name: item.name,\n                    year: item.year,\n                    month: item.month,\n                    day: item.day,\n                    birthTime: item.birthTime,\n                    birthdayType: item.birthdayType,\n                    gender: item.gender,\n                },\n                person2: item.person2 || {\n                    name: \"\",\n                    year: \"\",\n                    month: \"\",\n                    day: \"\",\n                    birthTime: 0,\n                    birthdayType: \"solar\",\n                    gender: \"female\",\n                }\n            });\n            setChartMode('synastry');\n            setShowAstrolabe(true);\n            setShowInputPanel(false);\n        }\n    }, [updateUrlParams]);\n    // 处理历史记录编辑\n    const handleEditHistory = (0, react_1.useCallback)((item) => {\n        if (item.type === 'single') {\n            setFormData({\n                name: item.name,\n                year: item.year,\n                month: item.month,\n                day: item.day,\n                birthTime: item.birthTime,\n                birthdayType: item.birthdayType,\n                gender: item.gender,\n            });\n            setChartMode('single');\n        }\n        else {\n            setSynastryData({\n                person1: {\n                    name: item.name,\n                    year: item.year,\n                    month: item.month,\n                    day: item.day,\n                    birthTime: item.birthTime,\n                    birthdayType: item.birthdayType,\n                    gender: item.gender,\n                },\n                person2: item.person2 || {\n                    name: \"\",\n                    year: \"\",\n                    month: \"\",\n                    day: \"\",\n                    birthTime: 0,\n                    birthdayType: \"solar\",\n                    gender: \"female\",\n                }\n            });\n            setChartMode('synastry');\n        }\n    }, []);\n    // 处理显示输入面板\n    const handleShowInputPanel = (0, react_1.useCallback)(() => {\n        setShowInputPanel(true);\n        setShowAstrolabe(false);\n        window.history.replaceState({}, '', window.location.pathname);\n        setEditingHistoryId(null);\n    }, []);\n    return (react_1.default.createElement(AppContainer_1.AppContainer, null,\n        react_1.default.createElement(AIChatContext_1.AIChatProvider, null,\n            react_1.default.createElement(\"div\", { className: \"content\" },\n                showInputPanel && (react_1.default.createElement(FormPanel_1.default, { chartMode: chartMode, setChartMode: setChartMode, formData: formData, synastryData: synastryData, onFormChange: setFormData, onSynastryChange: (person, data) => setSynastryData(Object.assign(Object.assign({}, synastryData), { [person]: data })), onRadioChange: (name, value) => setFormData(Object.assign(Object.assign({}, formData), { [name]: value })), onSynastryRadioChange: (person, name, value) => setSynastryData(Object.assign(Object.assign({}, synastryData), { [person]: Object.assign(Object.assign({}, synastryData[person]), { [name]: value }) })), onShowHistory: () => setShowHistoryModal(true), onSubmit: (e) => e.preventDefault(), onSynastrySubmit: (e) => e.preventDefault(), onSaveHistory: handleSaveHistory, updateUrlParams: updateUrlParams, setShowAstrolabe: setShowAstrolabe, setShowInputPanel: setShowInputPanel })),\n                react_1.default.createElement(HistoryModal_1.default, { history: history, showHistoryModal: showHistoryModal, setShowHistoryModal: setShowHistoryModal, searchTerm: searchTerm, setSearchTerm: setSearchTerm, showPasswordInput: showPasswordInput, setShowPasswordInput: setShowPasswordInput, password: password, setPassword: setPassword, isCloudStorageEnabled: isCloudStorageEnabled, isLoading: isLoading, editingHistoryId: editingHistoryId, setEditingHistoryId: setEditingHistoryId, handlePasswordSubmit: handlePasswordSubmit, handleDeleteHistory: handleDeleteHistory, handleClearHistory: handleClearHistory, onLoadHistory: handleLoadHistory, onEditHistory: handleEditHistory, chartMode: chartMode }),\n                showAstrolabe && (react_1.default.createElement(ResultContainer_1.ResultContainer, { chartMode: chartMode, formData: formData, synastryData: synastryData, astrolabe: astrolabe, astrolabe1: astrolabe1, astrolabe2: astrolabe2, onShowInputPanel: handleShowInputPanel }))))));\n}\nexports.default = react_1.default.memo(App);\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IzpalaceCenter = void 0;\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst react_1 = __importStar(require(\"react\"));\nconst Item_1 = require(\"./Item\");\nrequire(\"../styles/index.css\");\nconst Line_1 = require(\"./Line\");\nconst utils_1 = require(\"iztro/lib/utils\");\nconst lunar_lite_1 = require(\"lunar-lite\");\nconst i18n_1 = require(\"iztro/lib/i18n\");\nconst data_1 = require(\"iztro/lib/data\");\nconst IzpalaceCenter = ({ astrolabe, horoscope, arrowIndex, arrowScope, horoscopeDate = new Date(), horoscopeHour = 0, setHoroscopeDate, setHoroscopeHour, centerPalaceAlign, }) => {\n    var _a, _b;\n    const records = (0, react_1.useMemo)(() => [\n        {\n            title: \"五行局：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.fiveElementsClass,\n        },\n        {\n            title: \"年龄(虚岁)：\",\n            content: `${horoscope === null || horoscope === void 0 ? void 0 : horoscope.age.nominalAge} 岁`,\n        },\n        {\n            title: \"四柱：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.chineseDate,\n        },\n        {\n            title: \"阳历：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.solarDate,\n        },\n        {\n            title: \"农历：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.lunarDate,\n        },\n        {\n            title: \"时辰：\",\n            content: `${astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.time}(${astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.timeRange})`,\n        },\n        {\n            title: \"生肖：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.zodiac,\n        },\n        {\n            title: \"星座：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.sign,\n        },\n        {\n            title: \"命主：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.soul,\n        },\n        {\n            title: \"身主：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.body,\n        },\n        {\n            title: \"命宫：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.earthlyBranchOfSoulPalace,\n        },\n        {\n            title: \"身宫：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.earthlyBranchOfBodyPalace,\n        },\n    ], [astrolabe, horoscope]);\n    const horoDate = (0, react_1.useMemo)(() => {\n        const dateStr = horoscopeDate !== null && horoscopeDate !== void 0 ? horoscopeDate : new Date();\n        const [year, month, date] = (0, lunar_lite_1.normalizeDateStr)(dateStr);\n        const dt = new Date(year, month - 1, date);\n        return {\n            solar: `${year}-${month}-${date}`,\n            lunar: (0, lunar_lite_1.solar2lunar)(dateStr).toString(true),\n            prevDecadalDisabled: dt.setFullYear(dt.getFullYear() - 1),\n        };\n    }, [horoscopeDate]);\n    const onHoroscopeButtonClicked = (scope, value) => {\n        if (!(astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.solarDate)) {\n            return true;\n        }\n        const [year, month, date] = (0, lunar_lite_1.normalizeDateStr)(horoscopeDate);\n        const dt = new Date(year, month - 1, date);\n        const [birthYear, birthMonth, birthDate] = (0, lunar_lite_1.normalizeDateStr)(astrolabe.solarDate);\n        const birthday = new Date(birthYear, birthMonth - 1, birthDate);\n        let hour = horoscopeHour;\n        switch (scope) {\n            case \"hourly\":\n                hour = horoscopeHour + value;\n                if (horoscopeHour + value > 11) {\n                    // 如果大于亥时，则加一天，时辰变为早子时\n                    dt.setDate(dt.getDate() + 1);\n                    hour = 0;\n                }\n                else if (horoscopeHour + value < 0) {\n                    // 如果小于早子时，则减一天，时辰变为亥时\n                    dt.setDate(dt.getDate() - 1);\n                    hour = 11;\n                }\n                break;\n            case \"daily\":\n                dt.setDate(dt.getDate() + value);\n                break;\n            case \"monthly\":\n                dt.setMonth(dt.getMonth() + value);\n                break;\n            case \"yearly\":\n            case \"decadal\":\n                dt.setFullYear(dt.getFullYear() + value);\n                break;\n        }\n        if (dt.getTime() >= birthday.getTime()) {\n            setHoroscopeDate === null || setHoroscopeDate === void 0 ? void 0 : setHoroscopeDate(dt);\n            setHoroscopeHour === null || setHoroscopeHour === void 0 ? void 0 : setHoroscopeHour(hour);\n        }\n    };\n    const shouldBeDisabled = (0, react_1.useCallback)((dateStr, scope, value) => {\n        if (!(astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.solarDate)) {\n            return true;\n        }\n        const [year, month, date] = (0, lunar_lite_1.normalizeDateStr)(dateStr);\n        const dt = new Date(year, month - 1, date);\n        const [birthYear, birthMonth, birthDate] = (0, lunar_lite_1.normalizeDateStr)(astrolabe.solarDate);\n        const birthday = new Date(birthYear, birthMonth - 1, birthDate);\n        switch (scope) {\n            case \"hourly\":\n                if (horoscopeHour + value > 11) {\n                    dt.setDate(dt.getDate() + 1);\n                }\n                else if (horoscopeHour + value < 0) {\n                    dt.setDate(dt.getDate() - 1);\n                }\n                break;\n            case \"daily\":\n                dt.setDate(dt.getDate() + value);\n                break;\n            case \"monthly\":\n                dt.setMonth(dt.getMonth() + value);\n                break;\n            case \"yearly\":\n            case \"decadal\":\n                dt.setFullYear(dt.getFullYear() + value);\n                break;\n        }\n        if (dt.getTime() < birthday.getTime()) {\n            return true;\n        }\n        return false;\n    }, [horoscopeHour, astrolabe]);\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-center-palace\", {\n            \"iztro-center-palace-centralize\": centerPalaceAlign,\n        }) },\n        (astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.earthlyBranchOfSoulPalace) && (react_1.default.createElement(Line_1.Line, { scope: arrowScope, index: arrowIndex !== null && arrowIndex !== void 0 ? arrowIndex : (0, utils_1.fixEarthlyBranchIndex)(astrolabe.earthlyBranchOfSoulPalace) })),\n        react_1.default.createElement(\"h3\", { className: \"center-title\" },\n            react_1.default.createElement(\"span\", { className: `gender gender-${(0, i18n_1.kot)((_a = astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.gender) !== null && _a !== void 0 ? _a : \"\")}` }, (0, i18n_1.kot)((_b = astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.gender) !== null && _b !== void 0 ? _b : \"\") === \"male\" ? \"♂\" : \"♀\"),\n            react_1.default.createElement(\"span\", null, \"\\u57FA\\u672C\\u4FE1\\u606F\")),\n        react_1.default.createElement(\"ul\", { className: \"basic-info\" }, records.map((rec, idx) => (react_1.default.createElement(Item_1.Item, Object.assign({ key: idx }, rec))))),\n        react_1.default.createElement(\"h3\", { className: \"center-title\" }, \"\\u8FD0\\u9650\\u4FE1\\u606F\"),\n        react_1.default.createElement(\"ul\", { className: \"basic-info\" },\n            react_1.default.createElement(Item_1.Item, { title: \"\\u519C\\u5386\\uFF1A\", content: horoDate.lunar }),\n            react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"solar-horoscope\", {\n                    \"solar-horoscope-centralize\": centerPalaceAlign,\n                }) },\n                react_1.default.createElement(Item_1.Item, { title: \"\\u9633\\u5386\\uFF1A\", content: horoDate.solar }),\n                react_1.default.createElement(\"span\", { className: \"today\", onClick: () => setHoroscopeDate === null || setHoroscopeDate === void 0 ? void 0 : setHoroscopeDate(new Date()) }, \"\\u4ECA\"))),\n        react_1.default.createElement(\"div\", { className: \"horo-buttons\" },\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"yearly\", -10),\n                }), onClick: () => onHoroscopeButtonClicked(\"yearly\", -10) }, \"\\u25C0\\u9650\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"yearly\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"yearly\", -1) }, \"\\u25C0\\u5E74\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"monthly\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"monthly\", -1) }, \"\\u25C0\\u6708\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"daily\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"daily\", -1) }, \"\\u25C0\\u65E5\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"hourly\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"hourly\", -1) }, \"\\u25C0\\u65F6\"),\n            react_1.default.createElement(\"span\", { className: \"center-horo-hour\" }, (0, i18n_1.t)(data_1.CHINESE_TIME[horoscopeHour])),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"hourly\", 1) }, \"\\u65F6\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"daily\", 1) }, \"\\u65E5\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"monthly\", 1) }, \"\\u6708\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"yearly\", 1) }, \"\\u5E74\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"yearly\", 10) }, \"\\u9650\\u25B6\"))));\n};\nexports.IzpalaceCenter = IzpalaceCenter;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst ScrollToBottomButton = ({ isVisible, onClick }) => {\n    if (!isVisible)\n        return null;\n    return (react_1.default.createElement(\"button\", { className: `scroll-to-bottom-button ${isVisible ? 'visible' : ''}`, onClick: onClick, \"aria-label\": \"\\u6EDA\\u52A8\\u5230\\u5E95\\u90E8\" },\n        react_1.default.createElement(\"svg\", { width: \"20\", height: \"20\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n            react_1.default.createElement(\"polyline\", { points: \"6 9 12 15 18 9\" }))));\n};\nexports.default = react_1.default.memo(ScrollToBottomButton);\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst AIChatContext_1 = require(\"./AIChatContext\");\nconst BackgroundAIIndicator = () => {\n    const { isGeneratingInBackground } = (0, AIChatContext_1.useAIChat)();\n    if (!isGeneratingInBackground) {\n        return null;\n    }\n    return (react_1.default.createElement(\"div\", { className: \"background-ai-indicator\" },\n        react_1.default.createElement(\"div\", { className: \"indicator-content\" },\n            react_1.default.createElement(\"div\", { className: \"typing-indicator\" },\n                react_1.default.createElement(\"span\", null),\n                react_1.default.createElement(\"span\", null),\n                react_1.default.createElement(\"span\", null)),\n            react_1.default.createElement(\"span\", { className: \"indicator-text\" }, \"AI\\u6B63\\u5728\\u540E\\u53F0\\u751F\\u6210...\"))));\n};\nexports.default = BackgroundAIIndicator;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AppContainer = void 0;\nconst react_1 = __importDefault(require(\"react\"));\nconst useKeyboardDetector_1 = require(\"../utils/useKeyboardDetector\");\n/**\n * 应用容器组件\n * 负责处理全局布局、键盘检测和安全区域适配\n */\nconst AppContainer = ({ children }) => {\n    const { isKeyboardVisible } = (0, useKeyboardDetector_1.useKeyboardDetector)();\n    const safeArea = (0, useKeyboardDetector_1.useSafeArea)();\n    return (react_1.default.createElement(\"div\", { className: `App ${isKeyboardVisible ? 'keyboard-visible' : ''}` }, children));\n};\nexports.AppContainer = AppContainer;\nexports.default = exports.AppContainer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useMessageStorage = void 0;\nconst react_1 = require(\"react\");\n/**\n * 消息存储和分页Hook\n * 实现消息的本地存储和分页加载，优化内存使用\n */\nconst useMessageStorage = ({ maxMessagesInMemory = 100, pageSize = 20, storageKey = 'ai-chat-messages' } = {}) => {\n    const [allMessages, setAllMessages] = (0, react_1.useState)([]);\n    const [visibleMessages, setVisibleMessages] = (0, react_1.useState)([]);\n    const [currentPage, setCurrentPage] = (0, react_1.useState)(1);\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [hasMore, setHasMore] = (0, react_1.useState)(true);\n    // 从本地存储加载消息\n    const loadMessagesFromStorage = (0, react_1.useCallback)(() => {\n        try {\n            const storedMessages = localStorage.getItem(storageKey);\n            if (storedMessages) {\n                const parsedMessages = JSON.parse(storedMessages);\n                // 验证消息格式\n                if (Array.isArray(parsedMessages) && parsedMessages.every(msg => msg && typeof msg === 'object' &&\n                    (msg.role === 'user' || msg.role === 'assistant') &&\n                    typeof msg.content === 'string')) {\n                    return parsedMessages;\n                }\n            }\n        }\n        catch (error) {\n            console.error('从本地存储加载消息失败:', error);\n        }\n        return [];\n    }, [storageKey]);\n    // 保存消息到本地存储\n    const saveMessagesToStorage = (0, react_1.useCallback)((messages) => {\n        try {\n            localStorage.setItem(storageKey, JSON.stringify(messages));\n        }\n        catch (error) {\n            console.error('保存消息到本地存储失败:', error);\n            // 如果存储失败，可能是存储空间不足，尝试清理旧消息\n            try {\n                // 保留最近的消息\n                const recentMessages = messages.slice(-maxMessagesInMemory);\n                localStorage.setItem(storageKey, JSON.stringify(recentMessages));\n            }\n            catch (cleanupError) {\n                console.error('清理旧消息失败:', cleanupError);\n            }\n        }\n    }, [storageKey, maxMessagesInMemory]);\n    // 初始化时从本地存储加载消息\n    (0, react_1.useEffect)(() => {\n        const messages = loadMessagesFromStorage();\n        setAllMessages(messages);\n        // 计算初始可见消息\n        const initialVisible = messages.slice(-pageSize);\n        setVisibleMessages(initialVisible);\n        setCurrentPage(1);\n        setHasMore(messages.length > pageSize);\n    }, [loadMessagesFromStorage, pageSize]);\n    // 添加新消息\n    const addMessages = (0, react_1.useCallback)((newMessages) => {\n        setAllMessages(prev => {\n            const updated = [...prev, ...newMessages];\n            // 限制内存中的消息数量\n            if (updated.length > maxMessagesInMemory) {\n                // 保留最新的消息\n                const trimmed = updated.slice(-maxMessagesInMemory);\n                saveMessagesToStorage(trimmed);\n                return trimmed;\n            }\n            saveMessagesToStorage(updated);\n            return updated;\n        });\n        // 如果当前在最后一页，更新可见消息\n        setVisibleMessages(prev => [...prev, ...newMessages]);\n    }, [maxMessagesInMemory, saveMessagesToStorage]);\n    // 加载更多消息（分页）\n    const loadMoreMessages = (0, react_1.useCallback)(() => {\n        if (isLoading || !hasMore)\n            return;\n        setIsLoading(true);\n        // 使用setTimeout避免阻塞UI\n        setTimeout(() => {\n            const nextPage = currentPage + 1;\n            const startIndex = Math.max(0, allMessages.length - nextPage * pageSize);\n            const endIndex = allMessages.length - (nextPage - 1) * pageSize;\n            if (startIndex <= 0) {\n                // 已经到达第一页\n                const newVisibleMessages = allMessages.slice(0, endIndex);\n                setVisibleMessages(newVisibleMessages);\n                setHasMore(false);\n            }\n            else {\n                // 加载上一页的消息\n                const newMessages = allMessages.slice(startIndex, endIndex);\n                setVisibleMessages(prev => [...newMessages, ...prev]);\n                setCurrentPage(nextPage);\n            }\n            setIsLoading(false);\n        }, 0);\n    }, [allMessages, currentPage, hasMore, isLoading, pageSize]);\n    // 清空所有消息\n    const clearMessages = (0, react_1.useCallback)(() => {\n        setAllMessages([]);\n        setVisibleMessages([]);\n        setCurrentPage(1);\n        setHasMore(false);\n        try {\n            localStorage.removeItem(storageKey);\n        }\n        catch (error) {\n            console.error('清空本地存储失败:', error);\n        }\n    }, [storageKey]);\n    // 重置到最新消息\n    const resetToLatest = (0, react_1.useCallback)(() => {\n        const latestMessages = allMessages.slice(-pageSize);\n        setVisibleMessages(latestMessages);\n        setCurrentPage(1);\n        setHasMore(allMessages.length > pageSize);\n    }, [allMessages, pageSize]);\n    return {\n        allMessages,\n        visibleMessages,\n        currentPage,\n        isLoading,\n        hasMore,\n        addMessages,\n        loadMoreMessages,\n        clearMessages,\n        resetToLatest\n    };\n};\nexports.useMessageStorage = useMessageStorage;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useSafeArea = exports.useKeyboardDetector = void 0;\nconst react_1 = require(\"react\");\n/**\n * 键盘检测Hook\n * 用于检测虚拟键盘的显示状态和高度\n */\nconst useKeyboardDetector = () => {\n    const [isKeyboardVisible, setIsKeyboardVisible] = (0, react_1.useState)(false);\n    const [keyboardHeight, setKeyboardHeight] = (0, react_1.useState)(0);\n    (0, react_1.useEffect)(() => {\n        // 检测是否为移动设备\n        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        if (!isMobile) {\n            return; // 非移动设备不进行键盘检测\n        }\n        const handleResize = () => {\n            var _a, _b;\n            const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n            const windowHeight = window.innerHeight;\n            const screenHeight = ((_b = window.screen) === null || _b === void 0 ? void 0 : _b.height) || windowHeight;\n            // 计算键盘高度\n            const calculatedKeyboardHeight = windowHeight - viewportHeight;\n            // 判断键盘是否可见（高度变化超过100px认为是键盘弹出）\n            const isKeyboardNowVisible = calculatedKeyboardHeight > 100;\n            setIsKeyboardVisible(isKeyboardNowVisible);\n            setKeyboardHeight(isKeyboardNowVisible ? calculatedKeyboardHeight : 0);\n            // 更新CSS变量\n            document.documentElement.style.setProperty('--keyboard-height', `${isKeyboardNowVisible ? calculatedKeyboardHeight : 0}px`);\n            document.documentElement.style.setProperty('--is-keyboard-visible', isKeyboardNowVisible ? 'true' : 'false');\n            // 更新body的class\n            if (isKeyboardNowVisible) {\n                document.body.classList.add('keyboard-visible');\n            }\n            else {\n                document.body.classList.remove('keyboard-visible');\n            }\n        };\n        // 初始检测\n        handleResize();\n        // 使用visualViewport事件监听（如果支持）\n        if (window.visualViewport) {\n            window.visualViewport.addEventListener('resize', handleResize);\n            window.visualViewport.addEventListener('scroll', handleResize);\n        }\n        else {\n            // 回退到window的resize事件\n            window.addEventListener('resize', handleResize);\n        }\n        // 监听输入框的focus和blur事件\n        const handleFocusIn = (e) => {\n            const target = e.target;\n            if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n                // 延迟检测，确保键盘已经弹出\n                setTimeout(handleResize, 100);\n            }\n        };\n        const handleFocusOut = (e) => {\n            const target = e.target;\n            if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n                // 延迟检测，确保键盘已经收起\n                setTimeout(handleResize, 300);\n            }\n        };\n        document.addEventListener('focusin', handleFocusIn);\n        document.addEventListener('focusout', handleFocusOut);\n        // 清理函数\n        return () => {\n            if (window.visualViewport) {\n                window.visualViewport.removeEventListener('resize', handleResize);\n                window.visualViewport.removeEventListener('scroll', handleResize);\n            }\n            else {\n                window.removeEventListener('resize', handleResize);\n            }\n            document.removeEventListener('focusin', handleFocusIn);\n            document.removeEventListener('focusout', handleFocusOut);\n        };\n    }, []);\n    return { isKeyboardVisible, keyboardHeight };\n};\nexports.useKeyboardDetector = useKeyboardDetector;\n/**\n * 安全区域检测Hook\n * 用于获取设备的安全区域信息\n */\nconst useSafeArea = () => {\n    const [safeArea, setSafeArea] = (0, react_1.useState)({\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n    });\n    (0, react_1.useEffect)(() => {\n        const updateSafeArea = () => {\n            // 创建一个临时元素来获取CSS变量值\n            const tempElement = document.createElement('div');\n            tempElement.style.position = 'absolute';\n            tempElement.style.top = '-9999px';\n            tempElement.style.left = '-9999px';\n            document.body.appendChild(tempElement);\n            // 获取计算后的样式\n            const computedStyle = window.getComputedStyle(tempElement);\n            const newSafeArea = {\n                top: parseInt(computedStyle.getPropertyValue('--safe-area-inset-top')) || 0,\n                right: parseInt(computedStyle.getPropertyValue('--safe-area-inset-right')) || 0,\n                bottom: parseInt(computedStyle.getPropertyValue('--safe-area-inset-bottom')) || 0,\n                left: parseInt(computedStyle.getPropertyValue('--safe-area-inset-left')) || 0,\n            };\n            // 移除临时元素\n            document.body.removeChild(tempElement);\n            setSafeArea(newSafeArea);\n        };\n        // 初始更新\n        updateSafeArea();\n        // 监听窗口大小变化（安全区域可能在旋转屏幕时改变）\n        window.addEventListener('resize', updateSafeArea);\n        window.addEventListener('orientationchange', updateSafeArea);\n        return () => {\n            window.removeEventListener('resize', updateSafeArea);\n            window.removeEventListener('orientationchange', updateSafeArea);\n        };\n    }, []);\n    return safeArea;\n};\nexports.useSafeArea = useSafeArea;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst FormContainer_1 = require(\"../containers/FormContainer\");\nconst FormPanel = ({ chartMode, setChartMode, formData, synastryData, onFormChange, onSynastryChange, onRadioChange, onSynastryRadioChange, onShowHistory, onSubmit, onSynastrySubmit, onSaveHistory, updateUrlParams, setShowAstrolabe, setShowInputPanel, }) => {\n    const handleSubmit = (0, react_1.useCallback)((e) => {\n        e.preventDefault();\n        if (!formData.year || !formData.month || !formData.day) {\n            alert(\"请填写完整的日期信息（年、月、日）\");\n            return;\n        }\n        // 如果有姓名，保存到历史记录\n        if (formData.name.trim()) {\n            onSaveHistory(Object.assign(Object.assign({}, formData), { type: 'single' }));\n        }\n        updateUrlParams(formData);\n        setShowAstrolabe(true);\n        setShowInputPanel(false);\n    }, [formData, onSaveHistory, updateUrlParams, setShowAstrolabe, setShowInputPanel]);\n    const handleSynastrySubmit = (0, react_1.useCallback)((e) => {\n        e.preventDefault();\n        if (!synastryData.person1.year || !synastryData.person1.month || !synastryData.person1.day) {\n            alert(\"请填写第一个人的完整日期信息（年、月、日）\");\n            return;\n        }\n        if (!synastryData.person2.year || !synastryData.person2.month || !synastryData.person2.day) {\n            alert(\"请填写第二个人的完整日期信息（年、月、日）\");\n            return;\n        }\n        // 如果有任意一个人的姓名，保存到历史记录\n        if (synastryData.person1.name.trim() || synastryData.person2.name.trim()) {\n            onSaveHistory(Object.assign(Object.assign({}, synastryData.person1), { type: 'synastry', person2: synastryData.person2 }));\n        }\n        setShowAstrolabe(true);\n        setShowInputPanel(false);\n    }, [synastryData, onSaveHistory, setShowAstrolabe, setShowInputPanel]);\n    return (react_1.default.createElement(FormContainer_1.FormContainer, { chartMode: chartMode, setChartMode: setChartMode, formData: formData, synastryData: synastryData, onFormChange: onFormChange, onSynastryChange: onSynastryChange, onRadioChange: onRadioChange, onSynastryRadioChange: onSynastryRadioChange, onShowHistory: onShowHistory, onSubmit: handleSubmit, onSynastrySubmit: handleSynastrySubmit }));\n};\nexports.default = react_1.default.memo(FormPanel);\n"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","useHistoryManager","react_1","historyUtils_1","history","setHistory","useState","showHistoryModal","setShowHistoryModal","searchTerm","setSearchTerm","showPasswordInput","setShowPasswordInput","password","setPassword","isCloudStorageEnabled","setIsCloudStorageEnabled","isLoading","setIsLoading","editingHistoryId","setEditingHistoryId","useEffect","HistoryManager","initialize","getHistoryWithCloudSync","handlePasswordSubmit","useCallback","trim","enableCloudStorage","alert","error","handleSaveHistory","item","updateHistory","saveHistory","getHistory","handleDeleteHistory","id","deleteHistory","handleClearHistory","confirm","clearHistory","filter","_a","name","toLowerCase","includes","type","person2","year","month","day","ownKeys","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","__setModuleDefault","v","__importStar","getOwnPropertyNames","ar","prototype","hasOwnProperty","call","length","mod","i","useAIChat","AIChatProvider","AIChatContext","createContext","children","messages","setMessages","isGeneratingInBackground","setIsGeneratingInBackground","default","createElement","Provider","addMessage","message","prev","updateLastMessage","content","newMessages","lastMessage","role","assign","clearMessages","context","useContext","Error","__exportStar","p","__rest","s","t","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","Izstar","classnames_1","data_1","i18n_1","utils_1","horoscopeMutagens","activeHeavenlyStem","hoverHeavenlyStem","palaceHeavenlyStem","star","mutagenStyle","useMemo","index","getMutagensByHeavenlyStem","hoverMutagenStyle","selfMutagenStyle","className","brightness","mutagen","MUTAGEN","kot","map","show","key","scope","count","animate","renderMessageSkeleton","renderChatSkeleton","Array","from","_","renderInputSkeleton","skeletons","push","renderSkeletons","useVirtualScroll","items","containerRef","options","itemHeight","overscan","defaultHeight","scrollTop","setScrollTop","containerHeight","setContainerHeight","measuredItems","setMeasuredItems","Map","isScrolling","setIsScrolling","scrollTimeoutRef","useRef","totalHeight","height","measured","visibleRange","startOffset","startIndex","endIndex","Math","max","currentOffset","min","measureItem","newMap","existing","set","offset","itemId","handleScroll","current","clearTimeout","setTimeout","updateContainerHeight","clientHeight","window","addEventListener","removeEventListener","container","passive","visibleItems","scrollToIndex","scrollTo","top","behavior","scrollToBottom","MessageItem_1","TypingIndicator_1","SkeletonLoader_1","useMessageStorage_1","useVirtualScroll_1","MessageList","memo","generationFailed","lastFailedMessage","onRegenerate","messagesContainerRef","lastMessageRef","isStreaming","useMessageStorage","messageStorage","maxMessagesInMemory","pageSize","visibleMessages","storedVisibleMessages","isStorageLoading","hasMore","addMessages","loadMoreMessages","resetToLatest","displayMessages","virtualScroll","msg","some","storedMsg","topObserverRef","observer","IntersectionObserver","entries","isIntersecting","root","threshold","rootMargin","observe","unobserve","messageItems","originalIndex","isLastMessage","slice","style","position","left","right","ref","el","measuredHeight","getBoundingClientRect","showRegenerate","messageRef","showActions","Fragment","ChatContainer","lazy","SkeletonLoader","ChatLoadingFallback","ChatSkeletonFallback","Suspense","fallback","astrolabe","synastryAstrolabe","isSynastryMode","personNames","person1","isVisible","shouldLoadChat","setShouldLoadChat","requestAnimationFrame","cloudStorage_1","CloudStorageService","isCloudEnabled","isAuth","authenticate","disableCloudStorage","clearAuthentication","loadHistoryFromCloud","ids","getHistoryIds","cloudHistory","batchDownloadHistoryItems","forEach","localHistory","mergedHistory","mergeHistories","splice","localStorage","setItem","STORAGE_KEY","JSON","stringify","saveHistoryToCloud","uploadHistoryItem","mergedMap","existingItem","timestamp","values","sort","a","b","newHistoryItem","generateId","Date","now","unshift","historyJson","getItem","parse","updatedItem","itemIndex","findIndex","deleteHistoryItem","filteredHistory","removeItem","clearAllHistory","toString","random","substr","formatDate","date","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","react_markdown_1","remark_gfm_1","remark_breaks_1","LazyImage","src","alt","props","isLoaded","setIsLoaded","isInView","setIsInView","imgRef","entry","disconnect","onLoad","processedContent","replace","components","h1","h2","h3","h4","h5","h6","ul","ol","li","isTask","Children","toArray","child","isValidElement","href","target","rel","code","inline","rest","match","exec","language","pre","blockquote","table","thead","tbody","tr","th","td","strong","em","hr","img","del","input","checked","readOnly","markdownContent","remarkPlugins","rehypePlugins","getLastUserMessage","filterValidMessages","isValidMessage","createErrorMessage","processRemainingBuffer","processStreamChunk","buildAIMessages","buildSystemPrompt","formatAstrolabeForSynastry","astrolabeFormatter_1","currentTime","toLocaleString","hour","minute","second","hour12","gender","solarDate","chineseDate","time","earthlyBranchOfSoulPalace","earthlyBranchOfBodyPalace","soul","body","fiveElementsClass","keyPalaces","palaces","palace","_b","majorStars","minorStars","heavenlyStem","earthlyBranch","join","horoscope","decadal","yearly","synastryData","person1Data","formatAstrolabeForAI","systemPrompt","existingMessages","userMessage","chunk","buffer","onMessageUpdate","assistantMessage","newBuffer","lines","split","pop","line","startsWith","data","endsWith","parsed","choices","delta","newContent","validMessages","quickActions","onQuickActionClick","action","onClick","prompt","disabled","useVirtualKeyboard","layoutUtils_1","keyboardState","setKeyboardState","isMobile","isMobileDevice","isAndroid","isAndroidDevice","navigationBarHeight","getAndroidNavigationBarHeight","observerRef","updateKeyboardState","config","keyboardHeight","document","documentElement","setProperty","navHeight","handleViewportResize","throttle","safeAreaTop","parseInt","getComputedStyle","getPropertyValue","safeAreaBottom","viewportHeight","visualViewport","innerHeight","screenHeight","screen","windowHeight","navBarHeight","getKeyboardHeight","headerHeight","handleInputFocus","handleInputBlur","setupInputListeners","inputElement","ResizeObserver","debounce","classList","add","remove","hideKeyboard","AIChatContext_1","useMessageScroll_1","useVirtualKeyboard_1","useAIChatService_1","useChatLayout_1","MessageList_1","ChatInput_1","QuickActions_1","QuestionPanel_1","ScrollToBottomButton_1","inputValue","setInputValue","showQuestionPanel","setShowQuestionPanel","isGenerating","setIsGenerating","setIsStreaming","setGenerationFailed","setLastFailedMessage","activeQuestionTab","setActiveQuestionTab","inputRef","quickActionsData","setQuickActionsData","synastryQuickActionsData","setSynastryQuickActionsData","questionCategoriesData","setQuestionCategoriesData","dataLoaded","setDataLoaded","userScrolledUp","setUserScrolledUp","resetScrollState","useMessageScroll","getContainerStyle","getMessagesContainerStyle","getInputContainerStyle","useChatLayout","sendMessage","regenerateResponse","stopGeneration","useAIChatService","onMessagesChange","onLoadingChange","onGeneratingChange","onStreamingChange","onError","synastryQuickActions","questionCategories","handleSendMessage","updatedMessages","handleQuickActionClick","handlePresetQuestionClick","question","handleSubmit","preventDefault","toggleQuestionPanel","handleRegenerate","stopPropagation","onInputChange","onSubmit","onToggleQuestionPanel","onStopGeneration","onTabChange","onQuestionClick","client_1","App_1","createRoot","getElementById","render","StrictMode","navigator","serviceWorker","register","registration","catch","isUserActivelyScrolling","setIsUserActivelyScrolling","userScrollTimeoutRef","isAtBottom","scrollHeight","force","atBottom","AIChat","AIChat_1","messageUtils_1","useNetworkRequest_1","abortControllerRef","sendChatRequest","isNetworkLoading","networkError","useAIChatRequest","processStreamResponse","response","reader","getReader","decoder","TextDecoder","assistantMessageContent","read","decode","stream","shouldUpdate","callAIService","fetch","method","headers","model","temperature","signal","ok","status","handleError","currentMessages","errorMessage","AbortController","aiMessages","finalMessages","failedMessage","messagesWithoutLastAssistant","abort","Iztrolabe","Izpalace_1","IzpalaceCenter_1","iztro_hook_1","astro_1","taichiPoint","setTaichiPoint","taichiPalaces","setTaichiPalaces","setActiveHeavenlyStem","setHoverHeavenlyStem","focusedIndex","setFocusedIndex","showDecadal","setShowDecadal","showYearly","setShowYearly","showMonthly","setShowMonthly","showDaily","setShowDaily","showHourly","setShowShowHourly","horoscopeDate","setHoroscopeDate","horoscopeHour","setHoroscopeHour","setHoroscope","useIztro","birthday","birthTime","birthdayType","fixLeap","isLeapMonth","lang","astroType","toggleShowScope","toggleActiveHeavenlyStem","dynamic","arrowIndex","hourly","arrowScope","daily","monthly","getPalaceNames","toggleTaichiPoint","Izpalace","onFocused","showDecadalScope","showYearlyScope","showMonthlyScope","showDailyScope","showHourlyScope","taichiPalace","toggleScope","IzpalaceCenter","centerPalaceAlign","subCategories","questions","createLayoutObserver","updateLayoutCSSVariables","isKeyboardVisible","calculateAvailableHeight","getSafeAreaInset","getLayoutConfig","test","userAgent","heightDiff","screenWidth","width","windowWidth","innerWidth","widthDiff","abs","CSS","supports","onLayoutChange","func","delay","timeoutId","args","lastCall","ResultContainer","Iztrolabe_1","SegmentedControl_1","module","BackgroundAIIndicator","chartMode","formData","astrolabe1","astrolabe2","onShowInputPanel","activeTab","setActiveTab","SegmentedControl","label","onChange","ChatInput","isPWA","setIsPWA","isIOS","setIsIOS","setIsAndroid","androidNavBarHeight","setAndroidNavBarHeight","iosNotchHeight","setIosNotchHeight","deviceInfo","isIOSDevice","isStandalone","matchMedia","matches","standalone","referrer","heights","getIosNotchHeight","getAndroidNavBarHeight","handleInputChange","handleButtonClick","Event","mediaQuery","handlePWAChange","MutationObserver","attributes","attributeFilter","placeholder","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","x1","y1","x2","y2","points","CLOUD_ENABLED_KEY","CLOUD_PASSWORD","WORKER_URL","statusText","json","success","downloadHistoryItem","isOnline","mode","cache","Izstar_1","_c","_d","_e","horoscopeNames","age","fixIndex","onMouseEnter","onMouseLeave","adjectiveStars","stars","changsheng12","boshi12","isBodyPalace","ages","range","palaceNames","yearlyDecStar","suiqian12","jiangqian12","controlRef","sliderRef","activeElement","querySelector","buttonElement","nextElementSibling","updateSliderPosition","buttonRect","controlRect","opacity","animationId","resizeObserver","cancelAnimationFrame","optionValue","onTouchStart","touches","touch","currentTarget","dataset","touchStartX","clientX","touchStartY","clientY","onTouchMove","parseFloat","deltaX","deltaY","onTouchEnd","option","activeCategory","find","c","category","subCategory","markdownFormatter_1","MessageItem","isUser","displayedContent","setDisplayedContent","hasStartedStreaming","setHasStartedStreaming","contentRef","handleCopy","clipboard","writeText","err","handleShare","share","shareData","title","text","shouldShowActions","d","x","y","rx","ry","cx","cy","r","formatStars","lunarDate","timeRange","sign","zodiac","_f","_g","_h","isOriginalPalace","formatPalace","nominalAge","Line","strokeColor","element","getElementsByClassName","idx","canvasDom","w","h","canvasCtx","getContext","clearRect","strokeStyle","lineWidth","globalAlpha","dgIdx","q4Idx","h4Idx","beginPath","moveTo","lineTo","onLoadHistory","onEditHistory","handlePasswordKeyDown","onKeyDown","FormContainer","setChartMode","onFormChange","onSynastryChange","onRadioChange","onSynastryRadioChange","onSynastrySubmit","onShowHistory","handleFormChange","handleSynastryChange","person","htmlFor","useNetworkRequest","cacheKey","cacheTTL","maxRetries","retryDelay","retryBackoff","setError","cacheRef","isCacheValid","getFromCache","fullKey","setCache","clearCache","keys","delete","ms","sendRequest","requestConfig","customCacheKey","url","cacheData","retryCount","currentRetryDelay","attemptRequest","fetchOptions","cancelRequest","messages_1","args_1","Item","layoutConfig","setLayoutConfig","isInitialized","setIsInitialized","updateLayout","newConfig","updatedConfig","initializeLayout","handleResize","handleMobileLayout","handleDesktopLayout","handleOrientationChange","currentIsMobile","getGridTemplateStyle","contains","gridTemplateRows","baseStyle","display","minHeight","overflow","bottom","overflowY","scrollSnapType","paddingTop","paddingBottom","marginTop","marginBottom","padding","flexShrink","backgroundColor","zIndex","borderTop","AppContainer_1","ResultContainer_1","useHistoryManager_1","FormPanel_1","HistoryModal_1","setFormData","setSynastryData","showAstrolabe","setShowAstrolabe","showInputPanel","setShowInputPanel","urlParams","URLSearchParams","location","search","hasCompleteDateParams","updateThemeColor","isDarkMode","themeColor","metaThemeColor","setAttribute","getElementsByTagName","appendChild","darkModeMediaQuery","darkModeListener","updateUrlParams","params","newUrl","pathname","replaceState","handleLoadHistory","handleEditHistory","handleShowInputPanel","AppContainer","onSaveHistory","Item_1","Line_1","lunar_lite_1","records","horoDate","dateStr","normalizeDateStr","dt","solar","lunar","solar2lunar","prevDecadalDisabled","setFullYear","onHoroscopeButtonClicked","birthYear","birthMonth","birthDate","setDate","setMonth","getTime","shouldBeDisabled","fixEarthlyBranchIndex","rec","CHINESE_TIME","useKeyboardDetector_1","useKeyboardDetector","useSafeArea","storageKey","allMessages","setAllMessages","setVisibleMessages","currentPage","setCurrentPage","setHasMore","loadMessagesFromStorage","storedMessages","parsedMessages","isArray","every","saveMessagesToStorage","recentMessages","cleanupError","initialVisible","updated","trimmed","nextPage","newVisibleMessages","latestMessages","setIsKeyboardVisible","setKeyboardHeight","calculatedKeyboardHeight","isKeyboardNowVisible","handleFocusIn","tagName","handleFocusOut","safeArea","setSafeArea","updateSafeArea","tempElement","computedStyle","newSafeArea","removeChild","FormContainer_1","handleSynastrySubmit"],"sourceRoot":""}