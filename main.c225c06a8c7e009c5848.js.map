{"version":3,"file":"main.c225c06a8c7e009c5848.js","mappings":"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","sources":["webpack://react-iztro/./src/hooks/useHistoryManager.ts","webpack://react-iztro/./src/AIChat/AIChatContext.tsx","webpack://react-iztro/./src/IzpalaceCenter/index.ts","webpack://react-iztro/./src/Izstar/Izstar.tsx","webpack://react-iztro/./src/AIChat/components/SkeletonLoader.tsx","webpack://react-iztro/./src/Iztrolabe/index.ts","webpack://react-iztro/./src/AIChat/hooks/useVirtualScroll.ts","webpack://react-iztro/./src/AIChat/components/MessageList.tsx","webpack://react-iztro/./src/AIChat/AIChat.tsx","webpack://react-iztro/./src/AIChat/components/HistoryPanel.tsx","webpack://react-iztro/./src/utils/historyUtils.ts","webpack://react-iztro/./src/utils/markdownFormatter.tsx","webpack://react-iztro/./src/AIChat/utils/messageUtils.ts","webpack://react-iztro/./src/Iztrolabe/Iztrolabe.type.ts","webpack://react-iztro/./src/AIChat/components/QuickActions.tsx","webpack://react-iztro/./src/AIChat/hooks/useVirtualKeyboard.ts","webpack://react-iztro/./src/AIChat/components/ChatContainer.tsx","webpack://react-iztro/./src/index.tsx","webpack://react-iztro/./src/AIChat/hooks/useMessageScroll.ts","webpack://react-iztro/./src/AIChat/index.ts","webpack://react-iztro/./src/AIChat/hooks/useAIChatService.ts","webpack://react-iztro/./src/AIChat/presets.ts","webpack://react-iztro/./src/Iztrolabe/Iztrolabe.tsx","webpack://react-iztro/./src/AIChat/utils/layoutUtils.ts","webpack://react-iztro/./src/containers/ResultContainer.tsx","webpack://react-iztro/./src/AIChat/components/ChatInput.tsx","webpack://react-iztro/./src/Izstar/index.ts","webpack://react-iztro/./src/utils/cloudStorage.ts","webpack://react-iztro/./src/Izpalace/Izpalace.tsx","webpack://react-iztro/./src/SegmentedControl/SegmentedControl.tsx","webpack://react-iztro/./src/AIChat/components/QuestionPanel.tsx","webpack://react-iztro/./src/AIChat/components/MessageItem.tsx","webpack://react-iztro/./src/utils/astrolabeFormatter.ts","webpack://react-iztro/./src/IzpalaceCenter/Line.tsx","webpack://react-iztro/./src/components/HistoryModal.tsx","webpack://react-iztro/./src/containers/FormContainer.tsx","webpack://react-iztro/./src/AIChat/components/TypingIndicator.tsx","webpack://react-iztro/./src/AIChat/hooks/useNetworkRequest.ts","webpack://react-iztro/./src/IzpalaceCenter/Item.tsx","webpack://react-iztro/./src/AIChat/hooks/useChatLayout.ts","webpack://react-iztro/./src/App.tsx","webpack://react-iztro/./src/IzpalaceCenter/IzpalaceCenter.tsx","webpack://react-iztro/./src/AIChat/components/ScrollToBottomButton.tsx","webpack://react-iztro/./src/AIChat/BackgroundAIIndicator.tsx","webpack://react-iztro/./src/containers/AppContainer.tsx","webpack://react-iztro/./src/AIChat/hooks/useMessageStorage.ts","webpack://react-iztro/./src/utils/useKeyboardDetector.ts","webpack://react-iztro/./src/components/FormPanel.tsx"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useHistoryManager = void 0;\nconst react_1 = require(\"react\");\nconst historyUtils_1 = require(\"../utils/historyUtils\");\nconst useHistoryManager = () => {\n    const [history, setHistory] = (0, react_1.useState)([]);\n    const [showHistoryModal, setShowHistoryModal] = (0, react_1.useState)(false);\n    const [searchTerm, setSearchTerm] = (0, react_1.useState)(\"\");\n    const [showPasswordInput, setShowPasswordInput] = (0, react_1.useState)(false);\n    const [password, setPassword] = (0, react_1.useState)(\"\");\n    const [isCloudStorageEnabled, setIsCloudStorageEnabled] = (0, react_1.useState)(false);\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [editingHistoryId, setEditingHistoryId] = (0, react_1.useState)(null);\n    // 初始化历史管理器和加载历史记录\n    (0, react_1.useEffect)(() => {\n        const initializeHistory = () => __awaiter(void 0, void 0, void 0, function* () {\n            // 初始化云存储状态\n            historyUtils_1.HistoryManager.initialize();\n            console.log('useHistoryManager: 初始化历史管理器');\n            // 获取历史记录（如果启用了云存储，会自动从云端加载）\n            const history = yield historyUtils_1.HistoryManager.getHistoryWithCloudSync();\n            setHistory(history);\n            setIsCloudStorageEnabled(historyUtils_1.HistoryManager.isCloudStorageEnabled());\n            console.log('useHistoryManager: 历史记录已加载，数量:', history.length);\n        });\n        initializeHistory();\n    }, []);\n    // 处理密码提交\n    const handlePasswordSubmit = (0, react_1.useCallback)(() => __awaiter(void 0, void 0, void 0, function* () {\n        if (!password.trim())\n            return;\n        setIsLoading(true);\n        try {\n            console.log('useHistoryManager: 提交密码启用云存储');\n            const success = yield historyUtils_1.HistoryManager.enableCloudStorage(password);\n            if (success) {\n                console.log('useHistoryManager: 云存储启用成功，重新加载历史记录');\n                setIsCloudStorageEnabled(true);\n                setShowPasswordInput(false);\n                setPassword(\"\");\n                // 刷新历史记录（从云端加载）\n                const history = yield historyUtils_1.HistoryManager.getHistoryWithCloudSync();\n                setHistory(history);\n                console.log('useHistoryManager: 历史记录已刷新，数量:', history.length);\n            }\n            else {\n                alert(\"密码错误，请重试\");\n            }\n        }\n        catch (error) {\n            console.error(\"启用云存储失败:\", error);\n            alert(\"启用云存储失败，请稍后再试\");\n        }\n        finally {\n            setIsLoading(false);\n        }\n    }), [password]);\n    // 处理历史记录保存\n    const handleSaveHistory = (0, react_1.useCallback)((item) => __awaiter(void 0, void 0, void 0, function* () {\n        if (editingHistoryId) {\n            // 如果正在编辑，更新现有记录\n            yield historyUtils_1.HistoryManager.updateHistory(editingHistoryId, item);\n            // 重置编辑状态\n            setEditingHistoryId(null);\n        }\n        else {\n            // 如果不是编辑，创建新记录\n            yield historyUtils_1.HistoryManager.saveHistory(item);\n        }\n        setHistory(historyUtils_1.HistoryManager.getHistory());\n    }), [editingHistoryId]);\n    // 处理历史记录删除\n    const handleDeleteHistory = (0, react_1.useCallback)((id) => __awaiter(void 0, void 0, void 0, function* () {\n        yield historyUtils_1.HistoryManager.deleteHistory(id);\n        setHistory(historyUtils_1.HistoryManager.getHistory());\n    }), []);\n    // 处理历史记录清空\n    const handleClearHistory = (0, react_1.useCallback)(() => __awaiter(void 0, void 0, void 0, function* () {\n        if (isCloudStorageEnabled) {\n            alert(\"云存储已启用，无法清空历史记录\");\n            return;\n        }\n        if (confirm('确定要清空所有历史记录吗？')) {\n            yield historyUtils_1.HistoryManager.clearHistory();\n            setHistory([]);\n        }\n    }), [isCloudStorageEnabled]);\n    // 过滤历史记录\n    const filteredHistory = history.filter(item => {\n        var _a;\n        return item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n            (item.type === 'synastry' && ((_a = item.person2) === null || _a === void 0 ? void 0 : _a.name.toLowerCase().includes(searchTerm.toLowerCase()))) ||\n            `${item.year}-${item.month}-${item.day}`.includes(searchTerm);\n    });\n    return {\n        history: filteredHistory,\n        showHistoryModal,\n        setShowHistoryModal,\n        searchTerm,\n        setSearchTerm,\n        showPasswordInput,\n        setShowPasswordInput,\n        password,\n        setPassword,\n        isCloudStorageEnabled,\n        isLoading,\n        editingHistoryId,\n        setEditingHistoryId,\n        handlePasswordSubmit,\n        handleSaveHistory,\n        handleDeleteHistory,\n        handleClearHistory,\n    };\n};\nexports.useHistoryManager = useHistoryManager;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAIChat = exports.AIChatProvider = void 0;\nconst react_1 = __importStar(require(\"react\"));\n// --- Helper Functions ---\nconst generateUUID = () => {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n};\nconst STORAGE_KEY = 'aiChatSessions';\nconst AIChatContext = (0, react_1.createContext)(undefined);\n// --- Provider Component ---\nconst AIChatProvider = ({ children }) => {\n    const [sessions, setSessions] = (0, react_1.useState)([]);\n    const [activeSessionId, setActiveSessionId] = (0, react_1.useState)(null);\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [isGeneratingInBackground, setIsGeneratingInBackground] = (0, react_1.useState)(false);\n    // Load sessions from localStorage on initial render\n    (0, react_1.useEffect)(() => {\n        try {\n            const savedSessions = localStorage.getItem(STORAGE_KEY);\n            if (savedSessions) {\n                const parsedSessions = JSON.parse(savedSessions);\n                if (parsedSessions.length > 0) {\n                    setSessions(parsedSessions);\n                    // Activate the most recent session\n                    setActiveSessionId(parsedSessions[0].id);\n                }\n            }\n        }\n        catch (error) {\n            console.error(\"Failed to load chat sessions from localStorage\", error);\n        }\n    }, []);\n    // Save sessions to localStorage whenever they change\n    (0, react_1.useEffect)(() => {\n        try {\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(sessions));\n        }\n        catch (error) {\n            console.error(\"Failed to save chat sessions to localStorage\", error);\n        }\n    }, [sessions]);\n    const createSession = (0, react_1.useCallback)(() => {\n        const newSession = {\n            id: generateUUID(),\n            title: '新的对话',\n            messages: [],\n            createdAt: Date.now(),\n        };\n        setSessions(prev => [newSession, ...prev]);\n        setActiveSessionId(newSession.id);\n        return newSession;\n    }, []);\n    const switchSession = (0, react_1.useCallback)((sessionId) => {\n        const sessionExists = sessions.some(s => s.id === sessionId);\n        if (sessionExists) {\n            setActiveSessionId(sessionId);\n        }\n        else {\n            console.error(`Session with id ${sessionId} not found.`);\n        }\n    }, [sessions]);\n    const deleteSession = (0, react_1.useCallback)((sessionId) => {\n        setSessions(prev => {\n            const newSessions = prev.filter(s => s.id !== sessionId);\n            if (activeSessionId === sessionId) {\n                setActiveSessionId(newSessions.length > 0 ? newSessions[0].id : null);\n            }\n            return newSessions;\n        });\n    }, [activeSessionId]);\n    const clearAllSessions = (0, react_1.useCallback)(() => {\n        setSessions([]);\n        setActiveSessionId(null);\n        // The useEffect for localStorage will handle the actual clearing.\n    }, []);\n    const updateSessionMessages = (0, react_1.useCallback)((sessionId, newMessages) => {\n        setSessions(prev => prev.map(session => session.id === sessionId\n            ? Object.assign(Object.assign({}, session), { messages: typeof newMessages === 'function' ? newMessages(session.messages) : newMessages }) : session));\n    }, []);\n    const setMessages = (0, react_1.useCallback)((messages) => {\n        if (activeSessionId) {\n            updateSessionMessages(activeSessionId, messages);\n        }\n    }, [activeSessionId, updateSessionMessages]);\n    const addMessage = (0, react_1.useCallback)((message) => {\n        if (activeSessionId) {\n            updateSessionMessages(activeSessionId, prev => [...prev, message]);\n        }\n    }, [activeSessionId, updateSessionMessages]);\n    const updateLastMessage = (0, react_1.useCallback)((content) => {\n        if (activeSessionId) {\n            updateSessionMessages(activeSessionId, prev => {\n                if (prev.length === 0 || prev[prev.length - 1].role !== 'assistant') {\n                    return prev;\n                }\n                const newMessages = [...prev];\n                newMessages[newMessages.length - 1] = Object.assign(Object.assign({}, newMessages[newMessages.length - 1]), { content });\n                return newMessages;\n            });\n        }\n    }, [activeSessionId, updateSessionMessages]);\n    const clearMessages = (0, react_1.useCallback)(() => {\n        if (activeSessionId) {\n            updateSessionMessages(activeSessionId, []);\n        }\n    }, [activeSessionId, updateSessionMessages]);\n    const updateSessionTitle = (0, react_1.useCallback)((sessionId, title) => {\n        setSessions(prev => prev.map(session => session.id === sessionId ? Object.assign(Object.assign({}, session), { title }) : session));\n    }, []);\n    const activeSession = (0, react_1.useMemo)(() => {\n        var _a;\n        return (_a = sessions.find(s => s.id === activeSessionId)) !== null && _a !== void 0 ? _a : null;\n    }, [sessions, activeSessionId]);\n    const contextValue = {\n        sessions,\n        activeSessionId,\n        activeSession,\n        isLoading,\n        isGeneratingInBackground,\n        createSession,\n        switchSession,\n        deleteSession,\n        setMessages,\n        addMessage,\n        updateLastMessage,\n        updateSessionTitle,\n        clearMessages,\n        clearAllSessions,\n        setIsLoading,\n        setIsGeneratingInBackground,\n    };\n    return (react_1.default.createElement(AIChatContext.Provider, { value: contextValue }, children));\n};\nexports.AIChatProvider = AIChatProvider;\n// --- Custom Hook ---\nconst useAIChat = () => {\n    const context = (0, react_1.useContext)(AIChatContext);\n    if (context === undefined) {\n        throw new Error('useAIChat must be used within an AIChatProvider');\n    }\n    return context;\n};\nexports.useAIChat = useAIChat;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./IzpalaceCenter\"), exports);\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Izstar = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst data_1 = require(\"iztro/lib/data\");\nconst i18n_1 = require(\"iztro/lib/i18n\");\nconst utils_1 = require(\"iztro/lib/utils\");\nconst Izstar = (_a) => {\n    var { horoscopeMutagens, activeHeavenlyStem, hoverHeavenlyStem, palaceHeavenlyStem } = _a, star = __rest(_a, [\"horoscopeMutagens\", \"activeHeavenlyStem\", \"hoverHeavenlyStem\", \"palaceHeavenlyStem\"]);\n    const mutagenStyle = (0, react_1.useMemo)(() => {\n        if (!activeHeavenlyStem) {\n            return \"\";\n        }\n        const mutagens = (0, utils_1.getMutagensByHeavenlyStem)((0, i18n_1.t)(activeHeavenlyStem));\n        const index = mutagens.indexOf(star.name);\n        if (index < 0) {\n            return \"\";\n        }\n        return `iztro-star-mutagen-${index}`;\n    }, [activeHeavenlyStem, star.name]);\n    const hoverMutagenStyle = (0, react_1.useMemo)(() => {\n        if (!hoverHeavenlyStem) {\n            return \"\";\n        }\n        const mutagens = (0, utils_1.getMutagensByHeavenlyStem)((0, i18n_1.t)(hoverHeavenlyStem));\n        const index = mutagens.indexOf(star.name);\n        if (index < 0) {\n            return \"\";\n        }\n        return `iztro-star-hover-mutagen-${index}`;\n    }, [hoverHeavenlyStem, star.name]);\n    const selfMutagenStyle = (0, react_1.useMemo)(() => {\n        if (!palaceHeavenlyStem || activeHeavenlyStem || hoverHeavenlyStem) {\n            return undefined;\n        }\n        const mutagens = (0, utils_1.getMutagensByHeavenlyStem)((0, i18n_1.t)(palaceHeavenlyStem));\n        const index = mutagens.indexOf(star.name);\n        if (index < 0) {\n            return \"\";\n        }\n        return `iztro-star-self-mutagen-${index}`;\n    }, [palaceHeavenlyStem, activeHeavenlyStem, hoverHeavenlyStem]);\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-star\", `iztro-star-${star.type}`) },\n        react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"star-with-mutagen\", mutagenStyle, selfMutagenStyle, hoverMutagenStyle, {\n                \"iztro-star-self-mutagen\": !!selfMutagenStyle,\n            }) }, star.name),\n        react_1.default.createElement(\"i\", { className: (0, classnames_1.default)(\"iztro-star-brightness\") }, star.brightness),\n        star.mutagen && (react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"iztro-star-mutagen\", `mutagen-${data_1.MUTAGEN.indexOf((0, i18n_1.kot)(star.mutagen))}`) }, star.mutagen)), horoscopeMutagens === null || horoscopeMutagens === void 0 ? void 0 :\n        horoscopeMutagens.map((item) => {\n            if (item.mutagen.includes(star.name) && item.show) {\n                return (react_1.default.createElement(\"span\", { key: item.scope, className: (0, classnames_1.default)(\"iztro-star-mutagen\", `mutagen-${item.scope}`) }, (0, i18n_1.t)(data_1.MUTAGEN[item.mutagen.indexOf(star.name)])));\n            }\n        })));\n};\nexports.Izstar = Izstar;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\n/**\n * 骨架屏加载组件\n * 提供多种类型的骨架屏加载效果，改善用户体验\n */\nconst SkeletonLoader = ({ type = 'message', count = 1, animate = true, }) => {\n    const renderMessageSkeleton = () => (react_1.default.createElement(\"div\", { className: \"skeleton-message\" },\n        react_1.default.createElement(\"div\", { className: \"skeleton-avatar\" }),\n        react_1.default.createElement(\"div\", { className: \"skeleton-content\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-line skeleton-short\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-line\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-line skeleton-long\" }))));\n    const renderChatSkeleton = () => (react_1.default.createElement(\"div\", { className: \"skeleton-chat\" },\n        react_1.default.createElement(\"div\", { className: \"skeleton-header\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-title\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-subtitle\" })),\n        react_1.default.createElement(\"div\", { className: \"skeleton-messages\" }, Array.from({ length: 3 }).map((_, index) => (react_1.default.createElement(\"div\", { key: index, className: \"skeleton-message-wrapper\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-message-avatar\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-message-content\" },\n                react_1.default.createElement(\"div\", { className: \"skeleton-message-line\" }),\n                react_1.default.createElement(\"div\", { className: \"skeleton-message-line skeleton-short\" })))))),\n        react_1.default.createElement(\"div\", { className: \"skeleton-input\" },\n            react_1.default.createElement(\"div\", { className: \"skeleton-input-field\" }),\n            react_1.default.createElement(\"div\", { className: \"skeleton-input-button\" }))));\n    const renderInputSkeleton = () => (react_1.default.createElement(\"div\", { className: \"skeleton-input-container\" },\n        react_1.default.createElement(\"div\", { className: \"skeleton-input-field\" }),\n        react_1.default.createElement(\"div\", { className: \"skeleton-input-button\" })));\n    const renderSkeletons = () => {\n        const skeletons = [];\n        for (let i = 0; i < count; i++) {\n            switch (type) {\n                case 'message':\n                    skeletons.push(renderMessageSkeleton());\n                    break;\n                case 'chat':\n                    skeletons.push(renderChatSkeleton());\n                    break;\n                case 'input':\n                    skeletons.push(renderInputSkeleton());\n                    break;\n                default:\n                    skeletons.push(renderMessageSkeleton());\n            }\n        }\n        return skeletons;\n    };\n    return (react_1.default.createElement(\"div\", { className: `skeleton-loader ${animate ? 'skeleton-animate' : ''}` }, renderSkeletons()));\n};\nexports.default = SkeletonLoader;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./Iztrolabe\"), exports);\n__exportStar(require(\"./Iztrolabe.type\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useVirtualScroll = void 0;\nconst react_1 = require(\"react\");\n/**\n * 虚拟滚动Hook\n * 支持动态高度的虚拟滚动，优化长列表性能\n */\nconst useVirtualScroll = (items, containerRef, options = {}) => {\n    const { itemHeight = 80, // 默认项目高度\n    overscan = 5, // 预渲染的项目数量\n    defaultHeight = 80, // 默认高度\n     } = options;\n    const [scrollTop, setScrollTop] = (0, react_1.useState)(0);\n    const [containerHeight, setContainerHeight] = (0, react_1.useState)(0);\n    const [measuredItems, setMeasuredItems] = (0, react_1.useState)(new Map());\n    const [isScrolling, setIsScrolling] = (0, react_1.useState)(false);\n    const scrollTimeoutRef = (0, react_1.useRef)(null);\n    // 计算总高度\n    const totalHeight = (0, react_1.useMemo)(() => {\n        let height = 0;\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            height += (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n        }\n        return height;\n    }, [items, measuredItems, defaultHeight]);\n    // 计算可见项目\n    const visibleRange = (0, react_1.useMemo)(() => {\n        let startOffset = 0;\n        let startIndex = 0;\n        let endIndex = items.length;\n        // 找到起始索引\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            const itemHeight = (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            if (startOffset + itemHeight > scrollTop) {\n                startIndex = Math.max(0, i - overscan);\n                break;\n            }\n            startOffset += itemHeight;\n        }\n        // 找到结束索引\n        let currentOffset = startOffset;\n        for (let i = startIndex; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            const itemHeight = (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            if (currentOffset > scrollTop + containerHeight) {\n                endIndex = Math.min(items.length, i + overscan);\n                break;\n            }\n            currentOffset += itemHeight;\n        }\n        return { startIndex, endIndex, startOffset };\n    }, [items, scrollTop, containerHeight, measuredItems, defaultHeight, overscan]);\n    // 测量项目高度\n    const measureItem = (0, react_1.useCallback)((id, height) => {\n        setMeasuredItems(prev => {\n            const newMap = new Map(prev);\n            const existing = newMap.get(id);\n            // 只有当高度变化时才更新\n            if (!existing || existing.height !== height) {\n                newMap.set(id, { id, height, offset: (existing === null || existing === void 0 ? void 0 : existing.offset) || 0 });\n                // 更新后续项目的偏移量\n                let offset = 0;\n                for (let i = 0; i < items.length; i++) {\n                    const itemId = `${items[i].role}-${i}`;\n                    const item = newMap.get(itemId);\n                    if (item) {\n                        newMap.set(itemId, Object.assign(Object.assign({}, item), { offset }));\n                        offset += item.height;\n                    }\n                    else {\n                        offset += defaultHeight;\n                    }\n                }\n            }\n            return newMap;\n        });\n    }, [items, defaultHeight]);\n    // 处理滚动事件\n    const handleScroll = (0, react_1.useCallback)(() => {\n        if (containerRef.current) {\n            setScrollTop(containerRef.current.scrollTop);\n            setIsScrolling(true);\n            // 清除之前的超时\n            if (scrollTimeoutRef.current) {\n                clearTimeout(scrollTimeoutRef.current);\n            }\n            // 设置新的超时\n            scrollTimeoutRef.current = setTimeout(() => {\n                setIsScrolling(false);\n            }, 150);\n        }\n    }, [containerRef]);\n    // 更新容器高度\n    (0, react_1.useEffect)(() => {\n        const updateContainerHeight = () => {\n            if (containerRef.current) {\n                setContainerHeight(containerRef.current.clientHeight);\n            }\n        };\n        updateContainerHeight();\n        window.addEventListener('resize', updateContainerHeight);\n        return () => {\n            window.removeEventListener('resize', updateContainerHeight);\n            if (scrollTimeoutRef.current) {\n                clearTimeout(scrollTimeoutRef.current);\n            }\n        };\n    }, [containerRef]);\n    // 添加滚动事件监听器\n    (0, react_1.useEffect)(() => {\n        const container = containerRef.current;\n        if (container) {\n            container.addEventListener('scroll', handleScroll, { passive: true });\n            return () => {\n                container.removeEventListener('scroll', handleScroll);\n            };\n        }\n    }, [containerRef, handleScroll]);\n    // 计算可见项目\n    const visibleItems = (0, react_1.useMemo)(() => {\n        const result = [];\n        let offset = 0;\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            const measured = measuredItems.get(`${item.role}-${i}`);\n            const itemHeight = (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            if (i >= visibleRange.startIndex && i < visibleRange.endIndex) {\n                result.push({\n                    item,\n                    index: i,\n                    offset,\n                    height: itemHeight,\n                });\n            }\n            offset += itemHeight;\n        }\n        return result;\n    }, [items, measuredItems, visibleRange, defaultHeight]);\n    // 滚动到指定项目\n    const scrollToIndex = (0, react_1.useCallback)((index) => {\n        if (containerRef.current) {\n            let offset = 0;\n            for (let i = 0; i < index && i < items.length; i++) {\n                const measured = measuredItems.get(`${items[i].role}-${i}`);\n                offset += (measured === null || measured === void 0 ? void 0 : measured.height) || defaultHeight;\n            }\n            containerRef.current.scrollTo({\n                top: offset,\n                behavior: 'smooth',\n            });\n        }\n    }, [containerRef, items, measuredItems, defaultHeight]);\n    // 滚动到底部\n    const scrollToBottom = (0, react_1.useCallback)(() => {\n        if (containerRef.current) {\n            containerRef.current.scrollTo({\n                top: totalHeight,\n                behavior: 'smooth',\n            });\n        }\n    }, [containerRef, totalHeight]);\n    return {\n        visibleItems,\n        totalHeight,\n        isScrolling,\n        measureItem,\n        scrollToIndex,\n        scrollToBottom,\n        scrollTop,\n    };\n};\nexports.useVirtualScroll = useVirtualScroll;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst MessageItem_1 = __importDefault(require(\"./MessageItem\"));\nconst TypingIndicator_1 = __importDefault(require(\"./TypingIndicator\"));\nconst SkeletonLoader_1 = __importDefault(require(\"./SkeletonLoader\"));\nconst useMessageStorage_1 = require(\"../hooks/useMessageStorage\");\nconst useVirtualScroll_1 = require(\"../hooks/useVirtualScroll\");\n// 使用React.memo优化组件重渲染\nconst MessageList = react_1.default.memo(({ messages, isLoading, generationFailed, lastFailedMessage, onRegenerate, messagesContainerRef, lastMessageRef, isStreaming = false, useMessageStorage = false, // 默认不使用消息存储，保持向后兼容\nuseVirtualScroll = false, // 默认不使用虚拟滚动，保持向后兼容\n }) => {\n    // 使用消息存储和分页功能\n    const messageStorage = useMessageStorage ? (0, useMessageStorage_1.useMessageStorage)({\n        maxMessagesInMemory: 200, // 内存中最多保存200条消息\n        pageSize: 30, // 每页显示30条消息\n    }) : null;\n    const { visibleMessages: storedVisibleMessages = messages, isLoading: isStorageLoading = false, hasMore = false, addMessages = () => { }, loadMoreMessages = () => { }, resetToLatest = () => { } } = messageStorage || {};\n    // 确定使用哪些消息\n    const displayMessages = useMessageStorage ? storedVisibleMessages : messages;\n    // 使用虚拟滚动\n    const virtualScroll = useVirtualScroll ? (0, useVirtualScroll_1.useVirtualScroll)(displayMessages, messagesContainerRef, {\n        itemHeight: 80, // 默认项目高度\n        overscan: 3, // 预渲染的项目数量\n        defaultHeight: 80, // 默认高度\n    }) : null;\n    const { visibleItems = [], totalHeight = 0, isScrolling = false, measureItem = () => { }, scrollToIndex = () => { }, scrollToBottom = () => { }, } = virtualScroll || {};\n    // 监听外部消息变化，更新存储\n    (0, react_1.useEffect)(() => {\n        if (useMessageStorage && messages.length > 0) {\n            // 只添加新的消息\n            const lastStoredMessage = storedVisibleMessages[storedVisibleMessages.length - 1];\n            const newMessages = lastStoredMessage\n                ? messages.filter(msg => !storedVisibleMessages.some((storedMsg) => storedMsg.role === msg.role && storedMsg.content === msg.content))\n                : messages;\n            if (newMessages.length > 0) {\n                addMessages(newMessages);\n            }\n        }\n    }, [messages, storedVisibleMessages, useMessageStorage, addMessages]);\n    // 滚动到顶部的观察器，用于加载更多消息\n    const topObserverRef = (0, react_1.useRef)(null);\n    // 设置Intersection Observer来检测滚动到顶部\n    (0, react_1.useEffect)(() => {\n        if (!useMessageStorage || !hasMore || isStorageLoading)\n            return;\n        const observer = new IntersectionObserver((entries) => {\n            if (entries[0].isIntersecting) {\n                loadMoreMessages();\n            }\n        }, {\n            root: messagesContainerRef.current,\n            threshold: 0.1,\n            rootMargin: '100px'\n        });\n        if (topObserverRef.current) {\n            observer.observe(topObserverRef.current);\n        }\n        return () => {\n            if (topObserverRef.current) {\n                observer.unobserve(topObserverRef.current);\n            }\n        };\n    }, [useMessageStorage, hasMore, isStorageLoading, loadMoreMessages, messagesContainerRef]);\n    // 自动滚动到底部\n    (0, react_1.useEffect)(() => {\n        if (!isScrolling && displayMessages.length > 0) {\n            scrollToBottom();\n        }\n    }, [displayMessages.length, isScrolling, scrollToBottom]);\n    // 使用useMemo优化消息列表渲染，避免不必要的重渲染\n    const messageItems = (0, react_1.useMemo)(() => {\n        if (useVirtualScroll) {\n            return visibleItems.map(({ item, index, offset, height }) => {\n                const originalIndex = displayMessages.indexOf(item);\n                const isLastMessage = originalIndex === displayMessages.length - 1;\n                return (react_1.default.createElement(\"div\", { key: `${item.role}-${originalIndex}-${item.content.slice(0, 20)}`, className: \"message-item-container\", style: {\n                        position: 'absolute',\n                        top: offset,\n                        left: 0,\n                        right: 0,\n                        height: height || 'auto',\n                    }, ref: (el) => {\n                        if (el) {\n                            // 测量项目高度\n                            const measuredHeight = el.getBoundingClientRect().height;\n                            measureItem(`${item.role}-${originalIndex}`, measuredHeight);\n                        }\n                    } },\n                    react_1.default.createElement(MessageItem_1.default, { message: item, isLastMessage: isLastMessage, showRegenerate: generationFailed &&\n                            item.role === \"assistant\" &&\n                            isLastMessage, onRegenerate: onRegenerate, messageRef: isLastMessage ? lastMessageRef : undefined, isStreaming: isStreaming && isLastMessage && item.role === \"assistant\", showActions: item.role === \"assistant\" && isLastMessage && !isStreaming })));\n            });\n        }\n        else {\n            return displayMessages.map((message, index) => {\n                const isLastMessage = index === displayMessages.length - 1;\n                return (react_1.default.createElement(MessageItem_1.default, { key: `${message.role}-${index}-${message.content.slice(0, 20)}`, message: message, isLastMessage: isLastMessage, showRegenerate: generationFailed &&\n                        message.role === \"assistant\" &&\n                        isLastMessage, onRegenerate: onRegenerate, messageRef: isLastMessage ? lastMessageRef : undefined, isStreaming: isStreaming && isLastMessage && message.role === \"assistant\", showActions: message.role === \"assistant\" && isLastMessage && !isStreaming }));\n            });\n        }\n    }, [displayMessages, visibleItems, useVirtualScroll, isLoading, generationFailed, isStreaming, onRegenerate, lastMessageRef, measureItem]);\n    return (react_1.default.createElement(\"div\", { ref: messagesContainerRef, className: \"chat-messages\" },\n        useVirtualScroll && (react_1.default.createElement(\"div\", { className: \"virtual-scroll-container\" }, messageItems)),\n        !useVirtualScroll && (react_1.default.createElement(react_1.default.Fragment, null,\n            useMessageStorage && hasMore && (react_1.default.createElement(\"div\", { ref: topObserverRef, className: \"load-more-trigger\" }, isStorageLoading ? '加载中...' : '向上滚动加载更多消息')),\n            messageItems)),\n        isLoading && (react_1.default.createElement(\"div\", { className: \"message assistant-message\" },\n            react_1.default.createElement(TypingIndicator_1.default, null))),\n        (isStorageLoading || (isLoading && displayMessages.length === 0)) && (react_1.default.createElement(\"div\", { className: \"chat-skeleton-fallback\" },\n            react_1.default.createElement(SkeletonLoader_1.default, { type: \"message\", count: 3, animate: true }))),\n        react_1.default.createElement(\"div\", { ref: lastMessageRef, className: \"bottom-observer\" })));\n});\nexports.default = MessageList;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nrequire(\"../styles/chat/chat.css\");\nrequire(\"../styles/index.css\");\n// 懒加载ChatContainer组件\nconst ChatContainer = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require('./components/ChatContainer'))));\nconst SkeletonLoader = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require('./components/SkeletonLoader'))));\n// 加载状态组件\nconst ChatLoadingFallback = () => (react_1.default.createElement(\"div\", { className: \"chat-loading-fallback\" },\n    react_1.default.createElement(\"div\", null, \"\\u52A0\\u8F7D\\u4E2D...\")));\n// 骨架屏加载组件\nconst ChatSkeletonFallback = () => (react_1.default.createElement(\"div\", { className: \"chat-skeleton-fallback\" },\n    react_1.default.createElement(react_1.Suspense, { fallback: react_1.default.createElement(ChatLoadingFallback, null) },\n        react_1.default.createElement(SkeletonLoader, { type: \"chat\", animate: true }))));\n/**\n * AI 聊天组件 - 优化版本\n *\n * 这个组件现在是一个轻量级的容器组件，主要职责是：\n * 1. 接收 props 并传递给 ChatContainer\n * 2. 提供清晰的组件接口\n * 3. 保持与原有 API 的兼容性\n * 4. 实现懒加载，提高初始加载性能\n *\n * 所有的业务逻辑和状态管理都已经移到 ChatContainer 和相关的 Hooks 中\n */\nconst AIChat = ({ formData, astrolabe, synastryAstrolabe, isSynastryMode = false, personNames = { person1: \"第一个人\", person2: \"第二个人\" }, isVisible = true, }) => {\n    const [shouldLoadChat, setShouldLoadChat] = (0, react_1.useState)(isVisible);\n    // 当组件变为可见时，延迟加载聊天组件\n    (0, react_1.useEffect)(() => {\n        if (isVisible) {\n            // 使用requestAnimationFrame确保在下一帧加载，避免阻塞主线程\n            requestAnimationFrame(() => {\n                setShouldLoadChat(true);\n            });\n        }\n    }, [isVisible]);\n    // 如果组件不可见，不渲染任何内容\n    if (!isVisible) {\n        return null;\n    }\n    return (react_1.default.createElement(react_1.Suspense, { fallback: react_1.default.createElement(ChatSkeletonFallback, null) }, shouldLoadChat && (react_1.default.createElement(ChatContainer, { formData: formData, astrolabe: astrolabe, synastryAstrolabe: synastryAstrolabe, isSynastryMode: isSynastryMode, personNames: personNames, isVisible: isVisible }))));\n};\nexports.default = react_1.default.memo(AIChat);\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst AIChatContext_1 = require(\"../AIChatContext\");\nrequire(\"../../styles/chat/history-panel.css\");\nconst HistoryPanel = ({ onSelectSession }) => {\n    const { sessions, activeSessionId, switchSession, deleteSession, updateSessionTitle, clearAllSessions } = (0, AIChatContext_1.useAIChat)();\n    const [editingSessionId, setEditingSessionId] = (0, react_1.useState)(null);\n    const [editingTitle, setEditingTitle] = (0, react_1.useState)('');\n    const handleEdit = (e, session) => {\n        e.stopPropagation();\n        setEditingSessionId(session.id);\n        setEditingTitle(session.title);\n    };\n    const handleTitleChange = (e) => {\n        setEditingTitle(e.target.value);\n    };\n    const handleTitleSave = () => {\n        if (editingSessionId && editingTitle.trim()) {\n            updateSessionTitle(editingSessionId, editingTitle.trim());\n        }\n        setEditingSessionId(null);\n        setEditingTitle('');\n    };\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter') {\n            handleTitleSave();\n        }\n        else if (e.key === 'Escape') {\n            setEditingSessionId(null);\n            setEditingTitle('');\n        }\n    };\n    const handleDelete = (e, sessionId) => {\n        e.stopPropagation(); // Prevent the session from being selected when deleting\n        if (window.confirm('您确定要删除这条记录吗？')) {\n            deleteSession(sessionId);\n        }\n    };\n    const handleClearAll = () => {\n        if (window.confirm('您确定要清空所有历史记录吗？此操作不可恢复。')) {\n            clearAllSessions();\n        }\n    };\n    const handleSessionClick = (sessionId) => {\n        switchSession(sessionId);\n        onSelectSession(sessionId); // Notify parent to switch tab\n    };\n    if (sessions.length === 0) {\n        return (react_1.default.createElement(\"div\", { className: \"history-panel empty-state\" },\n            react_1.default.createElement(\"p\", null, \"\\u8FD8\\u6CA1\\u6709\\u5386\\u53F2\\u8BB0\\u5F55\"),\n            react_1.default.createElement(\"span\", null, \"\\u5F00\\u59CB\\u4E00\\u6BB5\\u65B0\\u7684\\u5BF9\\u8BDD\\u5427\\uFF01\")));\n    }\n    return (react_1.default.createElement(\"div\", { className: \"history-panel\" },\n        react_1.default.createElement(\"ul\", { className: \"history-list\" }, sessions.map((session) => (react_1.default.createElement(\"li\", { key: session.id, className: `history-item ${session.id === activeSessionId ? 'active' : ''}`, onClick: () => handleSessionClick(session.id) },\n            react_1.default.createElement(\"div\", { className: \"history-item-content\" },\n                react_1.default.createElement(\"div\", { className: \"history-item-main\" }, editingSessionId === session.id ? (react_1.default.createElement(\"input\", { type: \"text\", value: editingTitle, onChange: handleTitleChange, onBlur: handleTitleSave, onKeyDown: handleKeyDown, className: \"history-item-title-input\", autoFocus: true, onClick: (e) => e.stopPropagation() })) : (react_1.default.createElement(react_1.default.Fragment, null,\n                    react_1.default.createElement(\"p\", { className: \"history-item-title\" }, session.title),\n                    react_1.default.createElement(\"span\", { className: \"history-item-date\" }, new Date(session.createdAt).toLocaleString('zh-CN', {\n                        year: 'numeric',\n                        month: '2-digit',\n                        day: '2-digit',\n                        hour: '2-digit',\n                        minute: '2-digit',\n                    })))))),\n            react_1.default.createElement(\"div\", { className: \"history-item-actions\" },\n                react_1.default.createElement(\"button\", { className: \"history-action-button history-edit-icon\", onClick: (e) => handleEdit(e, session), \"aria-label\": \"\\u7F16\\u8F91\\u6807\\u9898\" },\n                    react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"18\", height: \"18\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                        react_1.default.createElement(\"path\", { d: \"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" }),\n                        react_1.default.createElement(\"path\", { d: \"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" }))),\n                react_1.default.createElement(\"button\", { className: \"history-action-button history-item-delete\", onClick: (e) => handleDelete(e, session.id), \"aria-label\": \"\\u5220\\u9664\\u8BB0\\u5F55\" },\n                    react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"18\", height: \"18\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                        react_1.default.createElement(\"polyline\", { points: \"3 6 5 6 21 6\" }),\n                        react_1.default.createElement(\"path\", { d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" }),\n                        react_1.default.createElement(\"line\", { x1: \"10\", y1: \"11\", x2: \"10\", y2: \"17\" }),\n                        react_1.default.createElement(\"line\", { x1: \"14\", y1: \"11\", x2: \"14\", y2: \"17\" })))))))),\n        sessions.length > 0 && (react_1.default.createElement(\"div\", { className: \"history-panel-footer\" },\n            react_1.default.createElement(\"button\", { className: \"history-clear-button\", onClick: handleClearAll }, \"\\u6E05\\u7A7A\\u6240\\u6709\\u8BB0\\u5F55\")))));\n};\nexports.default = HistoryPanel;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HistoryManager = void 0;\n/**\n * 导入云存储服务\n */\nconst cloudStorage_1 = require(\"./cloudStorage\");\n/**\n * 历史记录管理工具\n */\nclass HistoryManager {\n    /**\n     * 初始化方法，在类加载时调用\n     */\n    static initialize() {\n        // 初始化云存储服务\n        cloudStorage_1.CloudStorageService.initialize();\n        // 检查云存储是否已启用\n        this.isCloudEnabled = cloudStorage_1.CloudStorageService.isAuth();\n    }\n    /**\n     * 启用云存储\n     * @param password 云存储密码\n     * @returns 是否启用成功\n     */\n    static enableCloudStorage(password) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const isAuthenticated = yield cloudStorage_1.CloudStorageService.authenticate(password);\n                if (isAuthenticated) {\n                    this.isCloudEnabled = true;\n                    return true;\n                }\n                return false;\n            }\n            catch (error) {\n                console.error('启用云存储失败:', error);\n                return false;\n            }\n        });\n    }\n    /**\n     * 检查云存储是否已启用\n     * @returns 云存储是否已启用\n     */\n    static isCloudStorageEnabled() {\n        // 动态检查云存储状态，确保页面刷新后能正确恢复\n        this.isCloudEnabled = cloudStorage_1.CloudStorageService.isAuth();\n        return this.isCloudEnabled;\n    }\n    /**\n     * 禁用云存储\n     */\n    static disableCloudStorage() {\n        this.isCloudEnabled = false;\n        cloudStorage_1.CloudStorageService.clearAuthentication();\n    }\n    /**\n     * 从云端加载历史记录到本地\n     */\n    static loadHistoryFromCloud() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // 动态检查云存储状态\n            if (!this.isCloudStorageEnabled())\n                return;\n            try {\n                console.log('开始从云端加载历史记录...');\n                // 获取所有历史记录ID\n                const ids = yield cloudStorage_1.CloudStorageService.getHistoryIds();\n                console.log('获取到的历史记录ID列表:', ids);\n                if (ids.length === 0) {\n                    console.log('云端没有历史记录');\n                    return;\n                }\n                // 批量获取历史记录\n                const cloudHistory = yield cloudStorage_1.CloudStorageService.batchDownloadHistoryItems(ids);\n                console.log('从云端获取的历史记录:', cloudHistory);\n                console.log('历史记录数量:', cloudHistory.length);\n                // 检查每条记录的格式\n                cloudHistory.forEach((item, index) => {\n                    console.log(`记录 ${index}:`, item);\n                    console.log(`记录 ${index} 的类型:`, typeof item);\n                    console.log(`记录 ${index} 的键:`, Object.keys(item));\n                });\n                // 获取本地历史记录\n                const localHistory = this.getHistory();\n                console.log('本地历史记录:', localHistory);\n                // 合并本地和云端的历史记录\n                const mergedHistory = this.mergeHistories(localHistory, cloudHistory);\n                console.log('合并后的历史记录:', mergedHistory);\n                // 限制历史记录数量，最多保存50条\n                if (mergedHistory.length > 50) {\n                    mergedHistory.splice(50);\n                }\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(mergedHistory));\n                console.log('历史记录已保存到本地');\n            }\n            catch (error) {\n                console.error('从云端加载历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 保存历史记录到云端\n     */\n    static saveHistoryToCloud() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isCloudEnabled)\n                return;\n            try {\n                const history = this.getHistory();\n                // 上传每个历史记录\n                for (const item of history) {\n                    yield cloudStorage_1.CloudStorageService.uploadHistoryItem(item);\n                }\n            }\n            catch (error) {\n                console.error('保存历史记录到云端失败:', error);\n            }\n        });\n    }\n    /**\n     * 合并本地和云端的历史记录\n     * @param localHistory 本地历史记录\n     * @param cloudHistory 云端历史记录\n     * @returns 合并后的历史记录\n     */\n    static mergeHistories(localHistory, cloudHistory) {\n        console.log('开始合并历史记录...');\n        console.log('本地历史记录数量:', localHistory.length);\n        console.log('云端历史记录数量:', cloudHistory.length);\n        const mergedMap = new Map();\n        // 先添加云端历史记录\n        cloudHistory.forEach(item => {\n            mergedMap.set(item.id, item);\n            console.log('添加云端记录:', item.id);\n        });\n        // 再添加本地历史记录，如果ID相同则保留时间戳较新的\n        localHistory.forEach(item => {\n            const existingItem = mergedMap.get(item.id);\n            if (!existingItem) {\n                mergedMap.set(item.id, item);\n                console.log('添加本地记录（云端不存在）:', item.id);\n            }\n            else if (item.timestamp > existingItem.timestamp) {\n                mergedMap.set(item.id, item);\n                console.log('更新记录（本地版本更新）:', item.id);\n            }\n            else {\n                console.log('跳过本地记录（云端版本更新）:', item.id);\n            }\n        });\n        // 转换为数组并按时间戳降序排序\n        const mergedHistory = Array.from(mergedMap.values()).sort((a, b) => b.timestamp - a.timestamp);\n        console.log('合并后的历史记录数量:', mergedHistory.length);\n        return mergedHistory;\n    }\n    /**\n     * 保存历史记录到本地存储，如果云存储已启用则同步到云端\n     * @param item 历史记录项\n     */\n    static saveHistory(item) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const history = this.getHistory();\n                const newHistoryItem = Object.assign(Object.assign({}, item), { id: this.generateId(), timestamp: Date.now() });\n                // 添加到历史记录开头\n                history.unshift(newHistoryItem);\n                // 限制历史记录数量，最多保存50条\n                if (history.length > 50) {\n                    history.splice(50);\n                }\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(history));\n                // 动态检查云存储状态，如果已启用则保存到云端\n                if (this.isCloudStorageEnabled()) {\n                    yield cloudStorage_1.CloudStorageService.uploadHistoryItem(newHistoryItem);\n                }\n            }\n            catch (error) {\n                console.error('保存历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 从本地存储获取历史记录\n     * @returns 历史记录数组\n     */\n    static getHistory() {\n        try {\n            const historyJson = localStorage.getItem(this.STORAGE_KEY);\n            return historyJson ? JSON.parse(historyJson) : [];\n        }\n        catch (error) {\n            console.error('获取历史记录失败:', error);\n            return [];\n        }\n    }\n    /**\n     * 获取历史记录（如果启用了云存储，会自动从云端加载）\n     * @returns 历史记录数组\n     */\n    static getHistoryWithCloudSync() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // 动态检查云存储状态\n            const isCloudEnabled = this.isCloudStorageEnabled();\n            console.log('getHistoryWithCloudSync 被调用，云存储状态:', isCloudEnabled);\n            // 如果云存储已启用，从云端加载\n            if (isCloudEnabled) {\n                console.log('开始从云端加载历史记录...');\n                yield this.loadHistoryFromCloud();\n            }\n            else {\n                console.log('云存储未启用，只返回本地历史记录');\n            }\n            const localHistory = this.getHistory();\n            console.log('返回的历史记录:', localHistory);\n            return localHistory;\n        });\n    }\n    /**\n     * 更新指定ID的历史记录\n     * @param id 历史记录ID\n     * @param updatedItem 更新后的历史记录数据\n     */\n    static updateHistory(id, updatedItem) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const history = this.getHistory();\n                const itemIndex = history.findIndex(item => item.id === id);\n                if (itemIndex === -1) {\n                    console.error('未找到要更新的历史记录:', id);\n                    return;\n                }\n                // 更新历史记录，保留原有的ID和时间戳\n                history[itemIndex] = Object.assign(Object.assign({}, updatedItem), { id: id, timestamp: history[itemIndex].timestamp });\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(history));\n                // 动态检查云存储状态，如果已启用则更新云端记录\n                if (this.isCloudStorageEnabled()) {\n                    // 先删除云端记录，再上传更新后的记录\n                    yield cloudStorage_1.CloudStorageService.deleteHistoryItem(id);\n                    yield cloudStorage_1.CloudStorageService.uploadHistoryItem(history[itemIndex]);\n                }\n            }\n            catch (error) {\n                console.error('更新历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 删除指定ID的历史记录\n     * @param id 历史记录ID\n     */\n    static deleteHistory(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const history = this.getHistory();\n                const filteredHistory = history.filter(item => item.id !== id);\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(filteredHistory));\n                // 动态检查云存储状态，如果已启用则删除云端记录\n                if (this.isCloudStorageEnabled()) {\n                    yield cloudStorage_1.CloudStorageService.deleteHistoryItem(id);\n                }\n            }\n            catch (error) {\n                console.error('删除历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 清空所有历史记录\n     */\n    static clearHistory() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                localStorage.removeItem(this.STORAGE_KEY);\n                // 动态检查云存储状态，如果已启用则清空云端记录\n                if (this.isCloudStorageEnabled()) {\n                    yield cloudStorage_1.CloudStorageService.clearAllHistory();\n                }\n            }\n            catch (error) {\n                console.error('清空历史记录失败:', error);\n            }\n        });\n    }\n    /**\n     * 生成唯一ID\n     * @returns 唯一ID字符串\n     */\n    static generateId() {\n        return Date.now().toString(36) + Math.random().toString(36).substr(2);\n    }\n    /**\n     * 格式化日期显示\n     * @param timestamp 时间戳\n     * @returns 格式化后的日期字符串\n     */\n    static formatDate(timestamp) {\n        const date = new Date(timestamp);\n        return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\n    }\n}\nexports.HistoryManager = HistoryManager;\nHistoryManager.STORAGE_KEY = 'iztro_history';\nHistoryManager.isCloudEnabled = false;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst react_markdown_1 = __importDefault(require(\"react-markdown\"));\nconst remark_gfm_1 = __importDefault(require(\"remark-gfm\"));\nconst remark_breaks_1 = __importDefault(require(\"remark-breaks\"));\n/**\n * 懒加载图片组件\n * 实现图片懒加载，提高页面加载性能\n */\nconst LazyImage = (_a) => {\n    var { src, alt, className = \"markdown-img\" } = _a, props = __rest(_a, [\"src\", \"alt\", \"className\"]);\n    const [isLoaded, setIsLoaded] = (0, react_1.useState)(false);\n    const [isInView, setIsInView] = (0, react_1.useState)(false);\n    const imgRef = (0, react_1.useRef)(null);\n    (0, react_1.useEffect)(() => {\n        const observer = new IntersectionObserver(([entry]) => {\n            if (entry.isIntersecting) {\n                setIsInView(true);\n                observer.disconnect();\n            }\n        }, {\n            rootMargin: '100px', // 提前100px开始加载\n            threshold: 0.1\n        });\n        if (imgRef.current) {\n            observer.observe(imgRef.current);\n        }\n        return () => {\n            if (imgRef.current) {\n                observer.unobserve(imgRef.current);\n            }\n        };\n    }, []);\n    const handleLoad = () => {\n        setIsLoaded(true);\n    };\n    return (react_1.default.createElement(\"div\", { className: \"markdown-img-container\" },\n        !isLoaded && (react_1.default.createElement(\"div\", { className: \"markdown-img-placeholder\" },\n            react_1.default.createElement(\"div\", { className: \"loading-spinner\" }))),\n        react_1.default.createElement(\"img\", Object.assign({ ref: imgRef, src: isInView ? src : undefined, alt: alt, className: `${className} ${isLoaded ? 'loaded' : ''}`, onLoad: handleLoad }, props))));\n};\n/**\n * Markdown格式化组件\n * 将markdown文本转换为格式化的HTML元素\n * 优化版本：改进换行处理、添加更多元素支持、优化样式\n */\nconst MarkdownFormatter = ({ content }) => {\n    // 预处理内容，简化处理 - 使用useMemo避免重复计算\n    const processedContent = (0, react_1.useMemo)(() => {\n        return content\n            .replace(/\\n{3,}/g, '\\n\\n') // 将3个或更多换行减少为2个\n            .replace(/^[\\s─]*─{3,}[\\s─]*$/gm, '\\n\\n---\\n\\n') // 将由 ─ 组成的分割线转换为标准 markdown 分割线\n            .replace(/^\\s+|\\s+$/g, ''); // 去除首尾空白\n    }, [content]);\n    // 使用useMemo优化components对象，避免每次渲染都重新创建\n    const components = (0, react_1.useMemo)(() => ({\n        // 自定义标题样式\n        h1: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h1\", Object.assign({ className: \"markdown-h1\" }, props), children));\n        },\n        h2: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h2\", Object.assign({ className: \"markdown-h2\" }, props), children));\n        },\n        h3: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h3\", Object.assign({ className: \"markdown-h3\" }, props), children));\n        },\n        h4: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h4\", Object.assign({ className: \"markdown-h4\" }, props), children));\n        },\n        h5: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h5\", Object.assign({ className: \"markdown-h5\" }, props), children));\n        },\n        h6: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"h6\", Object.assign({ className: \"markdown-h6\" }, props), children));\n        },\n        // 自定义段落样式\n        p: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"p\", Object.assign({ className: \"markdown-p\" }, props), children));\n        },\n        // 自定义列表样式\n        ul: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"ul\", Object.assign({ className: \"markdown-ul\" }, props), children));\n        },\n        ol: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"ol\", Object.assign({ className: \"markdown-ol\" }, props), children));\n        },\n        li: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            // 检查是否是任务列表项\n            const isTask = react_1.default.Children.toArray(children).some((child) => react_1.default.isValidElement(child) && child.type === 'input');\n            return (react_1.default.createElement(\"li\", Object.assign({ className: `markdown-li ${isTask ? 'task-list-item' : ''}` }, props), children));\n        },\n        // 自定义链接样式\n        a: (_a) => {\n            var { href, children } = _a, props = __rest(_a, [\"href\", \"children\"]);\n            return (react_1.default.createElement(\"a\", Object.assign({ href: href, className: \"markdown-a\", target: \"_blank\", rel: \"noopener noreferrer\" }, props), children));\n        },\n        // 自定义代码样式\n        code: (props) => {\n            const { inline, className, children } = props, rest = __rest(props, [\"inline\", \"className\", \"children\"]);\n            const match = /language-(\\w+)/.exec(className || '');\n            const language = match ? match[1] : '';\n            return !inline && match ? (react_1.default.createElement(\"div\", { className: \"markdown-code-wrapper\" },\n                react_1.default.createElement(\"div\", { className: \"markdown-code-header\" },\n                    react_1.default.createElement(\"span\", { className: \"markdown-code-language\" }, language)),\n                react_1.default.createElement(\"code\", Object.assign({ className: `markdown-code-block ${className}` }, rest), children))) : (react_1.default.createElement(\"code\", Object.assign({ className: \"markdown-code-inline\" }, rest), children));\n        },\n        // 自定义代码块样式\n        pre: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"pre\", Object.assign({ className: \"markdown-pre\" }, props), children));\n        },\n        // 自定义引用样式\n        blockquote: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"blockquote\", Object.assign({ className: \"markdown-blockquote\" }, props), children));\n        },\n        // 自定义表格样式 - 改进响应式支持\n        table: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"div\", { className: \"markdown-table-wrapper\" },\n                react_1.default.createElement(\"table\", Object.assign({ className: \"markdown-table\" }, props), children)));\n        },\n        thead: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"thead\", Object.assign({ className: \"markdown-thead\" }, props), children));\n        },\n        tbody: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"tbody\", Object.assign({ className: \"markdown-tbody\" }, props), children));\n        },\n        tr: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"tr\", Object.assign({ className: \"markdown-tr\" }, props), children));\n        },\n        th: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"th\", Object.assign({ className: \"markdown-th\" }, props), children));\n        },\n        td: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"td\", Object.assign({ className: \"markdown-td\" }, props), children));\n        },\n        // 自定义强调样式\n        strong: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"strong\", Object.assign({ className: \"markdown-strong\" }, props), children));\n        },\n        em: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"em\", Object.assign({ className: \"markdown-em\" }, props), children));\n        },\n        // 自定义分割线样式\n        hr: (_a) => {\n            var props = __rest(_a, []);\n            return react_1.default.createElement(\"hr\", Object.assign({ className: \"markdown-hr\" }, props));\n        },\n        // 添加对图片的支持 - 优化版本，支持懒加载\n        img: (_a) => {\n            var { src, alt } = _a, props = __rest(_a, [\"src\", \"alt\"]);\n            // 使用自定义图片组件实现懒加载\n            return react_1.default.createElement(LazyImage, Object.assign({ src: src, alt: alt || '' }, props));\n        },\n        // 添加对删除线的支持\n        del: (_a) => {\n            var { children } = _a, props = __rest(_a, [\"children\"]);\n            return (react_1.default.createElement(\"del\", Object.assign({ className: \"markdown-del\" }, props), children));\n        },\n        // 添加对任务列表的支持\n        input: (_a) => {\n            var { checked, type } = _a, props = __rest(_a, [\"checked\", \"type\"]);\n            return (react_1.default.createElement(\"input\", Object.assign({ type: \"checkbox\", checked: checked, readOnly: true, className: \"markdown-task-checkbox\" }, props)));\n        },\n    }), []);\n    // 优化长内容渲染，使用memo避免不必要的重渲染\n    const markdownContent = (0, react_1.useMemo)(() => (react_1.default.createElement(react_markdown_1.default, { remarkPlugins: [remark_gfm_1.default, remark_breaks_1.default], rehypePlugins: [], components: components }, processedContent)), [processedContent, components]);\n    return (react_1.default.createElement(\"div\", { className: \"markdown-content\" }, markdownContent));\n};\nexports.default = react_1.default.memo(MarkdownFormatter);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getLastUserMessage = exports.filterValidMessages = exports.isValidMessage = exports.createErrorMessage = exports.processRemainingBuffer = exports.processStreamChunk = exports.buildAIMessages = exports.buildSystemPrompt = exports.formatAstrolabeForSynastry = void 0;\nconst astrolabeFormatter_1 = require(\"../../utils/astrolabeFormatter\");\n/**\n * 格式化星盘数据为AI可理解的格式（合盘模式专用）\n */\nconst formatAstrolabeForSynastry = (astrolabe, currentTime = new Date()) => {\n    if (!astrolabe) {\n        return '暂无星盘数据';\n    }\n    const formattedTime = currentTime.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        hour12: false\n    });\n    // 精简版只包含最关键的信息\n    let result = `\n=== 紫微斗数星盘数据（精简版）===\n当前时间：${formattedTime}\n\n基本信息：\n性别：${astrolabe.gender === 'male' ? '男' : '女'}\n阳历日期：${astrolabe.solarDate}\n干支纪年：${astrolabe.chineseDate}\n出生时辰：${astrolabe.time}\n命宫地支：${astrolabe.earthlyBranchOfSoulPalace}\n身宫地支：${astrolabe.earthlyBranchOfBodyPalace}\n命主：${astrolabe.soul}\n身主：${astrolabe.body}\n五行局：${astrolabe.fiveElementsClass}\n\n关键宫位信息：\n`;\n    // 只添加关键宫位信息（命宫、身宫、夫妻宫、事业宫、财帛宫）\n    const keyPalaces = ['命宫', '身宫', '夫妻宫', '事业宫', '财帛宫'];\n    if (astrolabe.palaces && astrolabe.palaces.length > 0) {\n        astrolabe.palaces.forEach((palace) => {\n            var _a, _b;\n            if (keyPalaces.includes(palace.name)) {\n                const majorStars = ((_a = palace.majorStars) === null || _a === void 0 ? void 0 : _a.map(star => star.name)) || [];\n                const minorStars = ((_b = palace.minorStars) === null || _b === void 0 ? void 0 : _b.map(star => star.name)) || [];\n                result += `\n${palace.name}：\n天干地支：${palace.heavenlyStem}${palace.earthlyBranch}\n主星：${majorStars.join('、') || '无'}\n辅星：${minorStars.join('、') || '无'}\n`;\n            }\n        });\n    }\n    // 添加简化的大限和流年信息\n    if (astrolabe.horoscope) {\n        const horoscope = astrolabe.horoscope();\n        if (horoscope) {\n            result += `\n当前运限：\n大限：${horoscope.decadal.heavenlyStem}${horoscope.decadal.earthlyBranch}\n流年：${horoscope.yearly.heavenlyStem}${horoscope.yearly.earthlyBranch}\n`;\n        }\n    }\n    return result.trim();\n};\nexports.formatAstrolabeForSynastry = formatAstrolabeForSynastry;\n/**\n * 构建AI系统提示\n */\nconst buildSystemPrompt = (formData, astrolabe, synastryAstrolabe, isSynastryMode, personNames) => {\n    const currentTime = new Date();\n    const basePrompt = `你是一位精通古法传承与现代应用的紫微斗数宗师。你的论断不仅基于星盘数据，更融入了深刻的人生智慧。请牢记以下心法：\n1. **天人合一**：星盘是人生命运的蓝图，但人的意志和后天努力同样重要。你的解读应充满智慧和慈悲，旨在帮助问询者“知命而用命”，而非宿命论。\n2. **言必有据**：所有的论断都必须严格依据所提供的星盘数据，结合宫、星、四化进行严谨的逻辑推演。\n3. **结构清晰**：回答应有章法，先有“总论”概括全局，再“分项”详述，最后必须落脚于“建议”，为问询者提供具体、可行的趋吉避凶之道。\n4. **口吻沉稳**：以一位学识渊博、洞察世事的长者口吻进行叙述，语言简练、沉稳、富有哲理。\n\n`;\n    if (isSynastryMode && synastryAstrolabe) {\n        // 合盘模式下的系统提示\n        const synastryData = (0, exports.formatAstrolabeForSynastry)(synastryAstrolabe, currentTime);\n        const person1Data = (0, exports.formatAstrolabeForSynastry)(astrolabe, currentTime);\n        return basePrompt + `现在，请根据以下两个人的星盘数据，为他们进行专业的“合盘”论断。\n\n第一个人（${personNames.person1}）的星盘数据：\n${person1Data}\n\n第二个人（${personNames.person2}）的星盘数据：\n${synastryData}\n\n请运用你的全部学识，特别是“宫位互叠”与“飞星四化”等高级技法，深度剖析二人的缘分本质、互动模式与潜在的共业。你的分析需直指核心，点明关系中的关键，并提供维系与发展的智慧建议。`;\n    }\n    else {\n        // 单人模式下的系统提示\n        const gender = (formData === null || formData === void 0 ? void 0 : formData.gender) === 'male' ? '男' : '女';\n        const astrolabeData = astrolabe ? (0, astrolabeFormatter_1.formatAstrolabeForAI)(astrolabe, currentTime, gender) : '暂无星盘数据';\n        return basePrompt + `现在，请根据以下用户的星盘数据和当前时间，结合他/她的问题，进行专业的“命盘”解读。\n\n${astrolabeData}\n\n请运用你的全部学识，洞察星盘背后的天机，为问询者指点迷津。`;\n    }\n};\nexports.buildSystemPrompt = buildSystemPrompt;\n/**\n * 构建发送给AI的消息数组\n */\nconst buildAIMessages = (systemPrompt, existingMessages, userMessage) => {\n    return [\n        { role: \"system\", content: systemPrompt },\n        ...existingMessages,\n        { role: userMessage.role, content: userMessage.content }\n    ];\n};\nexports.buildAIMessages = buildAIMessages;\n/**\n * 处理流式响应数据\n */\nconst processStreamChunk = (chunk, buffer, onMessageUpdate) => {\n    let assistantMessage = \"\";\n    let newBuffer = buffer + chunk;\n    // 按行分割，但保留可能的截断行\n    const lines = newBuffer.split(\"\\n\");\n    newBuffer = lines.pop() || \"\"; // 保留最后一个可能不完整的行\n    for (const line of lines) {\n        if (line.startsWith(\"data: \")) {\n            const data = line.slice(6).trim();\n            if (data === \"[DONE]\") {\n                continue;\n            }\n            // 跳过空数据\n            if (!data) {\n                continue;\n            }\n            try {\n                // 检查 JSON 数据是否完整\n                if (data.startsWith('{') && data.endsWith('}')) {\n                    const parsed = JSON.parse(data);\n                    if (parsed.choices && parsed.choices[0].delta && parsed.choices[0].delta.content) {\n                        const newContent = parsed.choices[0].delta.content;\n                        assistantMessage += newContent;\n                        // 立即通知更新新增的内容\n                        onMessageUpdate(newContent);\n                    }\n                }\n            }\n            catch (e) {\n                console.error(\"解析 SSE 数据时出错:\", e);\n                console.error(\"问题数据:\", data);\n            }\n        }\n    }\n    return { newBuffer, assistantMessage };\n};\nexports.processStreamChunk = processStreamChunk;\n/**\n * 处理缓冲区中剩余的数据\n */\nconst processRemainingBuffer = (buffer, onMessageUpdate) => {\n    let assistantMessage = \"\";\n    if (buffer.trim()) {\n        const lines = buffer.split(\"\\n\");\n        let newBuffer = \"\";\n        for (const line of lines) {\n            if (line.startsWith(\"data: \")) {\n                const data = line.slice(6).trim();\n                if (data && data !== \"[DONE]\") {\n                    try {\n                        if (data.startsWith('{') && data.endsWith('}')) {\n                            const parsed = JSON.parse(data);\n                            if (parsed.choices && parsed.choices[0].delta && parsed.choices[0].delta.content) {\n                                const newContent = parsed.choices[0].delta.content;\n                                assistantMessage += newContent;\n                                // 立即通知更新新增的内容\n                                onMessageUpdate(newContent);\n                            }\n                        }\n                    }\n                    catch (e) {\n                        console.error(\"解析缓冲区 SSE 数据时出错:\", e);\n                        console.error(\"问题数据:\", data);\n                    }\n                }\n            }\n        }\n        return newBuffer;\n    }\n    return buffer;\n};\nexports.processRemainingBuffer = processRemainingBuffer;\n/**\n * 创建错误消息\n */\nconst createErrorMessage = (error) => {\n    console.error(\"AI 服务错误:\", error);\n    return {\n        role: \"assistant\",\n        content: \"抱歉，我在处理您的消息时遇到了问题。请稍后再试。\",\n    };\n};\nexports.createErrorMessage = createErrorMessage;\n/**\n * 验证消息内容\n */\nconst isValidMessage = (message) => {\n    return message &&\n        typeof message.role === 'string' &&\n        ['user', 'assistant'].includes(message.role) &&\n        typeof message.content === 'string' &&\n        message.content.trim().length > 0;\n};\nexports.isValidMessage = isValidMessage;\n/**\n * 过滤无效消息\n */\nconst filterValidMessages = (messages) => {\n    return messages.filter(exports.isValidMessage);\n};\nexports.filterValidMessages = filterValidMessages;\n/**\n * 获取最后一条用户消息\n */\nconst getLastUserMessage = (messages) => {\n    const validMessages = (0, exports.filterValidMessages)(messages);\n    for (let i = validMessages.length - 1; i >= 0; i--) {\n        if (validMessages[i].role === 'user') {\n            return validMessages[i];\n        }\n    }\n    return null;\n};\nexports.getLastUserMessage = getLastUserMessage;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst QuickActions = ({ quickActions, onQuickActionClick, isLoading, }) => {\n    return (react_1.default.createElement(\"div\", { className: \"quick-actions-container\" },\n        react_1.default.createElement(\"div\", { className: \"quick-actions\" }, quickActions.map((action) => (react_1.default.createElement(\"button\", { key: action.id, className: \"quick-action-button\", onClick: () => onQuickActionClick(action.name, action.prompt), disabled: isLoading }, action.name))))));\n};\nexports.default = QuickActions;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useVirtualKeyboard = void 0;\nconst react_1 = require(\"react\");\nconst layoutUtils_1 = require(\"../utils/layoutUtils\");\n/**\n * 虚拟键盘处理 Hook\n * 提供虚拟键盘状态检测和处理功能\n */\nconst useVirtualKeyboard = () => {\n    const [keyboardState, setKeyboardState] = (0, react_1.useState)({\n        isVisible: false,\n        height: 0,\n    });\n    const isMobile = (0, react_1.useRef)((0, layoutUtils_1.isMobileDevice)());\n    const isAndroid = (0, react_1.useRef)((0, layoutUtils_1.isAndroidDevice)());\n    const navigationBarHeight = (0, react_1.useRef)((0, layoutUtils_1.getAndroidNavigationBarHeight)());\n    const observerRef = (0, react_1.useRef)(null);\n    // 更新键盘状态\n    const updateKeyboardState = (0, react_1.useCallback)((config) => {\n        const isVisible = config.keyboardHeight > 0;\n        setKeyboardState(prev => {\n            // 只有状态真正改变时才更新\n            if (prev.isVisible !== isVisible || prev.height !== config.keyboardHeight) {\n                return {\n                    isVisible,\n                    height: config.keyboardHeight,\n                };\n            }\n            return prev;\n        });\n        // 更新 CSS 变量\n        document.documentElement.style.setProperty('--keyboard-height', `${config.keyboardHeight}px`);\n        // 更新安卓导航栏高度变量\n        if (isAndroid.current) {\n            const navHeight = (0, layoutUtils_1.getAndroidNavigationBarHeight)();\n            navigationBarHeight.current = navHeight;\n            document.documentElement.style.setProperty('--android-navigation-bar-height', `${navHeight}px`);\n        }\n    }, []);\n    // 处理视口大小变化 - 优化性能，减少计算频率\n    const handleViewportResize = (0, react_1.useCallback)((0, layoutUtils_1.throttle)(() => {\n        var _a;\n        if (!isMobile.current)\n            return;\n        // 获取安全区域值 - 缓存计算结果\n        const safeAreaTop = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-top')) || 0;\n        const safeAreaBottom = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-bottom')) || 0;\n        let keyboardHeight = 0;\n        if (isAndroid.current) {\n            // 安卓设备特殊处理\n            const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n            const screenHeight = window.screen.height;\n            const windowHeight = window.innerHeight;\n            const navBarHeight = (0, layoutUtils_1.getAndroidNavigationBarHeight)();\n            // 计算键盘高度，减去导航栏高度\n            if (viewportHeight < windowHeight * 0.8) {\n                keyboardHeight = windowHeight - viewportHeight - navBarHeight;\n            }\n            // 确保键盘高度合理，且不为负数\n            keyboardHeight = Math.max(0, Math.min(keyboardHeight, screenHeight * 0.5));\n        }\n        else {\n            // iOS和其他设备使用原有逻辑\n            keyboardHeight = (0, layoutUtils_1.getKeyboardHeight)({\n                isMobile: true,\n                headerHeight: 60,\n                keyboardHeight: 0,\n                safeAreaTop,\n                safeAreaBottom,\n            });\n        }\n        updateKeyboardState({ keyboardHeight });\n    }, 200), [updateKeyboardState]); // 增加节流时间到200ms，减少计算频率\n    // 处理输入框焦点事件\n    const handleInputFocus = (0, react_1.useCallback)(() => {\n        if (!isMobile.current)\n            return;\n        // 延迟检测，确保键盘完全弹出\n        setTimeout(handleViewportResize, 300);\n    }, [handleViewportResize]);\n    const handleInputBlur = (0, react_1.useCallback)(() => {\n        if (!isMobile.current)\n            return;\n        // 延迟检测，确保键盘完全收起\n        setTimeout(() => {\n            updateKeyboardState({ keyboardHeight: 0 });\n        }, 100);\n    }, [updateKeyboardState]);\n    // 设置输入框事件监听\n    const setupInputListeners = (0, react_1.useCallback)((inputElement) => {\n        if (!inputElement || !isMobile.current)\n            return;\n        inputElement.addEventListener('focus', handleInputFocus);\n        inputElement.addEventListener('blur', handleInputBlur);\n        return () => {\n            inputElement.removeEventListener('focus', handleInputFocus);\n            inputElement.removeEventListener('blur', handleInputBlur);\n        };\n    }, [handleInputFocus, handleInputBlur]);\n    // 初始化监听器 - 优化性能，减少事件监听器数量\n    (0, react_1.useEffect)(() => {\n        if (!isMobile.current)\n            return;\n        // 监听视口大小变化 - 优先使用visualViewport\n        if (window.visualViewport) {\n            window.visualViewport.addEventListener('resize', handleViewportResize);\n        }\n        else {\n            // 如果不支持visualViewport，则使用window.resize\n            window.addEventListener('resize', handleViewportResize);\n        }\n        // 创建 ResizeObserver 监听根元素变化 - 增加防抖延迟\n        observerRef.current = new ResizeObserver((0, layoutUtils_1.debounce)(handleViewportResize, 200) // 增加到200ms\n        );\n        observerRef.current.observe(document.documentElement);\n        // 初始检测\n        handleViewportResize();\n        return () => {\n            // 清理监听器\n            if (window.visualViewport) {\n                window.visualViewport.removeEventListener('resize', handleViewportResize);\n            }\n            else {\n                window.removeEventListener('resize', handleViewportResize);\n            }\n            if (observerRef.current) {\n                observerRef.current.disconnect();\n            }\n        };\n    }, [handleViewportResize]);\n    // 添加键盘状态变化的 body 类\n    (0, react_1.useEffect)(() => {\n        if (keyboardState.isVisible) {\n            document.body.classList.add('keyboard-visible');\n        }\n        else {\n            document.body.classList.remove('keyboard-visible');\n        }\n    }, [keyboardState.isVisible]);\n    // 添加安卓设备检测类\n    (0, react_1.useEffect)(() => {\n        if (isAndroid.current) {\n            document.body.classList.add('android-device');\n            // 初始化安卓导航栏高度变量\n            const navHeight = (0, layoutUtils_1.getAndroidNavigationBarHeight)();\n            navigationBarHeight.current = navHeight;\n            document.documentElement.style.setProperty('--android-navigation-bar-height', `${navHeight}px`);\n        }\n        else {\n            document.body.classList.remove('android-device');\n        }\n    }, []);\n    return {\n        keyboardState,\n        setupInputListeners,\n        hideKeyboard: () => updateKeyboardState({ keyboardHeight: 0 }),\n    };\n};\nexports.useVirtualKeyboard = useVirtualKeyboard;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst AIChatContext_1 = require(\"../AIChatContext\");\nconst useMessageScroll_1 = require(\"../hooks/useMessageScroll\");\nconst useVirtualKeyboard_1 = require(\"../hooks/useVirtualKeyboard\");\nconst useAIChatService_1 = require(\"../hooks/useAIChatService\");\nconst useChatLayout_1 = require(\"../hooks/useChatLayout\");\nconst MessageList_1 = __importDefault(require(\"./MessageList\"));\nconst ChatInput_1 = __importDefault(require(\"./ChatInput\"));\nconst QuickActions_1 = __importDefault(require(\"./QuickActions\"));\nconst QuestionPanel_1 = __importDefault(require(\"./QuestionPanel\"));\nconst SkeletonLoader_1 = __importDefault(require(\"./SkeletonLoader\"));\nconst ScrollToBottomButton_1 = __importDefault(require(\"./ScrollToBottomButton\"));\n// 使用React.memo优化组件重渲染\nconst ChatContainerComponent = ({ formData, astrolabe, synastryAstrolabe, isSynastryMode = false, personNames = { person1: \"第一个人\", person2: \"第二个人\" }, isVisible = true, }) => {\n    const { activeSession, setMessages, isLoading, setIsLoading, updateLastMessage, updateSessionTitle, } = (0, AIChatContext_1.useAIChat)();\n    const messages = (0, react_1.useMemo)(() => { var _a; return (_a = activeSession === null || activeSession === void 0 ? void 0 : activeSession.messages) !== null && _a !== void 0 ? _a : []; }, [activeSession]);\n    // 本地状态管理\n    const [inputValue, setInputValue] = (0, react_1.useState)(\"\");\n    const [showQuestionPanel, setShowQuestionPanel] = (0, react_1.useState)(false);\n    const [isGenerating, setIsGenerating] = (0, react_1.useState)(false);\n    const [isStreaming, setIsStreaming] = (0, react_1.useState)(false);\n    const [generationFailed, setGenerationFailed] = (0, react_1.useState)(false);\n    const [lastFailedMessage, setLastFailedMessage] = (0, react_1.useState)(\"\");\n    const [activeQuestionTab, setActiveQuestionTab] = (0, react_1.useState)(\"感情\");\n    // 输入框引用\n    const inputRef = react_1.default.useRef(null);\n    // 懒加载数据\n    const [quickActionsData, setQuickActionsData] = (0, react_1.useState)([]);\n    const [synastryQuickActionsData, setSynastryQuickActionsData] = (0, react_1.useState)([]);\n    const [questionCategoriesData, setQuestionCategoriesData] = (0, react_1.useState)([]);\n    const [dataLoaded, setDataLoaded] = (0, react_1.useState)(false);\n    // 使用自定义 Hooks\n    const { messagesContainerRef, lastMessageRef, userScrolledUp, setUserScrolledUp, scrollToBottom, } = (0, useMessageScroll_1.useMessageScroll)(messages, isVisible, isStreaming);\n    const { keyboardState, setupInputListeners } = (0, useVirtualKeyboard_1.useVirtualKeyboard)();\n    const { getContainerStyle, getMessagesContainerStyle, getInputContainerStyle } = (0, useChatLayout_1.useChatLayout)();\n    // AI 聊天服务\n    const { sendMessage, regenerateResponse, stopGeneration } = (0, useAIChatService_1.useAIChatService)({\n        formData,\n        astrolabe,\n        synastryAstrolabe,\n        isSynastryMode,\n        personNames,\n        onMessageUpdate: updateLastMessage,\n        onMessagesChange: setMessages,\n        onLoadingChange: setIsLoading,\n        onGeneratingChange: setIsGenerating,\n        onStreamingChange: setIsStreaming,\n        onError: (error, message) => {\n            setGenerationFailed(error);\n            if (message)\n                setLastFailedMessage(message);\n        },\n    });\n    // 自动为新会话生成标题\n    (0, react_1.useEffect)(() => {\n        if (activeSession &&\n            activeSession.title === '新的对话' &&\n            activeSession.messages.length >= 2 &&\n            activeSession.messages[0].role === 'user') {\n            // 使用第一个用户问题作为标题，并截断\n            const newTitle = activeSession.messages[0].content.substring(0, 20);\n            updateSessionTitle(activeSession.id, newTitle);\n        }\n    }, [activeSession, updateSessionTitle]);\n    // 懒加载数据\n    (0, react_1.useEffect)(() => {\n        const loadData = () => __awaiter(void 0, void 0, void 0, function* () {\n            try {\n                // 动态导入预设数据\n                const { quickActions, synastryQuickActions, questionCategories } = yield Promise.resolve().then(() => __importStar(require('../presets')));\n                setQuickActionsData(quickActions);\n                setSynastryQuickActionsData(synastryQuickActions);\n                setQuestionCategoriesData(questionCategories);\n                setDataLoaded(true);\n            }\n            catch (error) {\n                console.error('加载数据失败:', error);\n                setDataLoaded(true); // 即使失败也设置为已加载，避免无限加载状态\n            }\n        });\n        loadData();\n    }, []);\n    // 处理虚拟键盘弹出时隐藏问题面板\n    (0, react_1.useEffect)(() => {\n        if (keyboardState.isVisible && showQuestionPanel) {\n            setShowQuestionPanel(false);\n        }\n    }, [keyboardState.isVisible, showQuestionPanel]);\n    // 使用useCallback优化事件处理函数\n    const handleSendMessage = (0, react_1.useCallback)((content) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!content.trim() || isLoading)\n            return;\n        const userMessage = { role: \"user\", content };\n        const updatedMessages = [...messages, userMessage];\n        setMessages(updatedMessages); // This now updates the active session\n        setInputValue(\"\");\n        setGenerationFailed(false);\n        setLastFailedMessage(content);\n        setShowQuestionPanel(false);\n        yield sendMessage(userMessage, updatedMessages);\n    }), [isLoading, messages, sendMessage, setMessages]);\n    const handleQuickActionClick = (0, react_1.useCallback)((name, prompt) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!name.trim() || isLoading)\n            return;\n        const userMessage = { role: \"user\", content: name };\n        const updatedMessages = [...messages, userMessage];\n        setMessages(updatedMessages); // This now updates the active session\n        setInputValue(\"\");\n        setGenerationFailed(false);\n        setLastFailedMessage(name);\n        setShowQuestionPanel(false);\n        yield sendMessage(Object.assign(Object.assign({}, userMessage), { content: prompt }), updatedMessages);\n    }), [isLoading, messages, sendMessage, setMessages]);\n    const handlePresetQuestionClick = (0, react_1.useCallback)((question) => {\n        handleSendMessage(question);\n    }, [handleSendMessage]);\n    const handleSubmit = (0, react_1.useCallback)((e) => {\n        e.preventDefault();\n        handleSendMessage(inputValue);\n    }, [handleSendMessage, inputValue]);\n    const toggleQuestionPanel = (0, react_1.useCallback)(() => {\n        setShowQuestionPanel(!showQuestionPanel);\n    }, [showQuestionPanel]);\n    const handleRegenerate = (0, react_1.useCallback)(() => __awaiter(void 0, void 0, void 0, function* () {\n        if (!lastFailedMessage.trim())\n            return;\n        setGenerationFailed(false);\n        yield regenerateResponse(lastFailedMessage, messages);\n    }), [lastFailedMessage, messages, regenerateResponse]);\n    const handleMessagesClick = (0, react_1.useCallback)(() => {\n        if (showQuestionPanel) {\n            setShowQuestionPanel(false);\n        }\n    }, [showQuestionPanel]);\n    if (!isVisible) {\n        return null;\n    }\n    return (react_1.default.createElement(\"div\", { className: `ai-chat ${isVisible ? \"visible\" : \"hidden\"}` },\n        react_1.default.createElement(MessageList_1.default, { messages: messages, isLoading: isLoading, generationFailed: generationFailed, lastFailedMessage: lastFailedMessage, onRegenerate: handleRegenerate, messagesContainerRef: messagesContainerRef, lastMessageRef: lastMessageRef, isStreaming: isStreaming }),\n        react_1.default.createElement(\"div\", { className: \"chat-input-container\", onClick: (e) => e.stopPropagation() }, !dataLoaded ? (\n        // 数据加载时显示骨架屏\n        react_1.default.createElement(\"div\", { className: \"chat-skeleton-fallback\" },\n            react_1.default.createElement(SkeletonLoader_1.default, { type: \"input\", animate: true }))) : (react_1.default.createElement(react_1.default.Fragment, null,\n            react_1.default.createElement(QuickActions_1.default, { quickActions: isSynastryMode ? synastryQuickActionsData : quickActionsData, onQuickActionClick: handleQuickActionClick, isLoading: isLoading }),\n            react_1.default.createElement(ChatInput_1.default, { inputValue: inputValue, onInputChange: setInputValue, onSubmit: handleSubmit, onToggleQuestionPanel: toggleQuestionPanel, onStopGeneration: stopGeneration, isGenerating: isGenerating, isLoading: isLoading, showQuestionPanel: showQuestionPanel, inputRef: inputRef, setupInputListeners: setupInputListeners }),\n            react_1.default.createElement(QuestionPanel_1.default, { questionCategories: questionCategoriesData, activeQuestionTab: activeQuestionTab, onTabChange: setActiveQuestionTab, onQuestionClick: handlePresetQuestionClick, showQuestionPanel: showQuestionPanel })))),\n        react_1.default.createElement(ScrollToBottomButton_1.default, { isVisible: userScrolledUp && (isStreaming || isLoading), onClick: () => {\n                scrollToBottom(true);\n                setUserScrolledUp(false);\n            } })));\n};\n// 使用React.memo优化组件重渲染\nconst ChatContainer = react_1.default.memo(ChatContainerComponent);\nexports.default = ChatContainer;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst client_1 = __importDefault(require(\"react-dom/client\"));\nconst App_1 = __importDefault(require(\"./App\"));\n// 注册 Service Worker\nconst registerServiceWorker = () => {\n    if ('serviceWorker' in navigator) {\n        window.addEventListener('load', () => {\n            // 在生产环境中使用 Workbox 生成的 service worker\n            // 在开发环境中使用手动创建的 service worker\n            const swUrl = process.env.NODE_ENV === 'production' ? '/service-worker.js' : '/service-worker.js';\n            navigator.serviceWorker.register(swUrl)\n                .then(registration => {\n                console.log('ServiceWorker registration successful with scope: ', registration.scope);\n            })\n                .catch(error => {\n                console.log('ServiceWorker registration failed: ', error);\n            });\n        });\n    }\n};\nconst root = client_1.default.createRoot(document.getElementById(\"root\"));\nroot.render(react_1.default.createElement(react_1.default.StrictMode, null,\n    react_1.default.createElement(App_1.default, null)));\n// 注册 Service Worker\nregisterServiceWorker();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useMessageScroll = void 0;\nconst react_1 = require(\"react\");\n/**\n * 消息滚动处理 Hook\n * 提供自动滚动和用户滚动检测功能\n */\nconst useMessageScroll = (messages, isVisible, isStreaming = false) => {\n    const [userScrolledUp, setUserScrolledUp] = (0, react_1.useState)(false);\n    const [isUserActivelyScrolling, setIsUserActivelyScrolling] = (0, react_1.useState)(false);\n    const messagesContainerRef = (0, react_1.useRef)(null);\n    const lastMessageRef = (0, react_1.useRef)(null);\n    const observerRef = (0, react_1.useRef)(null);\n    const scrollTimeoutRef = (0, react_1.useRef)(null);\n    const userScrollTimeoutRef = (0, react_1.useRef)(null);\n    // 检查是否滚动到底部\n    const isAtBottom = (0, react_1.useCallback)(() => {\n        const container = messagesContainerRef.current;\n        if (!container)\n            return true;\n        const { scrollTop, scrollHeight, clientHeight } = container;\n        const threshold = 100; // 100px 的阈值\n        return scrollHeight - scrollTop <= clientHeight + threshold;\n    }, []);\n    // 滚动到底部\n    const scrollToBottom = (0, react_1.useCallback)((force = false) => {\n        if (!isVisible)\n            return;\n        // 如果用户正在主动滚动或者向上滚动了且不是强制滚动，则不自动滚动\n        if ((isUserActivelyScrolling || userScrolledUp) && !force)\n            return;\n        const container = messagesContainerRef.current;\n        if (!container)\n            return;\n        // 使用 requestAnimationFrame 优化滚动性能\n        requestAnimationFrame(() => {\n            // 强制滚动到绝对底部，确保完全可见\n            container.scrollTo({\n                top: container.scrollHeight,\n                behavior: force ? 'auto' : 'smooth',\n            });\n            // 如果是强制滚动，再次确保滚动到底部（处理移动端可能的延迟）\n            if (force) {\n                setTimeout(() => {\n                    container.scrollTo({\n                        top: container.scrollHeight,\n                        behavior: 'auto',\n                    });\n                }, 50);\n            }\n        });\n    }, [isVisible, userScrolledUp, isUserActivelyScrolling]);\n    // 处理滚动事件 - 优化性能，减少状态更新频率\n    const handleScroll = (0, react_1.useCallback)(() => {\n        // 清除之前的超时\n        if (scrollTimeoutRef.current) {\n            clearTimeout(scrollTimeoutRef.current);\n        }\n        // 清除用户滚动状态的超时\n        if (userScrollTimeoutRef.current) {\n            clearTimeout(userScrollTimeoutRef.current);\n        }\n        // 标记用户正在主动滚动\n        setIsUserActivelyScrolling(true);\n        // 防抖处理滚动事件 - 增加延迟时间，减少频繁更新\n        scrollTimeoutRef.current = setTimeout(() => {\n            const atBottom = isAtBottom();\n            setUserScrolledUp(!atBottom);\n            // 如果用户停止滚动一段时间后，重置主动滚动状态 - 增加延迟时间\n            userScrollTimeoutRef.current = setTimeout(() => {\n                setIsUserActivelyScrolling(false);\n            }, 1500); // 增加到1.5秒\n        }, 150); // 增加到150ms\n    }, [isAtBottom]);\n    // 设置 Intersection Observer 监听最后一条消息\n    (0, react_1.useEffect)(() => {\n        if (!isVisible)\n            return;\n        observerRef.current = new IntersectionObserver(([entry]) => {\n            // 如果最后一条消息可见，说明用户在底部\n            if (entry.isIntersecting) {\n                setUserScrolledUp(false);\n                setIsUserActivelyScrolling(false);\n            }\n        }, {\n            root: messagesContainerRef.current,\n            threshold: 0.1,\n        });\n        if (lastMessageRef.current) {\n            observerRef.current.observe(lastMessageRef.current);\n        }\n        return () => {\n            if (observerRef.current) {\n                observerRef.current.disconnect();\n            }\n        };\n    }, [isVisible, messages.length]);\n    // 监听消息容器滚动 - 优化性能\n    (0, react_1.useEffect)(() => {\n        const container = messagesContainerRef.current;\n        if (!container || !isVisible)\n            return;\n        // 使用被动事件监听器提高滚动性能\n        container.addEventListener('scroll', handleScroll, { passive: true });\n        return () => {\n            container.removeEventListener('scroll', handleScroll);\n            if (scrollTimeoutRef.current) {\n                clearTimeout(scrollTimeoutRef.current);\n            }\n            if (userScrollTimeoutRef.current) {\n                clearTimeout(userScrollTimeoutRef.current);\n            }\n        };\n    }, [isVisible, handleScroll]);\n    // 当消息变化时，自动滚动到底部\n    (0, react_1.useEffect)(() => {\n        if (messages.length === 0)\n            return;\n        // 如果是用户发送的消息，强制滚动到底部\n        const lastMessage = messages[messages.length - 1];\n        if (lastMessage.role === 'user') {\n            setUserScrolledUp(false);\n            setIsUserActivelyScrolling(false);\n            // 延迟滚动确保 DOM 更新完成\n            setTimeout(() => scrollToBottom(true), 100);\n        }\n        else if (!userScrolledUp && !isUserActivelyScrolling) {\n            // 如果是 AI 回复且用户没有向上滚动且没有主动滚动，自动滚动\n            scrollToBottom();\n        }\n    }, [messages, userScrolledUp, isUserActivelyScrolling, scrollToBottom]);\n    // 当组件显示/隐藏时处理滚动\n    (0, react_1.useEffect)(() => {\n        if (isVisible && !userScrolledUp && !isUserActivelyScrolling) {\n            scrollToBottom();\n        }\n    }, [isVisible, userScrolledUp, isUserActivelyScrolling, scrollToBottom]);\n    // 当流式传输状态变化时，重置用户滚动状态\n    (0, react_1.useEffect)(() => {\n        if (!isStreaming) {\n            setIsUserActivelyScrolling(false);\n        }\n    }, [isStreaming]);\n    // 重置滚动状态\n    const resetScrollState = (0, react_1.useCallback)(() => {\n        setUserScrolledUp(false);\n        setIsUserActivelyScrolling(false);\n        scrollToBottom(true);\n    }, [scrollToBottom]);\n    return {\n        messagesContainerRef,\n        lastMessageRef,\n        userScrolledUp,\n        setUserScrolledUp,\n        scrollToBottom,\n        resetScrollState,\n    };\n};\nexports.useMessageScroll = useMessageScroll;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AIChat = void 0;\nvar AIChat_1 = require(\"./AIChat\");\nObject.defineProperty(exports, \"AIChat\", { enumerable: true, get: function () { return __importDefault(AIChat_1).default; } });\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAIChatService = void 0;\nconst react_1 = require(\"react\");\nconst messageUtils_1 = require(\"../utils/messageUtils\");\nconst useNetworkRequest_1 = require(\"./useNetworkRequest\");\n/**\n * AI 聊天服务 Hook\n * 处理与 AI 服务的交互，包括发送消息、处理响应等\n */\nconst useAIChatService = ({ formData, astrolabe, synastryAstrolabe, isSynastryMode = false, personNames = { person1: \"第一个人\", person2: \"第二个人\" }, onMessageUpdate, onMessagesChange, onLoadingChange, onGeneratingChange, onStreamingChange, onError, }) => {\n    const [isGenerating, setIsGenerating] = (0, react_1.useState)(false);\n    const abortControllerRef = (0, react_1.useRef)(null);\n    // 使用AI聊天请求Hook\n    const { sendChatRequest, isLoading: isNetworkLoading, error: networkError } = (0, useNetworkRequest_1.useAIChatRequest)();\n    // 提取公共的流式处理逻辑\n    const processStreamResponse = (0, react_1.useCallback)((response, existingMessages) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a;\n        // 处理流式响应\n        const reader = (_a = response.body) === null || _a === void 0 ? void 0 : _a.getReader();\n        const decoder = new TextDecoder();\n        let assistantMessageContent = \"\";\n        let buffer = \"\";\n        if (reader) {\n            // 通知开始流式传输\n            if (onStreamingChange) {\n                onStreamingChange(true);\n            }\n            try {\n                while (true) {\n                    const { done, value } = yield reader.read();\n                    if (done)\n                        break;\n                    const chunk = decoder.decode(value, { stream: true });\n                    const result = (0, messageUtils_1.processStreamChunk)(chunk, buffer, (newContent) => {\n                        assistantMessageContent += newContent;\n                        onMessageUpdate(assistantMessageContent);\n                    });\n                    buffer = result.newBuffer;\n                }\n            }\n            catch (error) {\n                // 如果是手动中止的错误，不显示错误消息\n                if (error instanceof Error && error.name === 'AbortError') {\n                    console.log('用户手动停止了生成');\n                    return { content: \"\", shouldUpdate: false };\n                }\n                throw error;\n            }\n            // 处理缓冲区中剩余的数据\n            buffer = (0, messageUtils_1.processRemainingBuffer)(buffer, (newContent) => {\n                assistantMessageContent += newContent;\n                onMessageUpdate(assistantMessageContent);\n            });\n            // 通知流式传输结束\n            if (onStreamingChange) {\n                onStreamingChange(false);\n            }\n        }\n        return { content: assistantMessageContent, shouldUpdate: true };\n    }), [onMessageUpdate, onStreamingChange]);\n    // 提取公共的AI服务调用逻辑\n    const callAIService = (0, react_1.useCallback)((messages) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a;\n        // 直接使用原始fetch方法，保持流式处理功能\n        const response = yield fetch(\"https://flow.ovo.gs/ai\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n                model: \"sydf-v1-250520\",\n                messages,\n                temperature: 0.7,\n            }),\n            signal: (_a = abortControllerRef.current) === null || _a === void 0 ? void 0 : _a.signal,\n        });\n        if (!response.ok) {\n            throw new Error(`AI 服务错误: ${response.status}`);\n        }\n        return response;\n    }), []);\n    // 提取公共的错误处理逻辑\n    const handleError = (0, react_1.useCallback)((error, userMessage, existingMessages) => {\n        var _a, _b;\n        console.error(\"发送消息时出错:\", error);\n        // 移除最后一条空消息并添加错误消息\n        const currentMessages = [...existingMessages];\n        if (((_a = currentMessages[currentMessages.length - 1]) === null || _a === void 0 ? void 0 : _a.role) === \"assistant\" &&\n            !((_b = currentMessages[currentMessages.length - 1]) === null || _b === void 0 ? void 0 : _b.content.trim())) {\n            currentMessages.pop();\n        }\n        const errorMessage = (0, messageUtils_1.createErrorMessage)(error);\n        currentMessages.push(errorMessage);\n        onMessagesChange(currentMessages);\n        onError(true, userMessage.content);\n    }, [onMessagesChange, onError]);\n    // 发送消息到 AI 服务\n    const sendMessage = (0, react_1.useCallback)((userMessage, existingMessages) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!userMessage.content.trim())\n            return;\n        onLoadingChange(true);\n        setIsGenerating(true);\n        onError(false);\n        try {\n            // 创建新的 AbortController\n            abortControllerRef.current = new AbortController();\n            // 添加一个空的助手消息用于流式更新（用户消息已经在 existingMessages 中）\n            const assistantMessage = { role: \"assistant\", content: \"\" };\n            const updatedMessages = [...existingMessages, assistantMessage];\n            onMessagesChange(updatedMessages);\n            // 构建系统提示\n            const systemPrompt = (0, messageUtils_1.buildSystemPrompt)(formData, astrolabe !== null && astrolabe !== void 0 ? astrolabe : null, synastryAstrolabe !== null && synastryAstrolabe !== void 0 ? synastryAstrolabe : null, isSynastryMode, personNames);\n            // 构建发送给AI的消息数组\n            const aiMessages = (0, messageUtils_1.buildAIMessages)(systemPrompt, existingMessages, userMessage);\n            // 调用 AI 服务\n            const response = yield callAIService(aiMessages);\n            // 处理流式响应\n            const { content: assistantMessageContent, shouldUpdate } = yield processStreamResponse(response, existingMessages);\n            // 更新最终消息（用户消息已经在 existingMessages 中）\n            if (shouldUpdate && assistantMessageContent.trim()) {\n                const finalMessages = [...existingMessages, {\n                        role: \"assistant\",\n                        content: assistantMessageContent\n                    }];\n                onMessagesChange(finalMessages);\n            }\n            else {\n                // 如果没有内容，移除空消息\n                onMessagesChange(existingMessages);\n            }\n        }\n        catch (error) {\n            handleError(error, userMessage, existingMessages);\n        }\n        finally {\n            onLoadingChange(false);\n            setIsGenerating(false);\n        }\n    }), [\n        astrolabe,\n        synastryAstrolabe,\n        isSynastryMode,\n        personNames,\n        onLoadingChange,\n        onError,\n        callAIService,\n        processStreamResponse,\n        handleError,\n        onMessagesChange,\n    ]);\n    // 重新生成失败的回复\n    const regenerateResponse = (0, react_1.useCallback)((failedMessage, existingMessages) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!failedMessage.trim())\n            return;\n        onError(false);\n        onLoadingChange(true);\n        setIsGenerating(true);\n        try {\n            // 创建新的 AbortController\n            abortControllerRef.current = new AbortController();\n            // 添加一个空的助手消息用于流式更新（用户消息已经在 existingMessages 中）\n            const assistantMessage = { role: \"assistant\", content: \"\" };\n            const updatedMessages = [...existingMessages, assistantMessage];\n            onMessagesChange(updatedMessages);\n            // 构建系统提示\n            const systemPrompt = (0, messageUtils_1.buildSystemPrompt)(formData, astrolabe !== null && astrolabe !== void 0 ? astrolabe : null, synastryAstrolabe !== null && synastryAstrolabe !== void 0 ? synastryAstrolabe : null, isSynastryMode, personNames);\n            // 构建发送给AI的消息数组（排除最后一条失败的助手消息）\n            const messagesWithoutLastAssistant = existingMessages.filter(msg => !(msg.role === \"assistant\" && msg === existingMessages[existingMessages.length - 1]));\n            const aiMessages = [\n                { role: \"system\", content: systemPrompt },\n                ...messagesWithoutLastAssistant,\n                { role: \"user\", content: failedMessage }\n            ];\n            // 调用 AI 服务\n            const response = yield callAIService(aiMessages);\n            // 处理流式响应\n            const { content: assistantMessageContent, shouldUpdate } = yield processStreamResponse(response, existingMessages);\n            // 更新最终消息（用户消息已经在 messagesWithoutLastAssistant 中）\n            if (shouldUpdate && assistantMessageContent.trim()) {\n                const finalMessages = [...messagesWithoutLastAssistant, {\n                        role: \"assistant\",\n                        content: assistantMessageContent\n                    }];\n                onMessagesChange(finalMessages);\n            }\n            else {\n                // 如果没有内容，恢复原始消息\n                onMessagesChange(existingMessages);\n            }\n        }\n        catch (error) {\n            console.error(\"重新生成消息时出错:\", error);\n            // 恢复原始消息并添加错误消息\n            const errorMessage = (0, messageUtils_1.createErrorMessage)(error);\n            const finalMessages = [...existingMessages, errorMessage];\n            onMessagesChange(finalMessages);\n            onError(true, failedMessage);\n        }\n        finally {\n            onLoadingChange(false);\n            setIsGenerating(false);\n        }\n    }), [\n        astrolabe,\n        synastryAstrolabe,\n        isSynastryMode,\n        personNames,\n        onError,\n        onLoadingChange,\n        callAIService,\n        processStreamResponse,\n        onMessagesChange,\n    ]);\n    // 停止生成\n    const stopGeneration = (0, react_1.useCallback)(() => {\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n            abortControllerRef.current = null;\n        }\n        setIsGenerating(false);\n        onGeneratingChange(false);\n        onLoadingChange(false);\n    }, [onGeneratingChange, onLoadingChange]);\n    return {\n        isGenerating,\n        sendMessage,\n        regenerateResponse,\n        stopGeneration,\n    };\n};\nexports.useAIChatService = useAIChatService;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.questionCategories = exports.synastryQuickActions = exports.quickActions = void 0;\n// 快捷操作按钮的数据结构\nexports.quickActions = [\n    {\n        id: \"astro-analysis\",\n        name: \"命盘分析\",\n        prompt: \"请对我的紫微斗数星盘进行全面而深入的专业分析，包括：\\n1. 命宫与身宫：深度解读命宫和身宫的主星、辅星组合，分析我的先天性格、后天发展、核心优势与潜在挑战。\\n2. 十二宫位概览：逐一解析命宫、兄弟宫、夫妻宫、子女宫、财帛宫、疾厄宫、迁移宫、交友宫(奴仆宫)、事业宫(官禄宫)、田宅宫、福德宫、父母宫的星曜组合，揭示各个人生领域的状况。\\n3. 核心星曜解读：重点分析我命盘中全部14颗主星（紫微、天机、太阳、武曲、天同、廉贞、天府、太阴、贪狼、巨门、天相、天梁、七杀、破军）的庙旺利陷和影响力。\\n4. 格局分析：识别并解释我命盘中存在的特殊格局（如杀破狼、紫府同宫、机月同梁等），并阐述其对人生的整体影响。\\n5. 四化星体系：详细解释本命四化（化禄、化权、化科、化忌）在命盘中的具体体现，并分析大运和流年的飞星四化对我运势的动态影响。\\n6. 三方四正与两夹：分析命宫、财帛宫、事业宫的三方四正关系，以及命宫的两邻宫（兄弟宫、父母宫）对其的辅助或制约作用，揭示我的人生发展主线。\\n7. 空宫分析：如果命盘中存在无主星的空宫，请分析其借对宫星曜后的意义和影响。\\n8. 大运与流年：结合当前大运和流年运势，分析我当前所处的人生阶段和未来一年的发展趋势。\\n9. 综合建议：基于以上分析，为我提供趋吉避凶的人生规划建议和发展方向指导。\"\n    },\n    {\n        id: \"career-finance\",\n        name: \"事业财运\",\n        prompt: \"请从紫微斗数的角度，对我一生的事业发展和财富格局进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **命格与职业方向**：结合我的命宫、身宫，分析我的性格天赋、能力倾向，推荐最能发挥我潜能的行业与职业道路。\\n2. **事业宫（官禄宫）**：深度解读此宫的星曜组合、四化和格局，判断我的事业成就高度、工作环境、领导能力以及是否适合创业。\\n3. **财帛宫**：详批此宫的星曜，揭示我的理财观念、赚钱能力、财富规模以及正财与偏财的比例。\\n4. **迁移宫**：分析此宫对我事业的影响，判断我是否适合向外发展、变动工作，以及在外的人缘和机遇。\\n5. **福德宫与田宅宫**：探究福德宫所显示的财富观念、享受层次，以及田宅宫所代表的资产积累能力和家业兴衰。\\n6. **动态运势**：结合我当前所处的大运、流年，详论近十年及未来一年的事业和财运起伏、关键机遇和挑战，并指出需要特别注意的年份。\\n7. **人际资源**：分析交友宫（奴仆宫）、父母宫和兄弟宫，判断我的事业贵人、合作伙伴、得力下属以及可能带来麻烦的小人。\\n8. **风险与对策**：明确指出我命盘中在事业和财务上的主要风险点（如化忌、煞星的冲击），并提供趋吉避凶的策略和建议。\"\n    },\n    {\n        id: \"love-marriage\",\n        name: \"感情婚姻\",\n        prompt: \"请从紫微斗数的角度，对我一生的感情世界与婚姻生活进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **感情性格与模式**：结合我的命宫、福德宫和疾厄宫，深度分析我的感情观、恋爱模式、真实情感需求以及在亲密关系中的表现。\\n2. **夫妻宫**：详批此宫的星曜组合、四化和格局，揭示我的择偶标准、正缘或配偶的详细特征（性格、外貌、职业等），以及婚姻生活的整体质量。\\n3. **桃花与情缘**：全面分析命盘中的桃花星（如红鸾、天喜、咸池、天姚、廉贞、贪狼），判断我此生的桃花运旺衰、情缘深浅以及烂桃花的风险。\\n4. **感情的动态演变**：结合我当前所处的大运、流年，详论近十年及未来一年的感情运势起伏，预测可能的恋爱、结婚、或感情波动的时间点。\\n5. **婚姻的挑战与维系**：分析夫妻宫的三方四正及煞忌影响，揭示婚姻中可能出现的潜在问题、冲突点以及第三方介入的风险。\\n6. **子女与家庭**：通过子女宫和田宅宫，分析与子女的缘分、亲子关系，以及婚后家庭生活的氛围。\\n7. **趋吉避凶**：基于以上所有分析，为我提供提升感情运、选择合适伴侣、以及维系婚姻关系的具体、可操作的建议。\"\n    },\n    {\n        id: \"academic-exam\",\n        name: \"学业考试\",\n        prompt: \"请从紫微斗数的角度，对我一生的学业发展和考试运势进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **学习天赋与智慧**：结合命宫、父母宫和福德宫，分析我的先天学习能力、逻辑思维、记忆力和智慧层次。\\n2. **科甲星曜**：深度解读文昌、文曲、化科、天才、龙池、凤阁等星曜在我命盘中的作用，判断我的学历高低和考试才能。\\n3. **学业与事业宫**：分析事业宫（官禄宫）的星曜组合，判断学业对我事业的实际助益，以及我是否能学以致用。\\n4. **适合的专业方向**：基于整体星盘的五行和星性，推荐最适合我攻读的学科领域和专业方向。\\n5. **学业运势起伏**：结合大运和流年，分析我学业运势的高峰与低谷，指出考研、考公、升学等关键机会的有利年份。\\n6. **学习策略建议**：根据我的命盘特点，提供最适合我的学习方法、备考策略和提升专注力的建议。\"\n    },\n    {\n        id: \"health-status\",\n        name: \"健康\",\n        prompt: \"请从紫微斗数的角度，对我一生的健康状况和养生之道进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **疾厄宫**：深度解读此宫的星曜、四化和煞曜，揭示我先天的体质强弱、遗传倾向以及最需要注意的身体器官。\\n2. **命宫与身宫**：分析命宫和身宫的星曜组合，判断我总体的生命力、抵抗力以及对疾病的承受和恢复能力。\\n3. **潜在病灶**：根据星盘中煞忌星曜（特别是擎羊、陀罗、火星、铃星、化忌）的落点，分析我一生中最容易出现的健康问题和疾病类型（包括生理和心理层面）。\\n4. **健康运势演变**：结合大运和流年，分析我健康运势的起伏，预警需要特别注意保养或可能发生意外、手术的年份。\\n5. **心理与情绪健康**：通过福德宫和疾厄宫的关联，分析我的精神状态、压力承受能力和常见的情绪困扰。\\n6. **养生与保健**：基于我的命盘体质，提供个性化的养生建议，包括饮食、运动、作息以及情绪疏导等趋吉避凶的方法。\"\n    },\n    {\n        id: \"fortune-analysis\",\n        name: \"运势\",\n        prompt: \"请从紫微斗数的角度，对我当前及未来的整体运势进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **十年大运**：深度解读我当前所处大运的宫位、星曜和四化，论断这十年总体的机遇、挑战和人生主题。\\n2. **流年详批**：详细分析今年的流年命宫、流年十二宫的状况，以及流年四化对我本命盘的冲击，具体到事业、财运、感情、健康等各方面的吉凶变化。\\n3. **关键机遇与挑战**：明确指出在当前大运和流年中，我最值得把握的机遇在哪个领域（例如，是事业突破，还是财富增长，或是感情开花结果），以及最需要防范的风险是什么。\\n4. **流月运势简析**：简要分析未来几个月的运势走向，并提示哪几个月是关键的转折点。\\n5. **趋吉避凶**：针对当前运势中的不利因素（如流年化忌、煞星），提供具体、可操作的化解和应对策略，帮助我趋吉避凶，顺势而为。\"\n    },\n    {\n        id: \"interpersonal\",\n        name: \"人际\",\n        prompt: \"请对我的人际关系进行专业的紫微斗数分析，包括：\\n1. 交友宫(奴仆宫)分析：分析交友宫的星曜配置，揭示我与朋友、同事、下属的相处模式和人际关系质量。\\n2. 兄弟宫分析：分析兄弟宫的星曜，判断我与同辈、挚友、兄弟姐妹的关系深浅。\\n3. 社交特质：结合命宫与迁移宫，分析我的性格特点在社交场合中的表现和给人的第一印象。\\n4. 贵人与小人：分析命盘中的贵人星（如天魁、天钺）和小人星（如擎羊、陀罗、化忌），判断贵人方向和小人来源。\\n5. 人际网络质量：综合交友宫和兄弟宫，评估我社交圈的特点、人脉质量和广度。\\n6. 沟通模式：分析巨门、文昌、文曲等星曜，判断我的沟通风格、表达能力和说服力。\\n7. 人际冲突：识别交友宫或兄弟宫的煞忌组合，分析人际冲突的根源和处理方式。\\n8. 改善建议：提供拓展人脉、改善特定人际关系（如与上司、同事）的实用技巧。\"\n    },\n    {\n        id: \"family-relations\",\n        name: \"家庭\",\n        prompt: \"请从紫微斗数的角度，对我一生的家庭状况和人伦关系进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **原生家庭与父母**：深度解读父母宫，分析我与父母的缘分深浅、相处模式，以及原生家庭对我性格和命运的深远影响。\\n2. **兄弟手足情谊**：分析兄弟宫，判断我与兄弟姐妹、闺蜜或核心合作伙伴的关系质量和互动模式。\\n3. **婚姻与配偶**：结合夫妻宫，论断我的婚姻生活、与配偶的相处方式，以及对方家庭对我的影响。\\n4. **子女缘分与教育**：详批子女宫，判断我与子女的缘分、亲子互动模式，以及对子女的教育方式和他们的未来发展。\\n5. **家宅与资产**：分析田宅宫，判断我的居住环境、家庭氛围、不动产运势以及家族的兴旺程度。\\n6. **家庭关系的动态**：结合大运和流年，分析当前家庭关系的焦点、潜在的矛盾以及重要的家庭事件（如添丁、搬家等）。\\n7. **改善之道**：针对家庭关系中可能存在的挑战，提供增进和谐、改善沟通的具体建议。\"\n    },\n    {\n        id: \"psychology-personality\",\n        name: \"心性\",\n        prompt: \"请从紫微斗数的角度，对我的人格特质与精神世界进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **表里人格**：深度解读命宫和身宫的组合，分析我外在表现（身）与内在真实自我（命）的异同，揭示我的人格核心。\\n2. **精神世界与价值观**：详批福德宫，揭示我的思想深度、精神追求、兴趣爱好、人生观和幸福感的来源。\\n3. **情绪与潜意识**：分析疾厄宫，判断我的情绪处理机制、抗压能力，以及潜意识中隐藏的焦虑或恐惧。\\n4. **思维与智慧**：结合命宫、福德宫以及文昌、文曲等智慧星曜，分析我的思维模式、决策风格和学习能力。\\n5. **性格优势与劣势**：全面总结我的性格优点和潜能，同时毫不避讳地指出我需要面对和修炼的人生课题与性格弱点。\\n6. **个人成长建议**：基于命盘的整体格局，为我提供扬长避短、提升心性、实现更高层次自我价值的具体修行建议。\"\n    },\n    {\n        id: \"yearly-prediction\",\n        name: \"流年\",\n        prompt: \"请从紫微斗数的角度，为我详批未来一年的流年运势，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **流年总论**：分析流年命宫、身宫的星曜和四化，对我未来一年的整体状态、机遇和挑战下一个总论。\\n2. **事业财运**：详批流年事业宫和财帛宫，预测工作上的变动、升迁机遇，以及财运的起伏和重大开销。\\n3. **感情人际**：详批流年夫妻宫和交友宫，预测感情生活的发展、新人出现的时机，以及人际关系的变化。\\n4. **健康安全**：详批流年疾厄宫和迁移宫，预警需要注意的健康问题和外出安全事宜。\\n5. **流月运势**：点出未来12个月中，运势最好和最需要注意的月份，并简要说明原因。\\n6. **年度规划建议**：根据流年运势，为我提供趋吉避凶的年度规划建议。\"\n    },\n    {\n        id: \"resolution-suggestions\",\n        name: \"建议\",\n        prompt: \"请从紫微斗数的角度，针对我命盘和当前运势中的主要挑战，提供一份全面、深入、可操作的趋吉避凶策略，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **核心挑战识别**：精准定位我命盘（本命、大运、流年）中最核心的不利因素，例如最凶的化忌在何宫、最需要注意的煞星组合是什么。\\n2. **问题根源剖析**：分析这些不利因素所代表的人生课题，揭示其在性格、行为、运势等方面的具体表现。\\n3. **分领域化解**：针对事业、财运、感情、健康等不同领域，提供具体的化解或改善建议。\\n4. **“因果”层面的建议**：从事理、心性层面，提出能从根本上调整命运的修身养性之道（例如，针对特定星曜组合的性格优化建议）。\\n5. **“时空”层面的建议**：在行为、风水、人际交往等方面，提供可以实际操作的趋吉避凶方法（例如，在特定年份应避免的决策，适合交往的人，有利的方位颜色等）。\\n6. **关键时机提醒**：明确指出未来几年中，哪些年份是改运和提升的关键期，应该如何把握。\"\n    },\n    {\n        id: \"life-planning\",\n        name: \"规划\",\n        prompt: \"请从紫微斗数的角度，为我提供一份全面、深入、贯穿一生的人生战略规划，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\\n1. **人生定位与使命**：综合全盘，提炼我此生的核心人生课题与最终可以达成的生命格局，为我的人生进行战略定位。\\n2. **大运详批**：逐一分析我从今往后的每一个十年大运，揭示每个阶段的人生主题、发展机遇、主要挑战和应该采取的核心策略。\\n3. **事业蓝图**：规划我的长期事业发展路径，预测可能的事业高峰期，并对创业、跳槽等重大决策提供时机建议。\\n4. **财富蓝图**：规划我的财富积累路径，包括适合的求财方式、投资策略，以及实现财务自由的可能性。\\n5. **感情与家庭蓝图**：规划我的感情发展路径，包括正缘出现、结婚的有利时机，以及家庭生活的经营策略。\\n6. **风险管控**：明确指出我人生各阶段（特别是重要大运、流年）需要防范的主要风险（事业、财务、感情、健康等），并提供相应的规避和化解方案。\\n7. **行动指南**：将宏大的人生规划落实到当前，为我未来一年的具体行动提供清晰、可操作的指引。\"\n    }\n];\n// 合盘模式下的快捷操作按钮\nexports.synastryQuickActions = [\n    {\n        id: \"friendship-compatibility\",\n        name: \"交友\",\n        prompt: `请从紫微斗数的角度，对{person1}和{person2}的交友缘分进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\n1. **性格与磁场**：对比双方命宫、福德宫，判断两人性格是否投缘，气场是否相合。\n2. **交友宫互动**：分析一方的交友宫（奴仆宫）星曜，是否为另一方命宫所喜，判断关系的初始吸引力。\n3. **缘分类型（飞星）**：通过分析一方交友宫宫干的飞星四化对另一方命盘的影响，判断这段友谊是益友还是损友，是贵人还是过客。\n4. **长期与短期关系**：结合兄弟宫（代表深交、同辈）和交友宫（代表广泛、普通朋友），判断这段友谊适合长期深交还是短期共事。\n5. **潜在的冲突**：识别双方命盘中可能导致友谊破裂的煞忌组合，预警潜在的矛盾点。\n6. **综合建议**：为如何维系和发展这段友谊提供具体建议。`\n    },\n    {\n        id: \"love-compatibility\",\n        name: \"恋爱\",\n        prompt: `请对{person1}和{person2}的恋爱合盘进行专业的紫微斗数分析，包括：\n1. 命宫与夫妻宫匹配：分析双方命宫主星的性格是否融洽，以及一方的夫妻宫星曜是否是另一方喜欢的类型。\n2. 感情观与需求对比：比较双方的感情特质、恋爱模式和情感需求的异同。\n3. 宫位互动分析（飞星）：分析一方的命宫、夫妻宫宫干，对另一方命盘相应宫位产生的飞星四化影响，判断互动的吉凶。\n4. 吸引力与化学反应：基于星盘的桃花星曜和五行生克，分析两人之间的核心吸引力。\n5. 沟通与冲突：比较两人的沟通风格，并从疾厄宫、交友宫的煞忌情况，分析潜在的冲突点。\n6. 感情挑战：识别两人星盘中可能对关系造成负面影响的星曜组合（如孤辰、寡宿，或夫妻宫的煞忌）。\n7. 关系走向：结合双方当前的大运和流年，分析这段关系在近期的发展趋势和关键节点。\n8. 综合建议：基于以上分析，提供促进恋爱关系发展的具体建议。`\n    },\n    {\n        id: \"marriage-compatibility\",\n        name: \"合婚\",\n        prompt: `请对{person1}和{person2}的婚姻缘分进行一次全面、深入的紫微斗数合盘分析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\n1. **核心性格与价值观匹配**：深度对比两人的命宫、身宫、福德宫，判断其性格、人生追求和核心价值观是否能够琴瑟和鸣。\n2. **夫妻宫的相互吸引**：分析一方的夫妻宫星曜，是否为另一方的命宫星曜所喜；同时，判断一方的命宫星曜，是否能满足另一方夫妻宫的要求。\n3. **缘分的深度与类型（飞星四化）**：以双方的命宫、夫妻宫宫干，用飞星四化看其如何影响对方的命盘。重点分析禄、权、科、忌分别飞入对方何宫，以此判断双方是善缘、恶缘，还是债主、贵人关系。\n4. **宫位重叠的宿命连结**：检查双方是否存在关键的宫位重叠（例如，A的命宫是B的夫妻宫，A的财帛宫是B的事业宫等），并深度解读这些重叠所带来的特殊缘分和互动模式。\n5. **现实层面的和谐度**：对比双方的财帛宫、事业宫、田宅宫、子女宫，评估两人在金钱观、事业追求、家庭观念和子女教育上的一致性与互补性。\n6. **潜在的冲突与危机**：识别并分析双方星盘中所有可能对婚姻造成冲击的煞忌组合，以及运势不同步可能带来的挑战。\n7. **综合论断与建议**：综合以上所有信息，对这段姻缘的最终匹配度下一个结论，并为如何促进关系和谐、化解潜在矛盾提供具体、可行的建议。`\n    },\n    {\n        id: \"business-partnership\",\n        name: \"合伙\",\n        prompt: `请对{person1}和{person2}的合伙合盘进行专业的紫微斗数分析，包括：\n1. 事业与财富匹配：分析双方事业宫、财帛宫的星曜组合，判断能力是否互补，财富目标是否一致。\n2. 性格与决策模式：分析双方的性格、决策风格和执行力的互补性。\n3. 宫位互动分析（飞星）：分析一方的事业宫、财帛宫宫干，对另一方命盘产生的飞星四化影响，判断合作的吉凶互动。\n4. 责任与权力：从星盘中断定双方在合作中适合扮演的角色（例如，谁主外，谁主内；谁是决策者，谁是执行者）。\n5. 运势同步性：比较两人未来十年的事业及财富大运走势，判断合作的黄金时期和需要谨慎的阶段。\n6. 潜在冲突：识别可能导致合作破裂的星盘因素（如财帛宫、交友宫的煞忌），并预警潜在的利益纠纷。\n7. 长期发展：评估两人星盘组合的长期稳定性与发展潜力。\n8. 综合建议：基于以上分析，提供促进合作成功的具体建议、权责划分方案和注意事项。`\n    },\n    {\n        id: \"family-harmony\",\n        name: \"家庭\",\n        prompt: `请从紫微斗数的角度，对{person1}和{person2}的家庭关系（如亲子、婆媳、兄弟姐妹等）进行一次全面、深入的剖析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\n1. **基本缘分**：对比双方的命宫、福德宫，判断两人基本的性格和价值观是否融洽。\n2. **关系定位**：根据双方在家庭中的角色（如父子、母女），重点分析相应的宫位（如父母宫、子女宫）的互动关系。\n3. **互动模式（飞星）**：通过分析一方相关宫位（如父母宫）的飞星四化对另一方命盘的影响，判断两人之间是关爱、扶持，还是冲突、疏离。\n4. **宫位重叠**：检查是否存在特殊的宫位重叠（如一方的命宫是另一方的子女宫），并解读其特殊的家庭联结。\n5. **潜在矛盾**：识别双方星盘中可能导致家庭矛盾的煞忌组合，并指出问题的根源。\n6. **和谐之道**：为改善这段家庭关系，促进家庭和谐，提供具体、可行的建议。`\n    },\n    {\n        id: \"communication-style\",\n        name: \"沟通\",\n        prompt: `请从紫微斗数的角度，对{person1}和{person2}的沟通模式进行一次全面、深入的合盘分析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\n1. **沟通星曜**：重点分析双方命盘中的巨门、文昌、文曲、化科、化忌等星曜，判断各自的沟通风格、表达能力和逻辑性。\n2. **思维方式**：对比双方的命宫、福德宫，分析两人思维模式的异同，是从宏观还是微观思考，是感性还是理性主导。\n3. **互动模式（飞星）**：通过分析一方命宫或福德宫的飞星四化对另一方命盘的影响，判断两人的沟通是有效、有益，还是会产生误解和冲突。\n4. **冲突根源**：识别双方星盘中导致沟通不畅的星曜组合，揭示争吵和误解的深层原因。\n5. **改善建议**：针对两人的沟通特点，提供如何有效沟通、避免冲突、增进理解的具体策略。`\n    },\n    {\n        id: \"life-path\",\n        name: \"人生\",\n        prompt: `请从紫微斗数的角度，对{person1}和{person2}的人生道路进行一次全面、深入的合盘分析，无需拘泥于形式，但求深刻洞见。请重点分析但不限于以下方面：\n1. **人生格局与方向**：对比双方的命宫、身宫和整体格局，判断两人的人生追求、生命层次和最终发展方向是否一致。\n2. **大运同步性**：详细对比两人未来数个十年大运的走势，分析其人生高峰与低谷是否同步，能否在关键时期相互扶持。\n3. **宫位互动与影响**：通过飞星四化和宫位重叠技术，分析两人在人生重大领域（如事业、财富、家庭）的深层互动和相互影响。\n4. **共同的课题与挑战**：识别两人命盘中共有的弱点或挑战，揭示他们需要共同面对和修行的人生课题。\n5. **互为贵人或阻碍**：判断两人在人生旅途上是互为贵人、相互成就，还是会成为彼此的阻碍和消耗。\n6. **共同发展建议**：基于以上分析，为两人如何协调人生步调、实现共同成长提供战略性建议。`\n    }\n];\n// 预设问题数据结构\nexports.questionCategories = [\n    {\n        name: \"感情\",\n        subCategories: [\n            { name: \"情感发展\", questions: [\"我近期的桃花运怎么样？\", \"我们目前的感情走向如何？\", \"他/她对我的真实情感是什么？\", \"我们之间有未来吗？\", \"如何改善我们目前的关系？\", \"这段感情对我的影响？\", \"我该如何表达我的感情？\", \"我们的感情会遇到什么考验？\"] },\n            { name: \"正缘婚姻\", questions: [\"我的正缘什么时候出现？\", \"我的另一半是什么样的人？\", \"我何时会结婚？\", \"我适合和现在的对象结婚吗？\", \"我的婚姻生活会幸福吗？\", \"如何吸引我的正缘桃花？\", \"我的配偶会来自哪个方向？\", \"婚姻中需要注意什么问题？\"] },\n            { name: \"关系难题\", questions: [\"我们之间出了什么问题？\", \"如何解决现在的感情危机？\", \"我们有机会复合吗？\", \"我应该放弃这段感情吗？\", \"我和Ta的缘分有多深？\", \"我的灵魂伴侣有什么特征？\", \"如何处理感情中的第三者？\", \"如何应对感情中的欺骗？\"] },\n            { name: \"恋爱技巧\", questions: [\"如何提高我的恋爱成功率？\", \"我该如何追求喜欢的人？\", \"如何让感情保持新鲜感？\", \"恋爱中如何保持自我？\", \"如何判断对方是否真心？\", \"如何处理异地恋？\", \"恋爱中如何避免争吵？\", \"如何提升我的魅力值？\"] },\n            { name: \"分手挽回\", questions: [\"分手后还能复合吗？\", \"如何有效挽回前任？\", \"分手是我做错了吗？\", \"什么时候是挽回的最佳时机？\", \"分手后如何调整心态？\", \"如何判断是否值得挽回？\", \"分手后还能做朋友吗？\", \"如何避免再次失恋？\"] },\n        ],\n    },\n    {\n        name: \"事业\",\n        subCategories: [\n            { name: \"事业发展\", questions: [\"我适合现在的工作/行业吗？\", \"我的事业什么时候能成功？\", \"我适合跳槽还是继续坚守？\", \"我事业上的贵人会是谁？\", \"我未来的事业走向怎么样？\", \"我什么时候能找到如意的工作？\", \"我的事业瓶颈期在什么时候？\", \"如何突破事业发展的困境？\"] },\n            { name: \"职场机遇\", questions: [\"我今年有机会升职加薪吗？\", \"如何得到领导的赏识和重用？\", \"我在公司的发展前景如何？\", \"如何改善当前的工作状态？\", \"我最近的职场人际运如何？\", \"什么时候是换工作的好时机？\", \"我适合独立工作还是团队合作？\", \"如何在职场中脱颖而出？\"] },\n            { name: \"创业之路\", questions: [\"我适合创业吗？\", \"我的创业最佳时机是什么时候？\", \"我该和什么样的人合作？\", \"我的创业项目前景如何？\", \"创业过程中需要注意哪些风险？\", \"我的创业会成功吗？\", \"我适合什么类型的创业？\", \"如何解决创业初期的资金问题？\"] },\n            { name: \"职场沟通\", questions: [\"如何与难相处的同事相处？\", \"我该如何向领导提出建议？\", \"如何在会议中有效表达？\", \"如何处理职场中的冲突？\", \"如何建立良好的职场形象？\", \"如何拒绝不合理的工作要求？\", \"如何进行有效的绩效谈判？\", \"如何提升我的职场说服力？\"] },\n            { name: \"团队管理\", questions: [\"我适合做管理岗位吗？\", \"如何有效激励团队成员？\", \"如何处理团队内部矛盾？\", \"如何提升团队的执行力？\", \"我适合带领什么样的团队？\", \"如何培养团队的核心竞争力？\", \"如何在管理中保持权威？\", \"如何处理团队中的问题员工？\"] },\n        ],\n    },\n    {\n        name: \"财富\",\n        subCategories: [\n            { name: \"财运趋势\", questions: [\"我近期的财运怎么样？\", \"我这辈子财运的整体趋势？\", \"我什么时候能发财？\", \"我适合靠什么方式赚钱？\", \"如何有效提升我的财运？\", \"我近期会有意外之财吗？\", \"我的财运高峰期在什么时候？\", \"如何避免财运波动的影响？\"] },\n            { name: \"投资理财\", questions: [\"我适合做投资吗？\", \"我应该选择什么样的投资方向？\", \"这个投资项目能赚钱吗？\", \"如何才能守住我的财富？\", \"我的投资风险大吗？\", \"如何更好地管理我的财富？\", \"我适合股票还是基金投资？\", \"如何制定长期理财计划？\"] },\n            { name: \"财务状况\", questions: [\"我为什么总是存不住钱？\", \"是什么原因导致我财务紧张？\", \"我最近会有破财风险吗？\", \"如何避免不必要的财务损失？\", \"我需要注意哪些年份的破财？\", \"我该如何处理我的债务问题？\", \"如何建立良好的财务习惯？\", \"我的收入什么时候能增加？\"] },\n            { name: \"债务处理\", questions: [\"我该如何处理现有债务？\", \"什么时候能还清所有债务？\", \"我适合贷款投资吗？\", \"如何避免陷入债务危机？\", \"债务会对我的生活产生什么影响？\", \"如何与债权人协商？\", \"我适合做担保人吗？\", \"如何重建信用记录？\"] },\n            { name: \"购房决策\", questions: [\"我现在适合买房吗？\", \"买房还是租房更适合我？\", \"我该在哪个城市买房？\", \"购房的最佳时机是什么时候？\", \"我适合买什么类型的房子？\", \"如何选择有升值潜力的房产？\", \"贷款买房有什么风险？\", \"如何处理房产投资中的纠纷？\"] },\n        ],\n    },\n    {\n        name: \"人际\",\n        subCategories: [\n            { name: \"社交模式\", questions: [\"我的人际交往模式有何优缺点？\", \"如何拓展我的高质量社交圈？\", \"我目前的人际关系状态如何？\", \"我会吸引哪些人进入我的生活？\", \"如何获得他人的信任与支持？\", \"如何处理与朋友的矛盾？\", \"我适合什么样的社交场合？\", \"如何提升我的社交魅力？\"] },\n            { name: \"贵人善缘\", questions: [\"什么样的朋友是我的贵人？\", \"我应该远离什么样的朋友？\", \"如何结交更多志同道合的朋友？\", \"我该如何维系重要的友谊？\", \"我该信任我身边的朋友吗？\", \"如何获得领导或长辈的赏识？\", \"我的贵人会在什么时候出现？\", \"如何识别真正的贵人？\"] },\n            { name: \"职场人际\", questions: [\"如何与难相处的上司相处？\", \"我在职场中的人际关系如何？\", \"如何处理同事间的竞争关系？\", \"如何在职场中建立人脉？\", \"我适合什么样的工作环境？\", \"如何应对职场中的排挤？\", \"如何获得同事的认可？\", \"职场中如何保持适当的距离？\"] },\n            { name: \"社交技巧\", questions: [\"如何提高我的沟通能力？\", \"我该如何打破社交尴尬？\", \"如何在聚会中表现自然？\", \"如何与陌生人建立联系？\", \"如何进行有效的倾听？\", \"如何拒绝他人的不合理要求？\", \"如何提升我的说服力？\", \"如何处理社交中的冲突？\"] },\n            { name: \"冲突处理\", questions: [\"我该如何处理人际冲突？\", \"如何避免不必要的争论？\", \"如何化解与他人的误会？\", \"面对指责我该如何回应？\", \"如何处理家庭矛盾？\", \"如何在冲突中保持冷静？\", \"如何修复破裂的关系？\", \"如何设定健康的人际边界？\"] },\n        ],\n    },\n    {\n        name: \"人生\",\n        subCategories: [\n            { name: \"学业规划\", questions: [\"我的学业运势如何？\", \"我适合考研/考公吗？\", \"我适合继续深造还是工作？\", \"如何提升我的学习效率？\", \"我该选择哪个专业/学校？\", \"我这次考试能通过吗？\", \"我适合出国留学吗？\", \"如何克服学习中的困难？\"] },\n            { name: \"个人成长\", questions: [\"我的性格优势和劣势是什么？\", \"我的人生主要课题是什么？\", \"如何找到我的人生方向？\", \"如何克服我性格中的弱点？\", \"如何有效提升自己的能量状态？\", \"我的人生转折点在何时？\", \"如何建立自信？\", \"如何实现自我价值？\"] },\n            { name: \"人生机遇\", questions: [\"我未来十年的人生大运怎么样？\", \"我该如何实现我的人生目标？\", \"我的人生会有什么重大机遇？\", \"我应该注意哪些健康问题？\", \"如何才能活出更精彩的人生？\", \"未来的人生之路走向如何？\", \"我的人生贵人会在什么时候出现？\", \"如何把握人生中的重要机会？\"] },\n            { name: \"人生抉择\", questions: [\"我该如何做出重要的人生决定？\", \"我适合留在当前城市还是迁移？\", \"我该选择稳定还是挑战？\", \"如何判断一个机会是否值得把握？\", \"我的人生道路该如何选择？\", \"如何平衡工作与生活？\", \"我适合什么样的生活方式？\", \"如何面对人生的十字路口？\"] },\n            { name: \"目标设定\", questions: [\"如何设定适合我的人生目标？\", \"我该制定短期还是长期目标？\", \"如何确保目标的可实现性？\", \"如何分解大目标为小步骤？\", \"如何保持对目标的专注？\", \"如何调整不合适的目标？\", \"如何衡量目标的进展？\", \"如何应对目标实现中的挫折？\"] },\n            { name: \"时间管理\", questions: [\"如何提高我的时间利用效率？\", \"我该如何平衡各项事务？\", \"如何避免拖延症？\", \"如何制定有效的时间计划？\", \"如何处理突发事务的干扰？\", \"如何保证充足的休息时间？\", \"如何区分事务的优先级？\", \"如何在忙碌中保持生活质量？\"] },\n        ],\n    },\n    {\n        name: \"健康\",\n        subCategories: [\n            { name: \"健康状况\", questions: [\"我的整体健康状况如何？\", \"我容易患哪些疾病？\", \"我需要注意哪些健康问题？\", \"我的体质属于什么类型？\", \"如何提升我的免疫力？\", \"我最近会有健康风险吗？\", \"我的健康运势怎么样？\", \"如何预防常见疾病？\"] },\n            { name: \"养生保健\", questions: [\"我适合什么样的养生方式？\", \"如何根据季节调整养生方法？\", \"我该注意哪些饮食禁忌？\", \"如何改善我的睡眠质量？\", \"我适合什么类型的运动？\", \"如何缓解工作压力？\", \"如何进行有效的排毒？\", \"如何保持年轻态？\"] },\n            { name: \"疾病预防\", questions: [\"我该如何预防慢性疾病？\", \"哪些疾病我需要特别警惕？\", \"如何通过饮食预防疾病？\", \"我的身体哪些部位需要重点保养？\", \"如何避免亚健康状态？\", \"定期体检有必要吗？\", \"如何识别疾病的早期信号？\", \"如何建立健康的生活习惯？\"] },\n            { name: \"心理健康\", questions: [\"我的心理状态健康吗？\", \"如何缓解焦虑和压力？\", \"我该如何调节情绪？\", \"如何避免抑郁情绪？\", \"如何提升心理韧性？\", \"我适合什么样的减压方式？\", \"如何保持积极的心态？\", \"如何处理心理创伤？\"] },\n            { name: \"运动健身\", questions: [\"我适合什么类型的运动？\", \"如何制定科学的健身计划？\", \"运动时需要注意什么？\", \"如何避免运动损伤？\", \"我适合晨练还是晚练？\", \"如何坚持运动习惯？\", \"运动对我的健康有什么好处？\", \"如何选择适合的健身场所？\"] },\n        ],\n    },\n    {\n        name: \"家庭\",\n        subCategories: [\n            { name: \"家庭和谐\", questions: [\"我的家庭关系和谐吗？\", \"如何改善家庭氛围？\", \"我该如何处理家庭矛盾？\", \"如何增进家庭成员的感情？\", \"家庭中如何有效沟通？\", \"如何平衡家庭与工作？\", \"如何建立幸福的家庭？\", \"家庭对我的影响是什么？\"] },\n            { name: \"亲子关系\", questions: [\"我该如何教育孩子？\", \"如何与孩子建立良好关系？\", \"孩子的教育问题该如何处理？\", \"如何培养孩子的独立性？\", \"我适合什么样的教育方式？\", \"如何处理孩子的叛逆期？\", \"如何帮助孩子健康成长？\", \"如何平衡严格与宽容？\"] },\n            { name: \"婚姻生活\", questions: [\"我的婚姻生活幸福吗？\", \"如何保持婚姻的新鲜感？\", \"如何处理婚姻中的矛盾？\", \"我该如何与配偶沟通？\", \"如何平衡婚姻与个人空间？\", \"婚姻中需要避免什么问题？\", \"如何经营长久的婚姻？\", \"如何应对婚姻危机？\"] },\n            { name: \"老人赡养\", questions: [\"我该如何赡养老人？\", \"如何与老人和谐相处？\", \"老人的健康问题该如何处理？\", \"如何平衡工作与照顾老人？\", \"我适合什么样的养老方式？\", \"如何让老人安享晚年？\", \"如何处理老人的固执？\", \"如何关注老人的心理健康？\"] },\n            { name: \"家族关系\", questions: [\"我在家族中的地位如何？\", \"如何处理复杂的家族关系？\", \"家族对我的发展有什么影响？\", \"如何维护家族和谐？\", \"我该如何面对家族期望？\", \"如何处理家族财产问题？\", \"如何平衡小家庭与大家族？\", \"如何建立良好的家族声誉？\"] },\n        ],\n    },\n    {\n        name: \"运势\",\n        subCategories: [\n            { name: \"流年运势\", questions: [\"我今年的整体运势如何？\", \"今年的事业运势怎么样？\", \"今年的财运会有什么变化？\", \"今年的感情运势如何？\", \"今年的健康状况需要注意什么？\", \"今年我会有什么机遇？\", \"今年需要防范什么风险？\", \"如何把握今年的好运势？\"] },\n            { name: \"大运分析\", questions: [\"我当前的大运怎么样？\", \"这个大运会持续多久？\", \"大运期间我需要注意什么？\", \"如何把握大运的机遇？\", \"大运对事业有什么影响？\", \"大运对感情有什么影响？\", \"大运对健康有什么影响？\", \"如何顺利度过不利大运？\"] },\n            { name: \"时机选择\", questions: [\"什么时候是做重要决定的最佳时机？\", \"我什么时候适合换工作？\", \"什么时候适合投资创业？\", \"什么时候适合结婚？\", \"什么时候适合搬家？\", \"什么时候适合出国？\", \"什么时候适合开始新项目？\", \"如何识别有利时机？\"] },\n            { name: \"运势提升\", questions: [\"如何提升我的整体运势？\", \"什么方法可以改善我的运势？\", \"我适合佩戴什么吉祥物？\", \"如何通过风水改善运势？\", \"什么颜色对我的运势有利？\", \"什么方位对我的运势有帮助？\", \"如何通过行为改善运势？\", \"如何保持好运的持续性？\"] },\n            { name: \"风险预警\", questions: [\"我近期会遇到什么风险？\", \"哪些年份我需要特别注意？\", \"如何防范事业风险？\", \"如何防范财务风险？\", \"如何防范感情风险？\", \"如何防范健康风险？\", \"如何识别潜在的危险？\", \"如何应对突发的不利事件？\"] },\n        ],\n    },\n];\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Iztrolabe = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst Izpalace_1 = require(\"../Izpalace/Izpalace\");\nconst IzpalaceCenter_1 = require(\"../IzpalaceCenter\");\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst iztro_hook_1 = require(\"iztro-hook\");\nrequire(\"../styles/index.css\");\nconst astro_1 = require(\"iztro/lib/astro\");\nconst Iztrolabe = (props) => {\n    const [taichiPoint, setTaichiPoint] = (0, react_1.useState)(-1);\n    const [taichiPalaces, setTaichiPalaces] = (0, react_1.useState)();\n    const [activeHeavenlyStem, setActiveHeavenlyStem] = (0, react_1.useState)();\n    const [hoverHeavenlyStem, setHoverHeavenlyStem] = (0, react_1.useState)();\n    const [focusedIndex, setFocusedIndex] = (0, react_1.useState)();\n    const [showDecadal, setShowDecadal] = (0, react_1.useState)(false);\n    const [showYearly, setShowYearly] = (0, react_1.useState)(false);\n    const [showMonthly, setShowMonthly] = (0, react_1.useState)(false);\n    const [showDaily, setShowDaily] = (0, react_1.useState)(false);\n    const [showHourly, setShowShowHourly] = (0, react_1.useState)(false);\n    const [horoscopeDate, setHoroscopeDate] = (0, react_1.useState)();\n    const [horoscopeHour, setHoroscopeHour] = (0, react_1.useState)();\n    const { astrolabe, horoscope, setHoroscope } = (0, iztro_hook_1.useIztro)({\n        birthday: props.birthday,\n        birthTime: props.birthTime,\n        gender: props.gender,\n        birthdayType: props.birthdayType,\n        fixLeap: props.fixLeap,\n        isLeapMonth: props.isLeapMonth,\n        lang: props.lang,\n        astroType: props.astroType,\n        options: props.options,\n    });\n    const toggleShowScope = (scope) => {\n        switch (scope) {\n            case \"decadal\":\n                setShowDecadal(!showDecadal);\n                break;\n            case \"yearly\":\n                setShowYearly(!showYearly);\n                break;\n            case \"monthly\":\n                setShowMonthly(!showMonthly);\n                break;\n            case \"daily\":\n                setShowDaily(!showDaily);\n                break;\n            case \"hourly\":\n                setShowShowHourly(!showHourly);\n                break;\n        }\n    };\n    const toggleActiveHeavenlyStem = (heavenlyStem) => {\n        if (heavenlyStem === activeHeavenlyStem) {\n            setActiveHeavenlyStem(undefined);\n        }\n        else {\n            setActiveHeavenlyStem(heavenlyStem);\n        }\n    };\n    const dynamic = (0, react_1.useMemo)(() => {\n        if (showHourly) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.hourly.index,\n                arrowScope: \"hourly\",\n            };\n        }\n        if (showDaily) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.daily.index,\n                arrowScope: \"daily\",\n            };\n        }\n        if (showMonthly) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.monthly.index,\n                arrowScope: \"monthly\",\n            };\n        }\n        if (showYearly) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.index,\n                arrowScope: \"yearly\",\n            };\n        }\n        if (showDecadal) {\n            return {\n                arrowIndex: horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal.index,\n                arrowScope: \"decadal\",\n            };\n        }\n    }, [showDecadal, showYearly, showMonthly, showDaily, showHourly, horoscope]);\n    (0, react_1.useEffect)(() => {\n        var _a, _b;\n        setHoroscopeDate((_a = props.horoscopeDate) !== null && _a !== void 0 ? _a : new Date());\n        setHoroscopeHour((_b = props.horoscopeHour) !== null && _b !== void 0 ? _b : 0);\n    }, [props.horoscopeDate, props.horoscopeHour]);\n    (0, react_1.useEffect)(() => {\n        setHoroscope(horoscopeDate !== null && horoscopeDate !== void 0 ? horoscopeDate : new Date(), horoscopeHour);\n    }, [horoscopeDate, horoscopeHour]);\n    (0, react_1.useEffect)(() => {\n        if (taichiPoint < 0) {\n            setTaichiPalaces(undefined);\n        }\n        else {\n            const palaces = (0, astro_1.getPalaceNames)(taichiPoint);\n            setTaichiPalaces(palaces);\n        }\n    }, [taichiPoint]);\n    const toggleTaichiPoint = (index) => {\n        if (taichiPoint === index) {\n            setTaichiPoint(-1);\n        }\n        else {\n            setTaichiPoint(index);\n        }\n    };\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-astrolabe\", \"iztro-astrolabe-theme-default\") }, astrolabe === null || astrolabe === void 0 ? void 0 :\n        astrolabe.palaces.map((palace) => {\n            return (react_1.default.createElement(Izpalace_1.Izpalace, Object.assign({ key: palace.earthlyBranch, focusedIndex: focusedIndex, onFocused: setFocusedIndex, horoscope: horoscope, showDecadalScope: showDecadal, showYearlyScope: showYearly, showMonthlyScope: showMonthly, showDailyScope: showDaily, showHourlyScope: showHourly, taichiPalace: taichiPalaces === null || taichiPalaces === void 0 ? void 0 : taichiPalaces[palace.index], toggleScope: toggleShowScope, activeHeavenlyStem: activeHeavenlyStem, toggleActiveHeavenlyStem: toggleActiveHeavenlyStem, hoverHeavenlyStem: hoverHeavenlyStem, setHoverHeavenlyStem: setHoverHeavenlyStem, toggleTaichiPoint: toggleTaichiPoint }, palace)));\n        }),\n        react_1.default.createElement(IzpalaceCenter_1.IzpalaceCenter, Object.assign({ astrolabe: astrolabe, horoscope: horoscope, horoscopeDate: horoscopeDate, horoscopeHour: horoscopeHour, setHoroscopeDate: setHoroscopeDate, setHoroscopeHour: setHoroscopeHour, centerPalaceAlign: props.centerPalaceAlign }, dynamic))));\n};\nexports.Iztrolabe = Iztrolabe;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.throttle = exports.debounce = exports.createLayoutObserver = exports.updateLayoutCSSVariables = exports.getKeyboardHeight = exports.isKeyboardVisible = exports.calculateAvailableHeight = exports.getSafeAreaInset = exports.getLayoutConfig = exports.getAndroidNavigationBarHeight = exports.isAndroidDevice = exports.isMobileDevice = void 0;\n/**\n * 检测是否为移动设备\n */\nconst isMobileDevice = () => {\n    return /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\n};\nexports.isMobileDevice = isMobileDevice;\n/**\n * 检测是否为安卓设备\n */\nconst isAndroidDevice = () => {\n    return /Android/i.test(navigator.userAgent);\n};\nexports.isAndroidDevice = isAndroidDevice;\n/**\n * 检测安卓设备上的小白条（导航手势区域）\n * 返回小白条的估计高度（像素）\n */\nconst getAndroidNavigationBarHeight = () => {\n    var _a;\n    if (!(0, exports.isAndroidDevice)())\n        return 0;\n    // 方法1：通过CSS env()变量获取\n    const safeAreaBottom = (0, exports.getSafeAreaInset)('bottom');\n    // 方法2：通过屏幕和窗口高度差计算\n    const screenHeight = window.screen.height;\n    const windowHeight = window.innerHeight;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || windowHeight;\n    // 如果窗口高度小于屏幕高度，可能存在导航栏\n    const heightDiff = screenHeight - windowHeight;\n    // 方法3：通过window.innerWidth和screen.width判断是否有导航栏\n    const screenWidth = window.screen.width;\n    const windowWidth = window.innerWidth;\n    const widthDiff = Math.abs(screenWidth - windowWidth);\n    // 综合判断：如果安全区域底部大于0，或者高度差大于0，或者宽度差大于0\n    // 则认为存在导航栏，返回估计的高度\n    if (safeAreaBottom > 0) {\n        return safeAreaBottom;\n    }\n    // 安卓导航栏通常在24-48px之间\n    if (heightDiff > 0 && heightDiff <= 100) {\n        return heightDiff;\n    }\n    // 如果高度差太大，可能是键盘弹出，不计算为导航栏\n    if (heightDiff > 100) {\n        return 0;\n    }\n    // 默认安卓导航栏高度\n    return widthDiff > 0 ? 48 : 0;\n};\nexports.getAndroidNavigationBarHeight = getAndroidNavigationBarHeight;\n/**\n * 获取设备布局配置\n */\nconst getLayoutConfig = () => {\n    const isMobile = (0, exports.isMobileDevice)();\n    return {\n        isMobile,\n        headerHeight: isMobile ? 60 : 0,\n        keyboardHeight: 0,\n        safeAreaTop: (0, exports.getSafeAreaInset)('top'),\n        safeAreaBottom: (0, exports.getSafeAreaInset)('bottom'),\n    };\n};\nexports.getLayoutConfig = getLayoutConfig;\n/**\n * 获取安全区域插入值\n */\nconst getSafeAreaInset = (position) => {\n    if (typeof CSS !== 'undefined' && CSS.supports && CSS.supports('env', 'safe-area-inset-top')) {\n        const value = getComputedStyle(document.documentElement)\n            .getPropertyValue(`env(safe-area-inset-${position})`);\n        return parseInt(value) || 0;\n    }\n    return 0;\n};\nexports.getSafeAreaInset = getSafeAreaInset;\n/**\n * 计算可用高度\n */\nconst calculateAvailableHeight = (config) => {\n    var _a;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n    return viewportHeight - config.headerHeight - config.safeAreaTop - config.safeAreaBottom;\n};\nexports.calculateAvailableHeight = calculateAvailableHeight;\n/**\n * 检测虚拟键盘是否可见\n */\nconst isKeyboardVisible = (config) => {\n    var _a;\n    if (!config.isMobile)\n        return false;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n    const windowHeight = window.innerHeight;\n    // 如果视口高度明显小于窗口高度，说明键盘可能弹出了\n    return viewportHeight < windowHeight * 0.75;\n};\nexports.isKeyboardVisible = isKeyboardVisible;\n/**\n * 获取虚拟键盘高度\n */\nconst getKeyboardHeight = (config) => {\n    var _a;\n    if (!(0, exports.isKeyboardVisible)(config))\n        return 0;\n    const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n    const windowHeight = window.innerHeight;\n    return windowHeight - viewportHeight;\n};\nexports.getKeyboardHeight = getKeyboardHeight;\n/**\n * 更新 CSS 变量以响应布局变化\n */\nconst updateLayoutCSSVariables = (config) => {\n    const root = document.documentElement;\n    root.style.setProperty('--keyboard-height', `${config.keyboardHeight}px`);\n    root.style.setProperty('--safe-area-top', `${config.safeAreaTop}px`);\n    root.style.setProperty('--safe-area-bottom', `${config.safeAreaBottom}px`);\n    root.style.setProperty('--header-height', `${config.headerHeight}px`);\n};\nexports.updateLayoutCSSVariables = updateLayoutCSSVariables;\n/**\n * 创建响应式布局观察器\n */\nconst createLayoutObserver = (onLayoutChange) => {\n    return new ResizeObserver(() => {\n        const config = (0, exports.getLayoutConfig)();\n        config.keyboardHeight = (0, exports.getKeyboardHeight)(config);\n        (0, exports.updateLayoutCSSVariables)(config);\n        onLayoutChange(config);\n    });\n};\nexports.createLayoutObserver = createLayoutObserver;\n/**\n * 防抖函数\n */\nconst debounce = (func, delay) => {\n    let timeoutId;\n    return ((...args) => {\n        clearTimeout(timeoutId);\n        timeoutId = setTimeout(() => func.apply(null, args), delay);\n    });\n};\nexports.debounce = debounce;\n/**\n * 节流函数\n */\nconst throttle = (func, delay) => {\n    let lastCall = 0;\n    return ((...args) => {\n        const now = Date.now();\n        if (now - lastCall >= delay) {\n            lastCall = now;\n            func.apply(null, args);\n        }\n    });\n};\nexports.throttle = throttle;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ResultContainer = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst Iztrolabe_1 = require(\"../Iztrolabe\");\nconst SegmentedControl_1 = require(\"../SegmentedControl/SegmentedControl\");\nconst AIChatContext_1 = require(\"../AIChat/AIChatContext\");\n// Lazy loading components\nconst AIChat = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require(\"../AIChat\"))).then(module => ({ default: module.AIChat })));\nconst BackgroundAIIndicator = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require(\"../AIChat/BackgroundAIIndicator\"))));\nconst HistoryPanel = (0, react_1.lazy)(() => Promise.resolve().then(() => __importStar(require(\"../AIChat/components/HistoryPanel\"))));\n/**\n * Internal component that contains the main UI and logic,\n * and has access to the AIChatContext.\n */\nconst ResultContainerWithHistory = ({ chartMode, formData, synastryData, astrolabe, astrolabe1, astrolabe2, onShowInputPanel, }) => {\n    const [activeTab, setActiveTab] = (0, react_1.useState)(\"ai\");\n    const { createSession, sessions, activeSessionId, switchSession } = (0, AIChatContext_1.useAIChat)();\n    const isInitialMount = (0, react_1.useRef)(true);\n    // Create a new session when chart data changes (re-charting)\n    (0, react_1.useEffect)(() => {\n        // Skip the very first render\n        if (isInitialMount.current) {\n            isInitialMount.current = false;\n            // If no sessions exist on first load (from localStorage), create one.\n            if (sessions.length === 0) {\n                createSession();\n            }\n            return;\n        }\n        // On subsequent changes to chart data, create a new session\n        createSession();\n        setActiveTab('ai'); // Switch to AI tab to show the new chat\n    }, [formData, synastryData]);\n    const handleNewSession = () => {\n        createSession();\n        setActiveTab('ai');\n    };\n    return (react_1.default.createElement(\"div\", { className: \"result-section\" },\n        react_1.default.createElement(\"div\", { className: \"tab-navigation\" },\n            react_1.default.createElement(\"div\", { className: \"tab-navigation-spacer\" }),\n            react_1.default.createElement(\"div\", { className: \"tab-navigation-center\" },\n                react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"activeTab\", options: [\n                        { label: \"星盘\", value: \"astrolabe\" },\n                        { label: \"AI 解读\", value: \"ai\" },\n                        { label: \"历史\", value: \"history\" },\n                    ], value: activeTab, onChange: (value) => setActiveTab(value) })),\n            react_1.default.createElement(\"div\", { className: \"tab-navigation-actions\" },\n                react_1.default.createElement(\"button\", { onClick: handleNewSession, className: \"new-chat-button\", \"aria-label\": \"\\u65B0\\u5EFA\\u8BB0\\u5F55\" },\n                    react_1.default.createElement(\"svg\", { width: \"22\", height: \"22\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" },\n                        react_1.default.createElement(\"path\", { d: \"M14.5 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V7.5L14.5 2Z\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }),\n                        react_1.default.createElement(\"path\", { d: \"M14 2V8H20\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }),\n                        react_1.default.createElement(\"path\", { d: \"M12 18V12\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }),\n                        react_1.default.createElement(\"path\", { d: \"M9 15H15\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }))),\n                react_1.default.createElement(react_1.Suspense, { fallback: null },\n                    react_1.default.createElement(BackgroundAIIndicator, null)))),\n        react_1.default.createElement(\"div\", { className: \"tab-content\" },\n            activeTab === \"astrolabe\" && (react_1.default.createElement(\"div\", { className: \"astrolabe-content\" },\n                react_1.default.createElement(\"div\", { className: \"astrolabe-container\" },\n                    chartMode === \"single\" ? (react_1.default.createElement(Iztrolabe_1.Iztrolabe, { birthday: `${formData.year}-${String(formData.month).padStart(2, '0')}-${String(formData.day).padStart(2, '0')}`, birthTime: formData.birthTime, birthdayType: formData.birthdayType, gender: formData.gender })) : (react_1.default.createElement(\"div\", { className: \"synastry-container\" },\n                        react_1.default.createElement(\"div\", { className: \"synastry-person\" },\n                            react_1.default.createElement(\"h3\", null, synastryData.person1.name || \"第一个人\"),\n                            react_1.default.createElement(Iztrolabe_1.Iztrolabe, { birthday: `${synastryData.person1.year}-${String(synastryData.person1.month).padStart(2, '0')}-${String(synastryData.person1.day).padStart(2, '0')}`, birthTime: synastryData.person1.birthTime, birthdayType: synastryData.person1.birthdayType, gender: synastryData.person1.gender })),\n                        react_1.default.createElement(\"div\", { className: \"synastry-person\" },\n                            react_1.default.createElement(\"h3\", null, synastryData.person2.name || \"第二个人\"),\n                            react_1.default.createElement(Iztrolabe_1.Iztrolabe, { birthday: `${synastryData.person2.year}-${String(synastryData.person2.month).padStart(2, '0')}-${String(synastryData.person2.day).padStart(2, '0')}`, birthTime: synastryData.person2.birthTime, birthdayType: synastryData.person2.birthdayType, gender: synastryData.person2.gender })))),\n                    react_1.default.createElement(\"div\", { className: \"rechart-button-container\" },\n                        react_1.default.createElement(\"button\", { onClick: onShowInputPanel, className: \"rechart-button\" }, chartMode === \"single\" ? \"重新排盘\" : \"重新合盘\"))))),\n            react_1.default.createElement(\"div\", { className: `ai-content ${activeTab === \"ai\" ? \"visible\" : \"hidden\"}` },\n                react_1.default.createElement(react_1.Suspense, { fallback: react_1.default.createElement(\"div\", { className: \"loading-indicator\" }, \"\\u52A0\\u8F7DAI\\u804A\\u5929\\u529F\\u80FD\\u4E2D...\") },\n                    react_1.default.createElement(AIChat, { formData: formData, astrolabe: chartMode === \"single\" ? astrolabe : astrolabe1, synastryAstrolabe: chartMode === \"synastry\" ? astrolabe2 : undefined, isSynastryMode: chartMode === \"synastry\", personNames: {\n                            person1: synastryData.person1.name || \"第一个人\",\n                            person2: synastryData.person2.name || \"第二个人\"\n                        }, isVisible: activeTab === \"ai\" && !!activeSessionId }))),\n            activeTab === \"history\" && (react_1.default.createElement(react_1.Suspense, { fallback: react_1.default.createElement(\"div\", { className: \"loading-indicator\" }, \"\\u52A0\\u8F7D\\u5386\\u53F2\\u8BB0\\u5F55\\u4E2D...\") },\n                react_1.default.createElement(HistoryPanel, { onSelectSession: () => setActiveTab('ai') }))))));\n};\n/**\n * Main container component that provides the AI Chat context\n * and renders the UI.\n */\nconst ResultContainer = (props) => {\n    return (react_1.default.createElement(AIChatContext_1.AIChatProvider, null,\n        react_1.default.createElement(ResultContainerWithHistory, Object.assign({}, props))));\n};\nexports.ResultContainer = ResultContainer;\nexports.default = exports.ResultContainer;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\n// 使用React.memo优化组件重渲染\nconst ChatInputComponent = ({ inputValue, onInputChange, onSubmit, onToggleQuestionPanel, onStopGeneration, isGenerating, isLoading, showQuestionPanel, inputRef, setupInputListeners, }) => {\n    // 检测是否为 PWA 模式\n    const [isPWA, setIsPWA] = (0, react_1.useState)(false);\n    // 检测是否为 iOS 设备\n    const [isIOS, setIsIOS] = (0, react_1.useState)(false);\n    // 检测是否为安卓设备\n    const [isAndroid, setIsAndroid] = (0, react_1.useState)(false);\n    // 安卓导航栏高度\n    const [androidNavBarHeight, setAndroidNavBarHeight] = (0, react_1.useState)(0);\n    // iOS 刘海区域高度\n    const [iosNotchHeight, setIosNotchHeight] = (0, react_1.useState)(0);\n    // 优化设备检测逻辑，使用useMemo缓存检测结果\n    const deviceInfo = (0, react_1.useMemo)(() => {\n        const isIOSDevice = /iPhone|iPad|iPod/i.test(navigator.userAgent);\n        const isAndroidDevice = /Android/i.test(navigator.userAgent);\n        const isStandalone = window.matchMedia('(display-mode: standalone)').matches ||\n            window.navigator.standalone ||\n            document.referrer.includes('android-app://');\n        return {\n            isIOSDevice,\n            isAndroidDevice,\n            isStandalone\n        };\n    }, []);\n    // 优化高度计算逻辑，使用useMemo缓存计算结果\n    const heights = (0, react_1.useMemo)(() => {\n        const getIosNotchHeight = () => {\n            if (!deviceInfo.isIOSDevice)\n                return 0;\n            const safeAreaTop = parseInt(getComputedStyle(document.documentElement)\n                .getPropertyValue('--safe-area-inset-top')) || 0;\n            // iOS 刘海区域通常在 20-44px 之间\n            return safeAreaTop > 0 ? Math.max(safeAreaTop, 20) : 0;\n        };\n        const getAndroidNavBarHeight = () => {\n            if (!deviceInfo.isAndroidDevice)\n                return 0;\n            const safeAreaBottom = parseInt(getComputedStyle(document.documentElement)\n                .getPropertyValue('--safe-area-inset-bottom')) || 0;\n            const androidNavBarHeight = parseInt(getComputedStyle(document.documentElement)\n                .getPropertyValue('--android-navigation-bar-height')) || 0;\n            return Math.max(safeAreaBottom, androidNavBarHeight);\n        };\n        return {\n            iosNotchHeight: getIosNotchHeight(),\n            androidNavBarHeight: getAndroidNavBarHeight()\n        };\n    }, [deviceInfo]);\n    // 优化事件处理函数，使用useCallback\n    const handleInputChange = (0, react_1.useCallback)((e) => {\n        onInputChange(e.target.value);\n    }, [onInputChange]);\n    const handleButtonClick = (0, react_1.useCallback)(() => {\n        if (isGenerating) {\n            onStopGeneration();\n        }\n        else if (inputValue.trim()) {\n            onSubmit(new Event('submit'));\n        }\n        else {\n            onToggleQuestionPanel();\n        }\n    }, [isGenerating, inputValue, onStopGeneration, onSubmit, onToggleQuestionPanel]);\n    // 优化设备检测和状态更新\n    (0, react_1.useEffect)(() => {\n        setIsPWA(deviceInfo.isStandalone);\n        setIsIOS(deviceInfo.isIOSDevice);\n        setIsAndroid(deviceInfo.isAndroidDevice);\n        setIosNotchHeight(heights.iosNotchHeight);\n        setAndroidNavBarHeight(heights.androidNavBarHeight);\n    }, [deviceInfo, heights]);\n    // 优化事件监听器设置\n    (0, react_1.useEffect)(() => {\n        // 监听显示模式变化\n        const mediaQuery = window.matchMedia('(display-mode: standalone)');\n        const handlePWAChange = () => setIsPWA(mediaQuery.matches);\n        mediaQuery.addEventListener('change', handlePWAChange);\n        // 监听CSS变量变化（导航栏高度可能会变化）\n        const observer = new MutationObserver(() => {\n            if (deviceInfo.isAndroidDevice) {\n                const safeAreaBottom = parseInt(getComputedStyle(document.documentElement)\n                    .getPropertyValue('--safe-area-inset-bottom')) || 0;\n                const androidNavBarHeight = parseInt(getComputedStyle(document.documentElement)\n                    .getPropertyValue('--android-navigation-bar-height')) || 0;\n                setAndroidNavBarHeight(Math.max(safeAreaBottom, androidNavBarHeight));\n            }\n        });\n        observer.observe(document.documentElement, {\n            attributes: true,\n            attributeFilter: ['style']\n        });\n        return () => {\n            mediaQuery.removeEventListener('change', handlePWAChange);\n            observer.disconnect();\n        };\n    }, [deviceInfo]);\n    // 设置输入框监听器\n    (0, react_1.useEffect)(() => {\n        if (inputRef.current) {\n            setupInputListeners(inputRef.current);\n        }\n    }, [inputRef, setupInputListeners]);\n    return (react_1.default.createElement(\"form\", { className: `chat-input chat-input-form ${isPWA ? 'pwa-mode' : ''} ${isIOS ? 'ios-mode' : ''} ${isAndroid ? 'android-mode' : ''}`, onSubmit: onSubmit },\n        react_1.default.createElement(\"input\", { ref: inputRef, type: \"text\", value: inputValue, onChange: handleInputChange, placeholder: \"\\u8F93\\u5165\\u60A8\\u7684\\u95EE\\u9898...\", disabled: isLoading, className: \"chat-input-field\" }),\n        react_1.default.createElement(\"button\", { type: isGenerating ? \"button\" : (inputValue.trim() ? \"submit\" : \"button\"), onClick: handleButtonClick, disabled: isLoading && !isGenerating, className: \"chat-action-button chat-send-button\" }, isGenerating ? (react_1.default.createElement(\"span\", { className: \"chat-stop-icon\" }, \"\\u25A0\")) : inputValue.trim() ? (react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"24\", height: \"24\", viewBox: \"0 0 24 24\", fill: \"#ffffff\", stroke: \"#ffffff\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\", className: \"chat-send-icon\" },\n            react_1.default.createElement(\"line\", { x1: \"22\", y1: \"2\", x2: \"11\", y2: \"13\" }),\n            react_1.default.createElement(\"polygon\", { points: \"22 2 15 22 11 13 2 9 22 2\" }))) : (react_1.default.createElement(\"span\", { className: \"chat-toggle-icon\" }, showQuestionPanel ? \"✕\" : \"+\")))));\n};\n// 使用React.memo优化组件重渲染\nconst ChatInput = react_1.default.memo(ChatInputComponent);\nexports.default = ChatInput;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./Izstar\"), exports);\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CloudStorageService = void 0;\n/**\n * 云存储服务类，用于与 Cloudflare Worker + KV 交互\n */\nclass CloudStorageService {\n    /**\n     * 初始化方法，在类加载时调用\n     */\n    static initialize() {\n        // 不需要在初始化时做任何事\n    }\n    /**\n     * 检查是否已认证\n     * @returns 是否已认证\n     */\n    static isAuth() {\n        const cloudEnabled = localStorage.getItem(this.CLOUD_ENABLED_KEY);\n        return cloudEnabled === 'true';\n    }\n    /**\n     * 验证密码\n     * @param password 要验证的密码\n     * @returns 是否验证成功\n     */\n    static authenticate(password) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                // 直接比较硬编码的密码\n                if (password === this.CLOUD_PASSWORD) {\n                    // 保存云存储开关状态到本地\n                    localStorage.setItem(this.CLOUD_ENABLED_KEY, 'true');\n                    return true;\n                }\n                // 清除云存储开关状态\n                localStorage.removeItem(this.CLOUD_ENABLED_KEY);\n                return false;\n            }\n            catch (error) {\n                console.error('密码验证失败:', error);\n                return false;\n            }\n        });\n    }\n    /**\n     * 清除认证状态\n     */\n    static clearAuthentication() {\n        // 清除云存储开关状态\n        localStorage.removeItem(this.CLOUD_ENABLED_KEY);\n    }\n    /**\n     * 上传单个历史记录到云存储\n     * @param item 历史记录项\n     * @returns 上传是否成功\n     */\n    static uploadHistoryItem(item) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                console.log('上传历史记录项:', item);\n                const response = yield fetch(`${this.WORKER_URL}/api/history/item`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                    body: JSON.stringify({ item }),\n                });\n                if (!response.ok) {\n                    throw new Error(`上传失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                console.log('上传历史记录项结果:', result);\n                return result.success;\n            }\n            catch (error) {\n                console.error('上传历史记录项失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 从云存储下载单个历史记录\n     * @param id 历史记录ID\n     * @returns 历史记录项\n     */\n    static downloadHistoryItem(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/history/item/${id}`, {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`下载失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                return result.item;\n            }\n            catch (error) {\n                console.error('下载历史记录项失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 从云存储删除单个历史记录\n     * @param id 历史记录ID\n     * @returns 删除是否成功\n     */\n    static deleteHistoryItem(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/history/item/${id}`, {\n                    method: 'DELETE',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`删除失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                return result.success;\n            }\n            catch (error) {\n                console.error('删除历史记录项失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 获取所有历史记录ID列表\n     * @returns 历史记录ID数组\n     */\n    static getHistoryIds() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                console.log('获取历史记录ID列表...');\n                const response = yield fetch(`${this.WORKER_URL}/api/history/ids`, {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`获取ID列表失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                console.log('获取到的ID列表结果:', result);\n                console.log('ID列表:', result.ids);\n                return result.ids || [];\n            }\n            catch (error) {\n                console.error('获取历史记录ID列表失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 批量获取历史记录\n     * @param ids 历史记录ID数组\n     * @returns 历史记录数组\n     */\n    static batchDownloadHistoryItems(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                console.log('批量下载历史记录，IDs:', ids);\n                const response = yield fetch(`${this.WORKER_URL}/api/history/batch`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                    body: JSON.stringify({ ids }),\n                });\n                if (!response.ok) {\n                    throw new Error(`批量下载失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                console.log('从云端获取的原始数据:', result);\n                console.log('从云端获取的历史记录项:', result.items);\n                return result.items || [];\n            }\n            catch (error) {\n                console.error('批量下载历史记录失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 清空所有历史记录\n     * @returns 清空是否成功\n     */\n    static clearAllHistory() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.isAuth()) {\n                throw new Error('未认证，请先输入密码');\n            }\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/history/clear`, {\n                    method: 'DELETE',\n                    headers: {\n                        'Authorization': `Bearer ${this.CLOUD_PASSWORD}`,\n                    },\n                });\n                if (!response.ok) {\n                    throw new Error(`清空失败: ${response.status} ${response.statusText}`);\n                }\n                const result = yield response.json();\n                return result.success;\n            }\n            catch (error) {\n                console.error('清空历史记录失败:', error);\n                throw error;\n            }\n        });\n    }\n    /**\n     * 检查网络连接状态\n     * @returns 是否在线\n     */\n    static isOnline() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const response = yield fetch(`${this.WORKER_URL}/api/health`, {\n                    method: 'GET',\n                    mode: 'no-cors',\n                    cache: 'no-cache'\n                });\n                return true;\n            }\n            catch (_a) {\n                return false;\n            }\n        });\n    }\n}\nexports.CloudStorageService = CloudStorageService;\nCloudStorageService.WORKER_URL = 'https://ziwei.sydf.cc'; // 需要替换为实际的 Worker URL\nCloudStorageService.CLOUD_PASSWORD = 'ovo'; // 硬编码的云存储密码\nCloudStorageService.CLOUD_ENABLED_KEY = 'iztro_cloud_enabled'; // 云存储开关状态键\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Izpalace = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst classnames_1 = __importDefault(require(\"classnames\"));\nrequire(\"../styles/index.css\");\nconst Izstar_1 = require(\"../Izstar\");\nconst i18n_1 = require(\"iztro/lib/i18n\");\nconst utils_1 = require(\"iztro/lib/utils\");\nconst Izpalace = (_a) => {\n    var _b, _c, _d, _e;\n    var { index, taichiPalace, focusedIndex, onFocused, horoscope, activeHeavenlyStem, toggleActiveHeavenlyStem, hoverHeavenlyStem, setHoverHeavenlyStem, showDecadalScope = false, showYearlyScope = false, showMonthlyScope = false, showDailyScope = false, showHourlyScope = false, toggleScope, toggleTaichiPoint } = _a, palace = __rest(_a, [\"index\", \"taichiPalace\", \"focusedIndex\", \"onFocused\", \"horoscope\", \"activeHeavenlyStem\", \"toggleActiveHeavenlyStem\", \"hoverHeavenlyStem\", \"setHoverHeavenlyStem\", \"showDecadalScope\", \"showYearlyScope\", \"showMonthlyScope\", \"showDailyScope\", \"showHourlyScope\", \"toggleScope\", \"toggleTaichiPoint\"]);\n    const horoscopeNames = (0, react_1.useMemo)(() => {\n        const horoscopeNames = [];\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.decadal), { scope: \"decadal\", show: showDecadalScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.yearly), { scope: \"yearly\", show: showYearlyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.monthly.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.monthly), { scope: \"monthly\", show: showMonthlyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.daily.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.daily), { scope: \"daily\", show: showDailyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.hourly.index) === index) {\n            horoscopeNames.push(Object.assign(Object.assign({}, horoscope.hourly), { scope: \"hourly\", show: showHourlyScope }));\n        }\n        if ((horoscope === null || horoscope === void 0 ? void 0 : horoscope.age.index) === index) {\n            horoscopeNames.push({\n                name: horoscope.age.name,\n                heavenlyStem: undefined,\n                scope: \"age\",\n                show: false,\n            });\n        }\n        return horoscopeNames;\n    }, [\n        horoscope,\n        showDecadalScope,\n        showYearlyScope,\n        showMonthlyScope,\n        showDailyScope,\n        showHourlyScope,\n    ]);\n    const horoscopeMutagens = (0, react_1.useMemo)(() => {\n        if (!horoscope) {\n            return [];\n        }\n        return [\n            {\n                mutagen: horoscope.decadal.mutagen,\n                scope: \"decadal\",\n                show: showDecadalScope,\n            },\n            {\n                mutagen: horoscope.yearly.mutagen,\n                scope: \"yearly\",\n                show: showYearlyScope,\n            },\n            {\n                mutagen: horoscope.monthly.mutagen,\n                scope: \"monthly\",\n                show: showMonthlyScope,\n            },\n            {\n                mutagen: horoscope.daily.mutagen,\n                scope: \"daily\",\n                show: showDailyScope,\n            },\n            {\n                mutagen: horoscope.hourly.mutagen,\n                scope: \"hourly\",\n                show: showHourlyScope,\n            },\n        ];\n    }, [\n        horoscope,\n        showDecadalScope,\n        showYearlyScope,\n        showMonthlyScope,\n        showDailyScope,\n        showHourlyScope,\n    ]);\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(`iztro-palace g${index}`, {\n            \"focused-palace\": focusedIndex === index,\n            \"opposite-palace\": focusedIndex != undefined && index === (0, utils_1.fixIndex)(focusedIndex + 6),\n            \"surrounded-palace\": focusedIndex != undefined &&\n                (index === (0, utils_1.fixIndex)(focusedIndex + 4) ||\n                    index === (0, utils_1.fixIndex)(focusedIndex - 4)),\n        }), onMouseEnter: () => onFocused === null || onFocused === void 0 ? void 0 : onFocused(index), onMouseLeave: () => onFocused === null || onFocused === void 0 ? void 0 : onFocused(undefined) },\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-major\") }, palace.majorStars.map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name, activeHeavenlyStem: activeHeavenlyStem, hoverHeavenlyStem: hoverHeavenlyStem, palaceHeavenlyStem: (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"), horoscopeMutagens: horoscopeMutagens }, star))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-minor\") }, palace.minorStars.map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name, activeHeavenlyStem: activeHeavenlyStem, hoverHeavenlyStem: hoverHeavenlyStem, palaceHeavenlyStem: (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"), horoscopeMutagens: horoscopeMutagens }, star))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-adj\") },\n            react_1.default.createElement(\"div\", null, palace.adjectiveStars.slice(5).map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star))))),\n            react_1.default.createElement(\"div\", null, palace.adjectiveStars.slice(0, 5).map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star)))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-horo-star\") },\n            react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"stars\") }, ((_b = horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal) === null || _b === void 0 ? void 0 : _b.stars) &&\n                ((_c = horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal) === null || _c === void 0 ? void 0 : _c.stars[index].map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star)))))),\n            react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"stars\") }, ((_d = horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly) === null || _d === void 0 ? void 0 : _d.stars) &&\n                ((_e = horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly) === null || _e === void 0 ? void 0 : _e.stars[index].map((star) => (react_1.default.createElement(Izstar_1.Izstar, Object.assign({ key: star.name }, star))))))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-fate\") }, horoscopeNames === null || horoscopeNames === void 0 ? void 0 : horoscopeNames.map((item) => (react_1.default.createElement(\"span\", { key: item.name, className: (0, classnames_1.default)({\n                [`iztro-palace-${item.scope}-active`]: item.show,\n            }), onClick: item.scope ? () => toggleScope === null || toggleScope === void 0 ? void 0 : toggleScope(item.scope) : undefined },\n            item.name,\n            item.heavenlyStem && `·${item.heavenlyStem}`)))),\n        react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-footer\") },\n            react_1.default.createElement(\"div\", null,\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-lft24\") },\n                    react_1.default.createElement(\"div\", null, palace.changsheng12),\n                    react_1.default.createElement(\"div\", null, palace.boshi12)),\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-name\"), onClick: () => toggleTaichiPoint === null || toggleTaichiPoint === void 0 ? void 0 : toggleTaichiPoint(index) },\n                    react_1.default.createElement(\"span\", { className: \"iztro-palace-name-wrapper\" },\n                        palace.name,\n                        react_1.default.createElement(\"span\", { className: \"iztro-palace-name-taichi\" }, taichiPalace &&\n                            ((0, i18n_1.kot)(taichiPalace) === (0, i18n_1.kot)(\"命宫\")\n                                ? \"☯\"\n                                : taichiPalace))),\n                    palace.isBodyPalace && (react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"iztro-palace-name-body\") },\n                        \"\\u00B7\",\n                        (0, i18n_1.t)(\"bodyPalace\"))))),\n            react_1.default.createElement(\"div\", null,\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-scope\") },\n                    react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-scope-age\") }, palace.ages.slice(0, 7).join(\" \")),\n                    react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-scope-decadal\") }, palace.decadal.range.join(\" - \"))),\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-dynamic-name\") },\n                    showDecadalScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-decadal\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.decadal.palaceNames[index])),\n                    showYearlyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-yearly\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.palaceNames[index])),\n                    showMonthlyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-monthly\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.monthly.palaceNames[index])),\n                    showDailyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-daily\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.daily.palaceNames[index])),\n                    showHourlyScope && (react_1.default.createElement(\"span\", { className: \"iztro-palace-dynamic-name-hourly\" }, horoscope === null || horoscope === void 0 ? void 0 : horoscope.hourly.palaceNames[index])))),\n            react_1.default.createElement(\"div\", null,\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-rgt24\") },\n                    react_1.default.createElement(\"div\", null, showYearlyScope\n                        ? horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.yearlyDecStar.suiqian12[index]\n                        : palace.suiqian12),\n                    react_1.default.createElement(\"div\", null, showYearlyScope\n                        ? horoscope === null || horoscope === void 0 ? void 0 : horoscope.yearly.yearlyDecStar.jiangqian12[index]\n                        : palace.jiangqian12)),\n                react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-palace-gz\", {\n                        \"iztro-palace-gz-active\": activeHeavenlyStem ===\n                            (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"),\n                    }), onClick: () => toggleActiveHeavenlyStem === null || toggleActiveHeavenlyStem === void 0 ? void 0 : toggleActiveHeavenlyStem((0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\")), onMouseEnter: () => setHoverHeavenlyStem === null || setHoverHeavenlyStem === void 0 ? void 0 : setHoverHeavenlyStem((0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\")), onMouseLeave: () => setHoverHeavenlyStem === null || setHoverHeavenlyStem === void 0 ? void 0 : setHoverHeavenlyStem(undefined) },\n                    react_1.default.createElement(\"span\", { className: (0, classnames_1.default)({\n                            \"iztro-palace-gz-active\": activeHeavenlyStem ===\n                                (0, i18n_1.kot)(palace.heavenlyStem, \"Heavenly\"),\n                        }) },\n                        palace.heavenlyStem,\n                        palace.earthlyBranch))))));\n};\nexports.Izpalace = Izpalace;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SegmentedControl = void 0;\nconst react_1 = __importStar(require(\"react\"));\nrequire(\"../styles/index.css\");\nconst SegmentedControl = ({ name, options, value, onChange }) => {\n    const controlRef = (0, react_1.useRef)(null);\n    const sliderRef = (0, react_1.useRef)(null);\n    // 防止移动端点击时页面滚动和元素上移，但不影响点击功能\n    const handleTouchStart = (e) => {\n        // 只阻止多点触控的默认行为，防止页面缩放\n        if (e.touches.length > 1) {\n            e.preventDefault();\n        }\n        // 阻止事件冒泡，防止父元素的滚动行为\n        e.stopPropagation();\n        // 记录触摸开始位置，用于判断是否为点击操作\n        const touch = e.touches[0];\n        e.currentTarget.dataset.touchStartX = touch.clientX.toString();\n        e.currentTarget.dataset.touchStartY = touch.clientY.toString();\n    };\n    // 防止移动端点击时页面滚动和元素上移，但不影响点击功能\n    const handleTouchMove = (e) => {\n        // 只阻止多点触控的默认行为，防止页面缩放\n        if (e.touches.length > 1) {\n            e.preventDefault();\n        }\n        // 获取触摸开始位置\n        const touchStartX = parseFloat(e.currentTarget.dataset.touchStartX || '0');\n        const touchStartY = parseFloat(e.currentTarget.dataset.touchStartY || '0');\n        // 计算触摸移动距离\n        const touch = e.touches[0];\n        const deltaX = Math.abs(touch.clientX - touchStartX);\n        const deltaY = Math.abs(touch.clientY - touchStartY);\n        // 如果移动距离超过阈值，则认为是滑动操作，阻止默认行为\n        if (deltaX > 5 || deltaY > 5) {\n            e.preventDefault();\n        }\n        // 阻止事件冒泡，防止父元素的滚动行为\n        e.stopPropagation();\n    };\n    // 防止移动端点击时页面滚动和元素上移，但不影响点击功能\n    const handleTouchEnd = (e) => {\n        // 阻止事件冒泡，防止父元素的滚动行为\n        e.stopPropagation();\n        // 清除触摸开始位置记录\n        delete e.currentTarget.dataset.touchStartX;\n        delete e.currentTarget.dataset.touchStartY;\n    };\n    (0, react_1.useEffect)(() => {\n        if (!controlRef.current)\n            return;\n        const activeElement = controlRef.current.querySelector('.segmented-control-input:checked');\n        if (!activeElement)\n            return;\n        const buttonElement = activeElement.nextElementSibling;\n        if (!buttonElement || !sliderRef.current)\n            return;\n        // 使用 requestAnimationFrame 确保在浏览器重绘后计算位置\n        const updateSliderPosition = () => {\n            const buttonRect = buttonElement.getBoundingClientRect();\n            const controlRect = controlRef.current.getBoundingClientRect();\n            // 直接设置滑块样式，而不是使用状态\n            sliderRef.current.style.width = `${buttonRect.width}px`;\n            sliderRef.current.style.left = `${buttonRect.left - controlRect.left}px`;\n            sliderRef.current.style.opacity = '1';\n        };\n        // 立即更新一次\n        updateSliderPosition();\n        // 使用 requestAnimationFrame 确保在下一帧再次更新，处理可能的布局变化\n        const animationId = requestAnimationFrame(updateSliderPosition);\n        // 添加 resize 监听器，处理窗口大小变化\n        const resizeObserver = new ResizeObserver(() => {\n            updateSliderPosition();\n        });\n        resizeObserver.observe(controlRef.current);\n        // 清理函数\n        return () => {\n            cancelAnimationFrame(animationId);\n            resizeObserver.disconnect();\n        };\n    }, [value, options]);\n    // 处理按钮点击事件，防止移动端的默认行为\n    const handleButtonClick = (optionValue) => (e) => {\n        // 阻止事件冒泡和默认行为\n        e.preventDefault();\n        e.stopPropagation();\n        // 调用 onChange 回调\n        onChange(optionValue);\n    };\n    return (react_1.default.createElement(\"div\", { className: \"segmented-control\", ref: controlRef, onTouchStart: handleTouchStart, onTouchMove: handleTouchMove, onTouchEnd: handleTouchEnd },\n        react_1.default.createElement(\"div\", { className: \"segmented-control-slider\", ref: sliderRef }),\n        options.map((option) => (react_1.default.createElement(\"label\", { key: option.value, className: \"segmented-control-label\" },\n            react_1.default.createElement(\"input\", { type: \"radio\", name: name, value: option.value, checked: value === option.value, onChange: () => onChange(option.value), className: \"segmented-control-input\" }),\n            react_1.default.createElement(\"span\", { className: \"segmented-control-button\", onClick: handleButtonClick(option.value), onTouchEnd: handleButtonClick(option.value) }, option.label))))));\n};\nexports.SegmentedControl = SegmentedControl;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst QuestionPanel = ({ questionCategories, activeQuestionTab, onTabChange, onQuestionClick, showQuestionPanel, }) => {\n    if (!showQuestionPanel)\n        return null;\n    const activeCategory = questionCategories.find(c => c.name === activeQuestionTab);\n    return (react_1.default.createElement(\"div\", { className: \"question-panel\" },\n        react_1.default.createElement(\"div\", { className: \"question-tabs\" }, questionCategories.map((category) => (react_1.default.createElement(\"button\", { key: category.name, className: `tab-button question-tab-button ${activeQuestionTab === category.name ? \"active\" : \"\"}`, onClick: () => onTabChange(category.name) }, category.name)))),\n        react_1.default.createElement(\"div\", { className: \"question-content\" }, activeCategory === null || activeCategory === void 0 ? void 0 : activeCategory.subCategories.map((subCategory) => (react_1.default.createElement(\"div\", { key: subCategory.name, className: \"question-group\" },\n            react_1.default.createElement(\"h4\", { className: \"category-heading\" }, subCategory.name),\n            react_1.default.createElement(\"div\", { className: \"questions-wrapper\" }, subCategory.questions.map((question, index) => (react_1.default.createElement(\"p\", { key: index, onClick: () => onQuestionClick(question), className: \"question-text\" }, question))))))))));\n};\nexports.default = QuestionPanel;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst markdownFormatter_1 = __importDefault(require(\"../../utils/markdownFormatter\"));\n// 使用React.memo优化组件重渲染\nconst MessageItemComponent = ({ message, isLastMessage = false, showRegenerate = false, onRegenerate, messageRef, isStreaming = false, showActions = false, }) => {\n    const isUser = message.role === 'user';\n    const [displayedContent, setDisplayedContent] = (0, react_1.useState)('');\n    const [hasStartedStreaming, setHasStartedStreaming] = (0, react_1.useState)(false);\n    const contentRef = (0, react_1.useRef)(null);\n    // 使用useCallback优化函数\n    const handleCopy = (0, react_1.useCallback)(() => {\n        navigator.clipboard.writeText(message.content)\n            .then(() => {\n            // 可以添加复制成功的提示\n            console.log('内容已复制到剪贴板');\n        })\n            .catch(err => {\n            console.error('复制失败:', err);\n        });\n    }, [message.content]);\n    const handleShare = (0, react_1.useCallback)(() => {\n        if (navigator.share) {\n            const shareData = {\n                title: '紫微斗数AI回复',\n                text: message.content,\n            };\n            navigator.share(shareData)\n                .catch(err => {\n                console.error('分享失败:', err);\n                // 如果分享失败，尝试复制到剪贴板\n                handleCopy();\n            });\n        }\n        else {\n            // 如果不支持Web Share API，则复制到剪贴板\n            handleCopy();\n        }\n    }, [message.content, handleCopy]);\n    // 优化状态计算逻辑\n    const shouldShowActions = (0, react_1.useMemo)(() => {\n        return showActions && !isStreaming && !isUser && hasStartedStreaming;\n    }, [showActions, isStreaming, isUser, hasStartedStreaming]);\n    // 合并多个useEffect为一个，减少渲染次数\n    (0, react_1.useEffect)(() => {\n        // 直接使用message.content，不需要previousContent状态\n        setDisplayedContent(message.content);\n        if (!isUser && isStreaming) {\n            setHasStartedStreaming(true);\n        }\n    }, [message.content, isUser, isStreaming]);\n    return (react_1.default.createElement(\"div\", { ref: messageRef, className: `message-item ${isUser ? 'user-message' : 'assistant-message'}` },\n        react_1.default.createElement(\"div\", { className: `message-wrapper ${isUser ? 'user-message' : 'assistant-message'}` },\n            react_1.default.createElement(\"div\", { className: `message-content ${isUser ? 'user-message' : 'assistant-message'}` }, isUser ? (displayedContent) : (react_1.default.createElement(\"div\", { ref: contentRef, className: \"markdown-content message-markdown\" },\n                react_1.default.createElement(markdownFormatter_1.default, { content: displayedContent })))),\n            showRegenerate && (react_1.default.createElement(react_1.default.Fragment, null,\n                react_1.default.createElement(\"div\", { className: \"message-spacer\" }),\n                react_1.default.createElement(\"div\", { className: \"regenerate-container\" },\n                    react_1.default.createElement(\"button\", { className: \"regenerate-button quick-action-button\", onClick: onRegenerate, title: \"\\u91CD\\u65B0\\u751F\\u6210\" },\n                        react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"14\", height: \"14\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                            react_1.default.createElement(\"path\", { d: \"M1 4v6h6\" }),\n                            react_1.default.createElement(\"path\", { d: \"M3.51 15a9 9 0 1 0 2.13-9.36L1 10\" })),\n                        react_1.default.createElement(\"span\", null, \"\\u91CD\\u65B0\\u751F\\u6210\"))))),\n            shouldShowActions && (react_1.default.createElement(react_1.default.Fragment, null,\n                react_1.default.createElement(\"div\", { className: \"message-spacer\" }),\n                react_1.default.createElement(\"div\", { className: \"message-actions-container\" },\n                    react_1.default.createElement(\"button\", { className: \"copy-button\", onClick: handleCopy, title: \"\\u590D\\u5236\", \"aria-label\": \"\\u590D\\u5236\" },\n                        react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"16\", height: \"16\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                            react_1.default.createElement(\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\" }),\n                            react_1.default.createElement(\"path\", { d: \"m4 16c-1.1 0-2-.9-2-2v-10c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\" }))),\n                    react_1.default.createElement(\"button\", { className: \"share-button\", onClick: handleShare, title: \"\\u5206\\u4EAB\", \"aria-label\": \"\\u5206\\u4EAB\" },\n                        react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"16\", height: \"16\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                            react_1.default.createElement(\"circle\", { cx: \"18\", cy: \"5\", r: \"3\" }),\n                            react_1.default.createElement(\"circle\", { cx: \"6\", cy: \"12\", r: \"3\" }),\n                            react_1.default.createElement(\"circle\", { cx: \"18\", cy: \"19\", r: \"3\" }),\n                            react_1.default.createElement(\"line\", { x1: \"8.59\", y1: \"13.51\", x2: \"15.42\", y2: \"17.49\" }),\n                            react_1.default.createElement(\"line\", { x1: \"15.41\", y1: \"6.51\", x2: \"8.59\", y2: \"10.49\" })))))))));\n};\n// 使用React.memo优化组件重渲染，避免不必要的重新渲染\nconst MessageItem = react_1.default.memo(MessageItemComponent);\nexports.default = MessageItem;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.formatAstrolabeForAI = void 0;\n/**\n * 格式化星耀数据为可读字符串\n * @param stars 星耀数组\n * @returns 格式化后的星耀字符串\n */\nconst formatStars = (stars) => {\n    if (!stars || stars.length === 0)\n        return '无';\n    return stars.join('、');\n};\n/**\n * 格式化宫位数据为可读字符串\n * @param palace 宫位数据\n * @returns 格式化后的宫位信息字符串\n */\nconst formatPalace = (palace) => {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    const majorStars = ((_a = palace.majorStars) === null || _a === void 0 ? void 0 : _a.map(star => star.name)) || [];\n    const minorStars = ((_b = palace.minorStars) === null || _b === void 0 ? void 0 : _b.map(star => star.name)) || [];\n    const adjectiveStars = ((_c = palace.adjectiveStars) === null || _c === void 0 ? void 0 : _c.map(star => star.name)) || [];\n    return `\n宫位：${palace.name}\n天干地支：${palace.heavenlyStem}${palace.earthlyBranch}\n主星：${formatStars(majorStars)}\n辅星：${formatStars(minorStars)}\n杂耀：${formatStars(adjectiveStars)}\n长生12神：${palace.changsheng12 || '无'}\n博士12神：${palace.boshi12 || '无'}\n将前12神：${palace.jiangqian12 || '无'}\n岁前12神：${palace.suiqian12 || '无'}\n大限：${(_e = (_d = palace.decadal) === null || _d === void 0 ? void 0 : _d.range) === null || _e === void 0 ? void 0 : _e[0]}-${(_g = (_f = palace.decadal) === null || _f === void 0 ? void 0 : _f.range) === null || _g === void 0 ? void 0 : _g[1]}岁\n小限：${((_h = palace.ages) === null || _h === void 0 ? void 0 : _h.join('、')) || '无'}\n${palace.isBodyPalace ? '【身宫】' : ''}\n${palace.isOriginalPalace ? '【来因宫】' : ''}\n  `.trim();\n};\n/**\n * 将星盘数据格式化为AI可理解的文本格式\n * @param astrolabe 星盘数据\n * @param currentTime 当前时间\n * @returns 格式化后的星盘信息文本\n */\nconst formatAstrolabeForAI = (astrolabe, currentTime = new Date(), gender) => {\n    if (!astrolabe) {\n        return '暂无星盘数据';\n    }\n    const formattedTime = currentTime.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        hour12: false\n    });\n    let result = `\n=== 紫微斗数星盘数据 ===\n当前时间：${formattedTime}\n\n基本信息：\n性别：${gender}\n阳历日期：${astrolabe.solarDate}\n农历日期：${astrolabe.lunarDate}\n干支纪年：${astrolabe.chineseDate}\n出生时辰：${astrolabe.time}（${astrolabe.timeRange}）\n星座：${astrolabe.sign}\n生肖：${astrolabe.zodiac}\n命宫地支：${astrolabe.earthlyBranchOfSoulPalace}\n身宫地支：${astrolabe.earthlyBranchOfBodyPalace}\n命主：${astrolabe.soul}\n身主：${astrolabe.body}\n五行局：${astrolabe.fiveElementsClass}\n\n十二宫位详情：\n`;\n    // 添加十二宫位信息\n    if (astrolabe.palaces && astrolabe.palaces.length > 0) {\n        astrolabe.palaces.forEach((palace, index) => {\n            result += `\\n--- 第${index + 1}宫 ---\\n`;\n            result += formatPalace(palace);\n            result += '\\n\\n';\n        });\n    }\n    // 添加当前运限信息\n    if (astrolabe.horoscope) {\n        const horoscope = astrolabe.horoscope();\n        if (horoscope) {\n            result += `\n=== 当前运限信息 ===\n查询日期：${horoscope.solarDate}\n农历日期：${horoscope.lunarDate}\n\n大限：\n天干地支：${horoscope.decadal.heavenlyStem}${horoscope.decadal.earthlyBranch}\n四化星：${formatStars(horoscope.decadal.mutagen || [])}\n\n小限：\n虚岁：${horoscope.age.nominalAge}\n天干地支：${horoscope.age.heavenlyStem}${horoscope.age.earthlyBranch}\n\n流年：\n天干地支：${horoscope.yearly.heavenlyStem}${horoscope.yearly.earthlyBranch}\n四化星：${formatStars(horoscope.yearly.mutagen || [])}\n\n流月：\n天干地支：${horoscope.monthly.heavenlyStem}${horoscope.monthly.earthlyBranch}\n\n流日：\n天干地支：${horoscope.daily.heavenlyStem}${horoscope.daily.earthlyBranch}\n\n流时：\n天干地支：${horoscope.hourly.heavenlyStem}${horoscope.hourly.earthlyBranch}\n`;\n        }\n    }\n    return result.trim();\n};\nexports.formatAstrolabeForAI = formatAstrolabeForAI;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Line = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst utils_1 = require(\"iztro/lib/utils\");\nconst Line = ({ index, scope }) => {\n    const line = (0, react_1.useRef)(null);\n    const strokeColor = (0, react_1.useMemo)(() => {\n        if (scope) {\n            const element = document.getElementsByClassName(\"iztro-astrolabe-theme-default\")[0];\n            const computedStyle = getComputedStyle(element);\n            // 获取CSS中定义的变量的值\n            return computedStyle.getPropertyValue(`--iztro-color-${scope}`);\n        }\n        return \"rgba(245,0,0)\";\n    }, [scope]);\n    (0, react_1.useEffect)(() => {\n        const idx = index;\n        const canvasDom = line.current;\n        if (!canvasDom || idx < 0) {\n            return;\n        }\n        const { height, width } = canvasDom.getBoundingClientRect();\n        canvasDom.width = width;\n        canvasDom.height = height;\n        const w = width / 2;\n        const h = height / 2;\n        const points = [\n            [0, h * 2],\n            [0, h * 1.5],\n            [0, h * 0.5],\n            [0, 0],\n            [w * 0.5, 0],\n            [w * 1.5, 0],\n            [w * 2, 0],\n            [w * 2, h * 0.5],\n            [w * 2, h * 1.5],\n            [w * 2, h * 2],\n            [w * 1.5, h * 2],\n            [w * 0.5, h * 2],\n        ];\n        //第二步：获取上下文\n        const canvasCtx = canvasDom.getContext(\"2d\");\n        if (!canvasCtx) {\n            return;\n        }\n        canvasCtx.clearRect(0, 0, canvasDom.width, canvasDom.height);\n        canvasCtx.strokeStyle = strokeColor;\n        canvasCtx.lineWidth = 1;\n        canvasCtx.globalAlpha = 0.5;\n        const dgIdx = (0, utils_1.fixIndex)(idx + 6);\n        const q4Idx = (0, utils_1.fixIndex)(idx + 4);\n        const h4Idx = (0, utils_1.fixIndex)(idx - 4);\n        canvasCtx.beginPath();\n        canvasCtx.moveTo(points[dgIdx][0], points[dgIdx][1]);\n        canvasCtx.lineTo(points[idx][0], points[idx][1]);\n        canvasCtx.lineTo(points[q4Idx][0], points[q4Idx][1]);\n        canvasCtx.lineTo(points[h4Idx][0], points[h4Idx][1]);\n        canvasCtx.lineTo(points[idx][0], points[idx][1]);\n        canvasCtx.stroke();\n    }, [index, strokeColor]);\n    return (react_1.default.createElement(\"canvas\", { id: \"palace-line\", className: `palace-line ${scope || ''}`, ref: line }));\n};\nexports.Line = Line;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst HistoryModal = ({ history, showHistoryModal, setShowHistoryModal, searchTerm, setSearchTerm, showPasswordInput, setShowPasswordInput, password, setPassword, isCloudStorageEnabled, isLoading, editingHistoryId, setEditingHistoryId, handlePasswordSubmit, handleDeleteHistory, handleClearHistory, onLoadHistory, onEditHistory, chartMode, }) => {\n    const handlePasswordKeyDown = (0, react_1.useCallback)((e) => {\n        if (e.key === 'Enter') {\n            handlePasswordSubmit();\n        }\n    }, [handlePasswordSubmit]);\n    if (!showHistoryModal)\n        return null;\n    return (react_1.default.createElement(\"div\", { className: \"history-modal-overlay\", onClick: () => setShowHistoryModal(false) },\n        react_1.default.createElement(\"div\", { className: \"history-modal\", onClick: (e) => e.stopPropagation() },\n            react_1.default.createElement(\"div\", { className: \"history-modal-header\" },\n                react_1.default.createElement(\"h2\", { className: \"history-title\", title: isCloudStorageEnabled ? \"云存储已启用\" : \"点击输入密码启用云存储\", onClick: () => !isCloudStorageEnabled && setShowPasswordInput(!showPasswordInput) },\n                    \"\\u5386\\u53F2\\u8BB0\\u5F55 \",\n                    isCloudStorageEnabled && \"☁️\")),\n            showPasswordInput && (react_1.default.createElement(\"div\", { className: \"history-password-container\" },\n                react_1.default.createElement(\"input\", { type: \"password\", className: \"history-password-input\", placeholder: \"\\u8F93\\u5165\\u4E91\\u5B58\\u50A8\\u5BC6\\u7801\", value: password, onChange: (e) => setPassword(e.target.value), onKeyDown: handlePasswordKeyDown, disabled: isLoading }),\n                react_1.default.createElement(\"button\", { className: \"history-password-button\", onClick: handlePasswordSubmit, disabled: isLoading || !password.trim() }, isLoading ? \"验证中...\" : \"确认\"))),\n            react_1.default.createElement(\"div\", { className: \"history-search-container\" },\n                react_1.default.createElement(\"input\", { type: \"text\", className: \"history-search-input\", placeholder: \"\\u641C\\u7D22\\u5386\\u53F2\\u8BB0\\u5F55...\", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value) })),\n            react_1.default.createElement(\"div\", { className: \"history-modal-content\" }, history.length === 0 ? (react_1.default.createElement(\"div\", { className: \"history-empty\" }, \"\\u6682\\u65E0\\u5386\\u53F2\\u8BB0\\u5F55\")) : (react_1.default.createElement(\"div\", { className: \"history-list\" }, history\n                .filter(item => item.type === chartMode)\n                .map((item) => {\n                var _a;\n                return (react_1.default.createElement(\"div\", { key: item.id, className: \"history-item\" },\n                    react_1.default.createElement(\"div\", { className: \"history-item-content\", onClick: () => {\n                            onLoadHistory(item);\n                            setShowHistoryModal(false);\n                        } },\n                        react_1.default.createElement(\"div\", { className: \"history-item-main\" },\n                            react_1.default.createElement(\"span\", { className: \"history-item-name\" }, item.type === 'single' ? item.name : `${item.name} 和 ${((_a = item.person2) === null || _a === void 0 ? void 0 : _a.name) || '第二个人'}`),\n                            react_1.default.createElement(\"span\", { className: \"history-item-info\" },\n                                item.year,\n                                \"-\",\n                                item.month,\n                                \"-\",\n                                item.day)),\n                        react_1.default.createElement(\"div\", { className: \"history-item-actions\" },\n                            react_1.default.createElement(\"button\", { className: \"history-action-button history-edit-icon\", onClick: (e) => {\n                                    e.stopPropagation();\n                                    onEditHistory(item);\n                                    setEditingHistoryId(item.id);\n                                    setShowHistoryModal(false);\n                                }, title: \"\\u7F16\\u8F91\" },\n                                react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"18\", height: \"18\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                                    react_1.default.createElement(\"path\", { d: \"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" }),\n                                    react_1.default.createElement(\"path\", { d: \"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" }))),\n                            react_1.default.createElement(\"button\", { className: \"history-action-button history-delete-icon\", onClick: (e) => {\n                                    e.stopPropagation();\n                                    if (confirm('确定要删除这条历史记录吗？')) {\n                                        handleDeleteHistory(item.id);\n                                    }\n                                }, title: \"\\u5220\\u9664\" },\n                                react_1.default.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"18\", height: \"18\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n                                    react_1.default.createElement(\"polyline\", { points: \"3 6 5 6 21 6\" }),\n                                    react_1.default.createElement(\"path\", { d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" }),\n                                    react_1.default.createElement(\"line\", { x1: \"10\", y1: \"11\", x2: \"10\", y2: \"17\" }),\n                                    react_1.default.createElement(\"line\", { x1: \"14\", y1: \"11\", x2: \"14\", y2: \"17\" })))))));\n            })))),\n            react_1.default.createElement(\"div\", { className: \"history-modal-footer\" },\n                react_1.default.createElement(\"button\", { className: \"history-clear-button\", onClick: handleClearHistory, disabled: isCloudStorageEnabled, title: isCloudStorageEnabled ? \"云存储已启用，无法清空历史记录\" : \"清空所有历史记录\" }, \"\\u6E05\\u7A7A\\u5386\\u53F2\\u8BB0\\u5F55\")))));\n};\nexports.default = react_1.default.memo(HistoryModal);\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FormContainer = void 0;\nconst react_1 = __importDefault(require(\"react\"));\nconst SegmentedControl_1 = require(\"../SegmentedControl/SegmentedControl\");\n/**\n * 表单容器组件\n * 负责处理排盘和合盘表单的显示和交互\n */\nconst FormContainer = ({ chartMode, setChartMode, formData, synastryData, onFormChange, onSynastryChange, onRadioChange, onSynastryRadioChange, onSubmit, onSynastrySubmit, onShowHistory, }) => {\n    const handleFormChange = (e) => {\n        const { name, value } = e.target;\n        onFormChange(Object.assign(Object.assign({}, formData), { [name]: name === 'birthTime' ? parseInt(value) : value }));\n    };\n    const handleSynastryChange = (person, e) => {\n        const { name, value } = e.target;\n        onSynastryChange(person, Object.assign(Object.assign({}, synastryData[person]), { [name]: name === 'birthTime' ? parseInt(value) : value }));\n    };\n    return (react_1.default.createElement(\"div\", { className: \"form-section\" },\n        react_1.default.createElement(\"div\", { className: \"form-group form-group-segmented\" },\n            react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"chartMode\", options: [\n                    { label: \"排盘\", value: \"single\" },\n                    { label: \"合盘\", value: \"synastry\" },\n                ], value: chartMode, onChange: (value) => setChartMode(value) })),\n        chartMode === \"single\" && (react_1.default.createElement(\"form\", { onSubmit: onSubmit },\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"name\" }, \"\\u59D3\\u540D\\uFF08\\u53EF\\u9009\\uFF09\"),\n                react_1.default.createElement(\"input\", { type: \"text\", id: \"name\", name: \"name\", value: formData.name, onChange: handleFormChange })),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile gender-date\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u6027\\u522B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"gender\", options: [\n                            { label: \"男\", value: \"male\" },\n                            { label: \"女\", value: \"female\" },\n                        ], value: formData.gender, onChange: (value) => onRadioChange(\"gender\", value) })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u65E5\\u671F\\u7C7B\\u578B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"birthdayType\", options: [\n                            { label: \"阳历\", value: \"solar\" },\n                            { label: \"农历\", value: \"lunar\" },\n                        ], value: formData.birthdayType, onChange: (value) => onRadioChange(\"birthdayType\", value) }))),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile date-fields\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"year\" }, \"\\u5E74\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"year\", name: \"year\", value: formData.year, onChange: handleFormChange, min: \"1900\", max: \"2100\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"month\" }, \"\\u6708\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"month\", name: \"month\", value: formData.month, onChange: handleFormChange, min: \"1\", max: \"12\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"day\" }, \"\\u65E5\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"day\", name: \"day\", value: formData.day, onChange: handleFormChange, min: \"1\", max: \"31\" }))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"birthTime\" }, \"\\u51FA\\u751F\\u65F6\\u8FB0\"),\n                react_1.default.createElement(\"select\", { id: \"birthTime\", name: \"birthTime\", value: formData.birthTime, onChange: handleFormChange },\n                    react_1.default.createElement(\"option\", { value: 0 }, \"\\u65E9\\u5B50\\u65F6(00:00~01:00)\"),\n                    react_1.default.createElement(\"option\", { value: 1 }, \"\\u4E11\\u65F6(01:00~03:00)\"),\n                    react_1.default.createElement(\"option\", { value: 2 }, \"\\u5BC5\\u65F6(03:00~05:00)\"),\n                    react_1.default.createElement(\"option\", { value: 3 }, \"\\u536F\\u65F6(05:00~07:00)\"),\n                    react_1.default.createElement(\"option\", { value: 4 }, \"\\u8FB0\\u65F6(07:00~09:00)\"),\n                    react_1.default.createElement(\"option\", { value: 5 }, \"\\u5DF3\\u65F6(09:00~11:00)\"),\n                    react_1.default.createElement(\"option\", { value: 6 }, \"\\u5348\\u65F6(11:00~13:00)\"),\n                    react_1.default.createElement(\"option\", { value: 7 }, \"\\u672A\\u65F6(13:00~15:00)\"),\n                    react_1.default.createElement(\"option\", { value: 8 }, \"\\u7533\\u65F6(15:00~17:00)\"),\n                    react_1.default.createElement(\"option\", { value: 9 }, \"\\u9149\\u65F6(17:00~19:00)\"),\n                    react_1.default.createElement(\"option\", { value: 10 }, \"\\u620C\\u65F6(19:00~21:00)\"),\n                    react_1.default.createElement(\"option\", { value: 11 }, \"\\u4EA5\\u65F6(21:00~23:00)\"),\n                    react_1.default.createElement(\"option\", { value: 12 }, \"\\u665A\\u5B50\\u65F6(23:00~00:00)\"))),\n            react_1.default.createElement(\"button\", { type: \"submit\" }, \"\\u5F00\\u59CB\\u6392\\u76D8\"),\n            react_1.default.createElement(\"button\", { type: \"button\", className: \"history-button\", onClick: onShowHistory }, \"\\u5386\\u53F2\\u8BB0\\u5F55\"))),\n        chartMode === \"synastry\" && (react_1.default.createElement(\"form\", { onSubmit: onSynastrySubmit },\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"h3\", null, \"\\u7B2C\\u4E00\\u4E2A\\u4EBA\")),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person1-name\" }, \"\\u59D3\\u540D\\uFF08\\u53EF\\u9009\\uFF09\"),\n                react_1.default.createElement(\"input\", { type: \"text\", id: \"person1-name\", name: \"name\", value: synastryData.person1.name, onChange: (e) => handleSynastryChange(\"person1\", e) })),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile gender-date\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u6027\\u522B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person1-gender\", options: [\n                            { label: \"男\", value: \"male\" },\n                            { label: \"女\", value: \"female\" },\n                        ], value: synastryData.person1.gender, onChange: (value) => onSynastryRadioChange(\"person1\", \"gender\", value) })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u65E5\\u671F\\u7C7B\\u578B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person1-birthdayType\", options: [\n                            { label: \"阳历\", value: \"solar\" },\n                            { label: \"农历\", value: \"lunar\" },\n                        ], value: synastryData.person1.birthdayType, onChange: (value) => onSynastryRadioChange(\"person1\", \"birthdayType\", value) }))),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile date-fields\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person1-year\" }, \"\\u5E74\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person1-year\", name: \"year\", value: synastryData.person1.year, onChange: (e) => handleSynastryChange(\"person1\", e), min: \"1900\", max: \"2100\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person1-month\" }, \"\\u6708\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person1-month\", name: \"month\", value: synastryData.person1.month, onChange: (e) => handleSynastryChange(\"person1\", e), min: \"1\", max: \"12\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person1-day\" }, \"\\u65E5\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person1-day\", name: \"day\", value: synastryData.person1.day, onChange: (e) => handleSynastryChange(\"person1\", e), min: \"1\", max: \"31\" }))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person1-birthTime\" }, \"\\u51FA\\u751F\\u65F6\\u8FB0\"),\n                react_1.default.createElement(\"select\", { id: \"person1-birthTime\", name: \"birthTime\", value: synastryData.person1.birthTime, onChange: (e) => handleSynastryChange(\"person1\", e) },\n                    react_1.default.createElement(\"option\", { value: 0 }, \"\\u65E9\\u5B50\\u65F6(00:00~01:00)\"),\n                    react_1.default.createElement(\"option\", { value: 1 }, \"\\u4E11\\u65F6(01:00~03:00)\"),\n                    react_1.default.createElement(\"option\", { value: 2 }, \"\\u5BC5\\u65F6(03:00~05:00)\"),\n                    react_1.default.createElement(\"option\", { value: 3 }, \"\\u536F\\u65F6(05:00~07:00)\"),\n                    react_1.default.createElement(\"option\", { value: 4 }, \"\\u8FB0\\u65F6(07:00~09:00)\"),\n                    react_1.default.createElement(\"option\", { value: 5 }, \"\\u5DF3\\u65F6(09:00~11:00)\"),\n                    react_1.default.createElement(\"option\", { value: 6 }, \"\\u5348\\u65F6(11:00~13:00)\"),\n                    react_1.default.createElement(\"option\", { value: 7 }, \"\\u672A\\u65F6(13:00~15:00)\"),\n                    react_1.default.createElement(\"option\", { value: 8 }, \"\\u7533\\u65F6(15:00~17:00)\"),\n                    react_1.default.createElement(\"option\", { value: 9 }, \"\\u9149\\u65F6(17:00~19:00)\"),\n                    react_1.default.createElement(\"option\", { value: 10 }, \"\\u620C\\u65F6(19:00~21:00)\"),\n                    react_1.default.createElement(\"option\", { value: 11 }, \"\\u4EA5\\u65F6(21:00~23:00)\"),\n                    react_1.default.createElement(\"option\", { value: 12 }, \"\\u665A\\u5B50\\u65F6(23:00~00:00)\"))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"h3\", null, \"\\u7B2C\\u4E8C\\u4E2A\\u4EBA\")),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person2-name\" }, \"\\u59D3\\u540D\\uFF08\\u53EF\\u9009\\uFF09\"),\n                react_1.default.createElement(\"input\", { type: \"text\", id: \"person2-name\", name: \"name\", value: synastryData.person2.name, onChange: (e) => handleSynastryChange(\"person2\", e) })),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile gender-date\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u6027\\u522B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person2-gender\", options: [\n                            { label: \"男\", value: \"male\" },\n                            { label: \"女\", value: \"female\" },\n                        ], value: synastryData.person2.gender, onChange: (value) => onSynastryRadioChange(\"person2\", \"gender\", value) })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", null, \"\\u65E5\\u671F\\u7C7B\\u578B\"),\n                    react_1.default.createElement(SegmentedControl_1.SegmentedControl, { name: \"person2-birthdayType\", options: [\n                            { label: \"阳历\", value: \"solar\" },\n                            { label: \"农历\", value: \"lunar\" },\n                        ], value: synastryData.person2.birthdayType, onChange: (value) => onSynastryRadioChange(\"person2\", \"birthdayType\", value) }))),\n            react_1.default.createElement(\"div\", { className: \"form-group-inline form-group-inline-mobile date-fields\" },\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person2-year\" }, \"\\u5E74\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person2-year\", name: \"year\", value: synastryData.person2.year, onChange: (e) => handleSynastryChange(\"person2\", e), min: \"1900\", max: \"2100\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person2-month\" }, \"\\u6708\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person2-month\", name: \"month\", value: synastryData.person2.month, onChange: (e) => handleSynastryChange(\"person2\", e), min: \"1\", max: \"12\" })),\n                react_1.default.createElement(\"div\", { className: \"form-group\" },\n                    react_1.default.createElement(\"label\", { htmlFor: \"person2-day\" }, \"\\u65E5\"),\n                    react_1.default.createElement(\"input\", { type: \"number\", id: \"person2-day\", name: \"day\", value: synastryData.person2.day, onChange: (e) => handleSynastryChange(\"person2\", e), min: \"1\", max: \"31\" }))),\n            react_1.default.createElement(\"div\", { className: \"form-group\" },\n                react_1.default.createElement(\"label\", { htmlFor: \"person2-birthTime\" }, \"\\u51FA\\u751F\\u65F6\\u8FB0\"),\n                react_1.default.createElement(\"select\", { id: \"person2-birthTime\", name: \"birthTime\", value: synastryData.person2.birthTime, onChange: (e) => handleSynastryChange(\"person2\", e) },\n                    react_1.default.createElement(\"option\", { value: 0 }, \"\\u65E9\\u5B50\\u65F6(00:00~01:00)\"),\n                    react_1.default.createElement(\"option\", { value: 1 }, \"\\u4E11\\u65F6(01:00~03:00)\"),\n                    react_1.default.createElement(\"option\", { value: 2 }, \"\\u5BC5\\u65F6(03:00~05:00)\"),\n                    react_1.default.createElement(\"option\", { value: 3 }, \"\\u536F\\u65F6(05:00~07:00)\"),\n                    react_1.default.createElement(\"option\", { value: 4 }, \"\\u8FB0\\u65F6(07:00~09:00)\"),\n                    react_1.default.createElement(\"option\", { value: 5 }, \"\\u5DF3\\u65F6(09:00~11:00)\"),\n                    react_1.default.createElement(\"option\", { value: 6 }, \"\\u5348\\u65F6(11:00~13:00)\"),\n                    react_1.default.createElement(\"option\", { value: 7 }, \"\\u672A\\u65F6(13:00~15:00)\"),\n                    react_1.default.createElement(\"option\", { value: 8 }, \"\\u7533\\u65F6(15:00~17:00)\"),\n                    react_1.default.createElement(\"option\", { value: 9 }, \"\\u9149\\u65F6(17:00~19:00)\"),\n                    react_1.default.createElement(\"option\", { value: 10 }, \"\\u620C\\u65F6(19:00~21:00)\"),\n                    react_1.default.createElement(\"option\", { value: 11 }, \"\\u4EA5\\u65F6(21:00~23:00)\"),\n                    react_1.default.createElement(\"option\", { value: 12 }, \"\\u665A\\u5B50\\u65F6(23:00~00:00)\"))),\n            react_1.default.createElement(\"button\", { type: \"submit\" }, \"\\u5F00\\u59CB\\u5408\\u76D8\"),\n            react_1.default.createElement(\"button\", { type: \"button\", className: \"history-button\", onClick: onShowHistory }, \"\\u5386\\u53F2\\u8BB0\\u5F55\")))));\n};\nexports.FormContainer = FormContainer;\nexports.default = exports.FormContainer;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst TypingIndicator = () => {\n    return (react_1.default.createElement(\"div\", { className: \"typing-indicator\" },\n        react_1.default.createElement(\"span\", { className: \"typing-dot\" }),\n        react_1.default.createElement(\"span\", { className: \"typing-dot\" }),\n        react_1.default.createElement(\"span\", { className: \"typing-dot\" })));\n};\nexports.default = TypingIndicator;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAIChatRequest = exports.useNetworkRequest = void 0;\nconst react_1 = require(\"react\");\n/**\n * 网络请求Hook\n * 提供缓存、重试和错误处理功能\n */\nconst useNetworkRequest = (options = {}) => {\n    const { cacheKey, cacheTTL = 5 * 60 * 1000, // 默认缓存5分钟\n    maxRetries = 2, retryDelay = 1000, // 默认重试延迟1秒\n    retryBackoff = 2, // 默认重试延迟倍数\n     } = options;\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [error, setError] = (0, react_1.useState)(null);\n    const abortControllerRef = (0, react_1.useRef)(null);\n    // 内存缓存\n    const cacheRef = (0, react_1.useRef)(new Map());\n    // 检查缓存是否有效\n    const isCacheValid = (0, react_1.useCallback)((entry) => {\n        return Date.now() - entry.timestamp < cacheTTL;\n    }, [cacheTTL]);\n    // 从缓存获取数据\n    const getFromCache = (0, react_1.useCallback)((key) => {\n        if (!cacheKey)\n            return null;\n        const fullKey = `${cacheKey}:${key}`;\n        const entry = cacheRef.current.get(fullKey);\n        if (entry && isCacheValid(entry)) {\n            return entry.data;\n        }\n        return null;\n    }, [cacheKey, isCacheValid]);\n    // 设置缓存\n    const setCache = (0, react_1.useCallback)((key, data) => {\n        if (!cacheKey)\n            return;\n        const fullKey = `${cacheKey}:${key}`;\n        cacheRef.current.set(fullKey, {\n            data,\n            timestamp: Date.now(),\n        });\n    }, [cacheKey]);\n    // 清除缓存\n    const clearCache = (0, react_1.useCallback)(() => {\n        if (!cacheKey)\n            return;\n        // 清除特定前缀的缓存\n        const keys = Array.from(cacheRef.current.keys());\n        for (const key of keys) {\n            if (key.startsWith(`${cacheKey}:`)) {\n                cacheRef.current.delete(key);\n            }\n        }\n    }, [cacheKey]);\n    // 延迟函数\n    const delay = (0, react_1.useCallback)((ms) => {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }, []);\n    // 发送请求\n    const sendRequest = (0, react_1.useCallback)((requestConfig, customCacheKey) => __awaiter(void 0, void 0, void 0, function* () {\n        const { url, options = {}, body } = requestConfig;\n        // 如果有缓存，直接返回缓存数据\n        const cacheData = getFromCache(customCacheKey || url);\n        if (cacheData) {\n            return cacheData;\n        }\n        // 取消之前的请求\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n        }\n        // 创建新的AbortController\n        abortControllerRef.current = new AbortController();\n        setIsLoading(true);\n        setError(null);\n        let retryCount = 0;\n        let currentRetryDelay = retryDelay;\n        const attemptRequest = () => __awaiter(void 0, void 0, void 0, function* () {\n            var _a;\n            try {\n                const fetchOptions = Object.assign(Object.assign({}, options), { signal: (_a = abortControllerRef.current) === null || _a === void 0 ? void 0 : _a.signal });\n                if (body) {\n                    fetchOptions.body = JSON.stringify(body);\n                    if (!fetchOptions.headers) {\n                        fetchOptions.headers = {};\n                    }\n                    fetchOptions.headers['Content-Type'] = 'application/json';\n                }\n                const response = yield fetch(url, fetchOptions);\n                if (!response.ok) {\n                    throw new Error(`HTTP error! status: ${response.status}`);\n                }\n                const data = yield response.json();\n                // 缓存响应数据\n                setCache(customCacheKey || url, data);\n                return data;\n            }\n            catch (err) {\n                // 如果是手动中止的错误，不重试\n                if (err instanceof Error && err.name === 'AbortError') {\n                    throw err;\n                }\n                retryCount++;\n                // 如果达到最大重试次数，抛出错误\n                if (retryCount > maxRetries) {\n                    setError(err);\n                    throw err;\n                }\n                // 指数退避重试\n                yield delay(currentRetryDelay);\n                currentRetryDelay *= retryBackoff;\n                // 递归重试\n                return attemptRequest();\n            }\n        });\n        try {\n            const result = yield attemptRequest();\n            return result;\n        }\n        finally {\n            setIsLoading(false);\n        }\n    }), [\n        getFromCache,\n        setCache,\n        retryDelay,\n        retryBackoff,\n        maxRetries,\n        delay,\n    ]);\n    // 取消请求\n    const cancelRequest = (0, react_1.useCallback)(() => {\n        if (abortControllerRef.current) {\n            abortControllerRef.current.abort();\n            abortControllerRef.current = null;\n        }\n        setIsLoading(false);\n    }, []);\n    return {\n        isLoading,\n        error,\n        sendRequest,\n        cancelRequest,\n        clearCache,\n    };\n};\nexports.useNetworkRequest = useNetworkRequest;\n/**\n * AI聊天专用的网络请求Hook\n * 针对AI聊天接口进行优化\n */\nconst useAIChatRequest = () => {\n    const { sendRequest, isLoading, error, clearCache } = (0, exports.useNetworkRequest)({\n        cacheKey: 'ai-chat',\n        cacheTTL: 10 * 60 * 1000, // AI聊天缓存10分钟\n        maxRetries: 3,\n        retryDelay: 1000,\n        retryBackoff: 1.5,\n    });\n    // 发送AI聊天请求\n    const sendChatRequest = (0, react_1.useCallback)((messages_1, ...args_1) => __awaiter(void 0, [messages_1, ...args_1], void 0, function* (messages, options = {}) {\n        const { model = \"sydf-v1-250520\", temperature = 0.7, stream = true } = options;\n        return sendRequest({\n            url: \"https://flow.ovo.gs/ai\",\n            options: {\n                method: \"POST\",\n            },\n            body: {\n                model,\n                messages,\n                temperature,\n                stream,\n            },\n        }, `chat:${JSON.stringify(messages.slice(-5))}`); // 使用最后5条消息作为缓存键\n    }), [sendRequest]);\n    return {\n        isLoading,\n        error,\n        sendChatRequest,\n        clearCache,\n    };\n};\nexports.useAIChatRequest = useAIChatRequest;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Item = void 0;\nconst react_1 = __importDefault(require(\"react\"));\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst Item = ({ title, content }) => {\n    return (react_1.default.createElement(\"li\", { className: (0, classnames_1.default)(\"iztro-palace-center-item\") },\n        react_1.default.createElement(\"label\", null, title),\n        react_1.default.createElement(\"span\", null, content)));\n};\nexports.Item = Item;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useChatLayout = void 0;\nconst react_1 = require(\"react\");\nconst layoutUtils_1 = require(\"../utils/layoutUtils\");\n/**\n * 聊天布局 Hook\n * 提供响应式布局管理和 CSS Grid 布局配置\n */\nconst useChatLayout = () => {\n    const [layoutConfig, setLayoutConfig] = (0, react_1.useState)((0, layoutUtils_1.getLayoutConfig)());\n    const [isInitialized, setIsInitialized] = (0, react_1.useState)(false);\n    // 更新布局配置\n    const updateLayout = (0, react_1.useCallback)((newConfig) => {\n        const updatedConfig = Object.assign(Object.assign({}, layoutConfig), newConfig);\n        setLayoutConfig(updatedConfig);\n        (0, layoutUtils_1.updateLayoutCSSVariables)(updatedConfig);\n    }, [layoutConfig]);\n    // 初始化布局\n    const initializeLayout = (0, react_1.useCallback)(() => {\n        const config = (0, layoutUtils_1.getLayoutConfig)();\n        (0, layoutUtils_1.updateLayoutCSSVariables)(config);\n        setLayoutConfig(config);\n        setIsInitialized(true);\n    }, []);\n    // 处理窗口大小变化\n    const handleResize = (0, react_1.useCallback)(() => {\n        const config = (0, layoutUtils_1.getLayoutConfig)();\n        updateLayout(config);\n    }, [updateLayout]);\n    // 处理移动端特殊布局\n    const handleMobileLayout = (0, react_1.useCallback)(() => {\n        if (!layoutConfig.isMobile)\n            return;\n        // 为移动端添加特殊的 body 类\n        document.body.classList.add('mobile-chat');\n        // 设置移动端特定的 CSS 变量\n        document.documentElement.style.setProperty('--chat-font-size', '16px');\n    }, [layoutConfig.isMobile]);\n    // 处理桌面端布局\n    const handleDesktopLayout = (0, react_1.useCallback)(() => {\n        document.body.classList.remove('mobile-chat');\n        document.documentElement.style.setProperty('--chat-font-size', '14px');\n    }, []);\n    // 初始化监听器\n    (0, react_1.useEffect)(() => {\n        if (isInitialized)\n            return;\n        // 初始化布局\n        initializeLayout();\n        // 创建布局观察器\n        const observer = (0, layoutUtils_1.createLayoutObserver)(handleResize);\n        observer.observe(document.documentElement);\n        // 监听窗口大小变化\n        window.addEventListener('resize', handleResize);\n        // 根据设备类型处理布局\n        if (layoutConfig.isMobile) {\n            handleMobileLayout();\n        }\n        else {\n            handleDesktopLayout();\n        }\n        return () => {\n            observer.disconnect();\n            window.removeEventListener('resize', handleResize);\n        };\n    }, [\n        isInitialized,\n        initializeLayout,\n        handleResize,\n        layoutConfig.isMobile,\n        handleMobileLayout,\n        handleDesktopLayout\n    ]);\n    // 监听设备类型变化\n    (0, react_1.useEffect)(() => {\n        const handleOrientationChange = () => {\n            const currentIsMobile = (0, layoutUtils_1.isMobileDevice)();\n            if (currentIsMobile !== layoutConfig.isMobile) {\n                updateLayout({ isMobile: currentIsMobile });\n            }\n        };\n        window.addEventListener('orientationchange', handleOrientationChange);\n        return () => {\n            window.removeEventListener('orientationchange', handleOrientationChange);\n        };\n    }, [layoutConfig.isMobile, updateLayout]);\n    // 生成 CSS Grid 模板样式\n    const getGridTemplateStyle = (0, react_1.useCallback)(() => {\n        if (layoutConfig.isMobile) {\n            // 检查键盘是否可见\n            const isKeyboardVisible = document.body.classList.contains('keyboard-visible');\n            if (isKeyboardVisible) {\n                return {\n                    gridTemplateRows: `\n            var(--header-height)\n            minmax(0, 1fr)\n            var(--keyboard-height)\n            auto\n          `,\n                };\n            }\n            return {\n                gridTemplateRows: `\n          var(--header-height)\n          minmax(0, 1fr)\n          auto\n        `,\n            };\n        }\n        return {\n            gridTemplateRows: '1fr auto',\n        };\n    }, [layoutConfig.isMobile]);\n    // 生成容器样式\n    const getContainerStyle = (0, react_1.useCallback)(() => {\n        const baseStyle = {\n            display: 'grid',\n            height: '100%',\n            minHeight: 0,\n            overflow: 'hidden',\n        };\n        if (layoutConfig.isMobile) {\n            return Object.assign(Object.assign(Object.assign({}, baseStyle), { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, height: '100dvh', width: '100%' }), getGridTemplateStyle());\n        }\n        return Object.assign(Object.assign({}, baseStyle), getGridTemplateStyle());\n    }, [layoutConfig.isMobile, getGridTemplateStyle]);\n    // 生成消息区域样式\n    const getMessagesContainerStyle = (0, react_1.useCallback)(() => {\n        const baseStyle = {\n            overflowY: 'auto',\n            minHeight: 0,\n            scrollSnapType: 'y proximity',\n        };\n        if (layoutConfig.isMobile) {\n            return Object.assign(Object.assign({}, baseStyle), { paddingTop: 'var(--safe-area-top)', paddingBottom: 'var(--safe-area-bottom)', \n                // 移除固定 margin 计算，使用 Grid 自动分配空间\n                marginTop: 0, marginBottom: 0 });\n        }\n        return Object.assign(Object.assign({}, baseStyle), { padding: '15px' });\n    }, [layoutConfig.isMobile]);\n    // 生成输入区域样式\n    const getInputContainerStyle = (0, react_1.useCallback)(() => {\n        const baseStyle = {\n            flexShrink: 0,\n            backgroundColor: 'var(--background-color)',\n        };\n        if (layoutConfig.isMobile) {\n            return Object.assign(Object.assign({}, baseStyle), { position: 'sticky', bottom: 0, zIndex: 100, paddingBottom: 'var(--safe-area-bottom)', borderTop: '1px solid var(--border-color)' });\n        }\n        return Object.assign(Object.assign({}, baseStyle), { padding: '10px' });\n    }, [layoutConfig.isMobile]);\n    return {\n        layoutConfig,\n        isInitialized,\n        getContainerStyle,\n        getMessagesContainerStyle,\n        getInputContainerStyle,\n        updateLayout,\n    };\n};\nexports.useChatLayout = useChatLayout;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst iztro_hook_1 = require(\"iztro-hook\");\nconst AppContainer_1 = require(\"./containers/AppContainer\");\nconst ResultContainer_1 = require(\"./containers/ResultContainer\");\nconst AIChatContext_1 = require(\"./AIChat/AIChatContext\");\nconst useHistoryManager_1 = require(\"./hooks/useHistoryManager\");\nconst FormPanel_1 = __importDefault(require(\"./components/FormPanel\"));\nconst HistoryModal_1 = __importDefault(require(\"./components/HistoryModal\"));\nrequire(\"./styles/index.css\");\nrequire(\"./styles/history-modal.css\");\nfunction App() {\n    // 控制当前模式（排盘或合盘）\n    const [chartMode, setChartMode] = (0, react_1.useState)(\"single\");\n    // 初始化表单状态\n    const [formData, setFormData] = (0, react_1.useState)({\n        name: \"\",\n        year: \"\",\n        month: \"\",\n        day: \"\",\n        birthTime: 0,\n        birthdayType: \"solar\",\n        gender: \"male\",\n    });\n    // 初始化合盘表单状态\n    const [synastryData, setSynastryData] = (0, react_1.useState)({\n        person1: {\n            name: \"\",\n            year: \"\",\n            month: \"\",\n            day: \"\",\n            birthTime: 0,\n            birthdayType: \"solar\",\n            gender: \"male\",\n        },\n        person2: {\n            name: \"\",\n            year: \"\",\n            month: \"\",\n            day: \"\",\n            birthTime: 0,\n            birthdayType: \"solar\",\n            gender: \"female\",\n        },\n    });\n    // 控制星盘显示的状态\n    const [showAstrolabe, setShowAstrolabe] = (0, react_1.useState)(false);\n    // 控制输入面板显示的状态\n    const [showInputPanel, setShowInputPanel] = (0, react_1.useState)(true);\n    // 使用历史管理Hook\n    const { history, showHistoryModal, setShowHistoryModal, searchTerm, setSearchTerm, showPasswordInput, setShowPasswordInput, password, setPassword, isCloudStorageEnabled, isLoading, editingHistoryId, setEditingHistoryId, handlePasswordSubmit, handleSaveHistory, handleDeleteHistory, handleClearHistory, } = (0, useHistoryManager_1.useHistoryManager)();\n    // 获取星盘数据\n    const { astrolabe } = (0, iztro_hook_1.useIztro)({\n        birthday: `${formData.year}-${String(formData.month).padStart(2, '0')}-${String(formData.day).padStart(2, '0')}`,\n        birthTime: formData.birthTime,\n        gender: formData.gender,\n        birthdayType: formData.birthdayType,\n    });\n    // 获取第一个人星盘数据\n    const { astrolabe: astrolabe1 } = (0, iztro_hook_1.useIztro)({\n        birthday: `${synastryData.person1.year}-${String(synastryData.person1.month).padStart(2, '0')}-${String(synastryData.person1.day).padStart(2, '0')}`,\n        birthTime: synastryData.person1.birthTime,\n        gender: synastryData.person1.gender,\n        birthdayType: synastryData.person1.birthdayType,\n    });\n    // 获取第二个人星盘数据\n    const { astrolabe: astrolabe2 } = (0, iztro_hook_1.useIztro)({\n        birthday: `${synastryData.person2.year}-${String(synastryData.person2.month).padStart(2, '0')}-${String(synastryData.person2.day).padStart(2, '0')}`,\n        birthTime: synastryData.person2.birthTime,\n        gender: synastryData.person2.gender,\n        birthdayType: synastryData.person2.birthdayType,\n    });\n    // 从URL参数中读取数据并设置表单状态\n    (0, react_1.useEffect)(() => {\n        const urlParams = new URLSearchParams(window.location.search);\n        // 从URL参数中读取各个字段\n        const name = urlParams.get('n') || \"\";\n        const year = urlParams.get('y') || \"\";\n        const month = urlParams.get('m') || \"\";\n        const day = urlParams.get('d') || \"\";\n        const birthTime = urlParams.get('t') ? parseInt(urlParams.get('t') || \"1\") : 0;\n        const birthdayType = urlParams.get('type') || \"solar\";\n        const gender = urlParams.get('g') || \"male\";\n        // 检查是否有完整的日期参数（年、月、日都是必需的）\n        const hasCompleteDateParams = !!(urlParams.get('y') && urlParams.get('m') && urlParams.get('d'));\n        setFormData({\n            name,\n            year,\n            month,\n            day,\n            birthTime,\n            birthdayType,\n            gender,\n        });\n        // 只有当日期参数完整时才显示星盘，否则显示输入页面\n        if (hasCompleteDateParams) {\n            setShowAstrolabe(true);\n            setShowInputPanel(false);\n        }\n        else {\n            setShowAstrolabe(false);\n            setShowInputPanel(true);\n        }\n    }, []);\n    // 动态更新主题颜色以适应暗色模式\n    (0, react_1.useEffect)(() => {\n        const updateThemeColor = (isDarkMode) => {\n            const themeColor = isDarkMode ? \"#1B1B1B\" : \"#ffffff\";\n            let metaThemeColor = document.querySelector(\"meta[name=theme-color]\");\n            if (metaThemeColor) {\n                metaThemeColor.setAttribute(\"content\", themeColor);\n            }\n            else {\n                metaThemeColor = document.createElement(\"meta\");\n                metaThemeColor.setAttribute(\"name\", \"theme-color\");\n                metaThemeColor.setAttribute(\"content\", themeColor);\n                document.getElementsByTagName(\"head\")[0].appendChild(metaThemeColor);\n            }\n        };\n        const darkModeMediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n        // 初始化主题颜色\n        updateThemeColor(darkModeMediaQuery.matches);\n        // 监听主题变化\n        const darkModeListener = (e) => {\n            updateThemeColor(e.matches);\n        };\n        darkModeMediaQuery.addEventListener(\"change\", darkModeListener);\n        // 清理监听器\n        return () => {\n            darkModeMediaQuery.removeEventListener(\"change\", darkModeListener);\n        };\n    }, []);\n    // 将表单数据编码到URL参数中\n    const updateUrlParams = (0, react_1.useCallback)((data) => {\n        try {\n            // 构建查询参数\n            const params = new URLSearchParams();\n            // 添加所有参数\n            if (data.name)\n                params.set('n', data.name);\n            params.set('y', data.year);\n            params.set('m', data.month);\n            params.set('d', data.day);\n            params.set('t', data.birthTime.toString());\n            params.set('type', data.birthdayType);\n            params.set('g', data.gender);\n            const newUrl = `${window.location.pathname}?${params.toString()}`;\n            window.history.replaceState({}, '', newUrl);\n        }\n        catch (error) {\n            console.error(\"编码URL参数失败:\", error);\n        }\n    }, []);\n    // 处理历史记录加载\n    const handleLoadHistory = (0, react_1.useCallback)((item) => {\n        if (item.type === 'single') {\n            setFormData({\n                name: item.name,\n                year: item.year,\n                month: item.month,\n                day: item.day,\n                birthTime: item.birthTime,\n                birthdayType: item.birthdayType,\n                gender: item.gender,\n            });\n            setChartMode('single');\n            updateUrlParams({\n                name: item.name,\n                year: item.year,\n                month: item.month,\n                day: item.day,\n                birthTime: item.birthTime,\n                birthdayType: item.birthdayType,\n                gender: item.gender,\n            });\n            setShowAstrolabe(true);\n            setShowInputPanel(false);\n        }\n        else {\n            setSynastryData({\n                person1: {\n                    name: item.name,\n                    year: item.year,\n                    month: item.month,\n                    day: item.day,\n                    birthTime: item.birthTime,\n                    birthdayType: item.birthdayType,\n                    gender: item.gender,\n                },\n                person2: item.person2 || {\n                    name: \"\",\n                    year: \"\",\n                    month: \"\",\n                    day: \"\",\n                    birthTime: 0,\n                    birthdayType: \"solar\",\n                    gender: \"female\",\n                }\n            });\n            setChartMode('synastry');\n            setShowAstrolabe(true);\n            setShowInputPanel(false);\n        }\n    }, [updateUrlParams]);\n    // 处理历史记录编辑\n    const handleEditHistory = (0, react_1.useCallback)((item) => {\n        if (item.type === 'single') {\n            setFormData({\n                name: item.name,\n                year: item.year,\n                month: item.month,\n                day: item.day,\n                birthTime: item.birthTime,\n                birthdayType: item.birthdayType,\n                gender: item.gender,\n            });\n            setChartMode('single');\n        }\n        else {\n            setSynastryData({\n                person1: {\n                    name: item.name,\n                    year: item.year,\n                    month: item.month,\n                    day: item.day,\n                    birthTime: item.birthTime,\n                    birthdayType: item.birthdayType,\n                    gender: item.gender,\n                },\n                person2: item.person2 || {\n                    name: \"\",\n                    year: \"\",\n                    month: \"\",\n                    day: \"\",\n                    birthTime: 0,\n                    birthdayType: \"solar\",\n                    gender: \"female\",\n                }\n            });\n            setChartMode('synastry');\n        }\n    }, []);\n    // 处理显示输入面板\n    const handleShowInputPanel = (0, react_1.useCallback)(() => {\n        setShowInputPanel(true);\n        setShowAstrolabe(false);\n        window.history.replaceState({}, '', window.location.pathname);\n        setEditingHistoryId(null);\n    }, []);\n    return (react_1.default.createElement(AppContainer_1.AppContainer, null,\n        react_1.default.createElement(AIChatContext_1.AIChatProvider, null,\n            react_1.default.createElement(\"div\", { className: \"content\" },\n                showInputPanel && (react_1.default.createElement(FormPanel_1.default, { chartMode: chartMode, setChartMode: setChartMode, formData: formData, synastryData: synastryData, onFormChange: setFormData, onSynastryChange: (person, data) => setSynastryData(Object.assign(Object.assign({}, synastryData), { [person]: data })), onRadioChange: (name, value) => setFormData(Object.assign(Object.assign({}, formData), { [name]: value })), onSynastryRadioChange: (person, name, value) => setSynastryData(Object.assign(Object.assign({}, synastryData), { [person]: Object.assign(Object.assign({}, synastryData[person]), { [name]: value }) })), onShowHistory: () => setShowHistoryModal(true), onSubmit: (e) => e.preventDefault(), onSynastrySubmit: (e) => e.preventDefault(), onSaveHistory: handleSaveHistory, updateUrlParams: updateUrlParams, setShowAstrolabe: setShowAstrolabe, setShowInputPanel: setShowInputPanel })),\n                react_1.default.createElement(HistoryModal_1.default, { history: history, showHistoryModal: showHistoryModal, setShowHistoryModal: setShowHistoryModal, searchTerm: searchTerm, setSearchTerm: setSearchTerm, showPasswordInput: showPasswordInput, setShowPasswordInput: setShowPasswordInput, password: password, setPassword: setPassword, isCloudStorageEnabled: isCloudStorageEnabled, isLoading: isLoading, editingHistoryId: editingHistoryId, setEditingHistoryId: setEditingHistoryId, handlePasswordSubmit: handlePasswordSubmit, handleDeleteHistory: handleDeleteHistory, handleClearHistory: handleClearHistory, onLoadHistory: handleLoadHistory, onEditHistory: handleEditHistory, chartMode: chartMode }),\n                showAstrolabe && (react_1.default.createElement(ResultContainer_1.ResultContainer, { chartMode: chartMode, formData: formData, synastryData: synastryData, astrolabe: astrolabe, astrolabe1: astrolabe1, astrolabe2: astrolabe2, onShowInputPanel: handleShowInputPanel }))))));\n}\nexports.default = react_1.default.memo(App);\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IzpalaceCenter = void 0;\nconst classnames_1 = __importDefault(require(\"classnames\"));\nconst react_1 = __importStar(require(\"react\"));\nconst Item_1 = require(\"./Item\");\nrequire(\"../styles/index.css\");\nconst Line_1 = require(\"./Line\");\nconst utils_1 = require(\"iztro/lib/utils\");\nconst lunar_lite_1 = require(\"lunar-lite\");\nconst i18n_1 = require(\"iztro/lib/i18n\");\nconst data_1 = require(\"iztro/lib/data\");\nconst IzpalaceCenter = ({ astrolabe, horoscope, arrowIndex, arrowScope, horoscopeDate = new Date(), horoscopeHour = 0, setHoroscopeDate, setHoroscopeHour, centerPalaceAlign, }) => {\n    var _a, _b;\n    const records = (0, react_1.useMemo)(() => [\n        {\n            title: \"五行局：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.fiveElementsClass,\n        },\n        {\n            title: \"年龄(虚岁)：\",\n            content: `${horoscope === null || horoscope === void 0 ? void 0 : horoscope.age.nominalAge} 岁`,\n        },\n        {\n            title: \"四柱：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.chineseDate,\n        },\n        {\n            title: \"阳历：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.solarDate,\n        },\n        {\n            title: \"农历：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.lunarDate,\n        },\n        {\n            title: \"时辰：\",\n            content: `${astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.time}(${astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.timeRange})`,\n        },\n        {\n            title: \"生肖：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.zodiac,\n        },\n        {\n            title: \"星座：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.sign,\n        },\n        {\n            title: \"命主：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.soul,\n        },\n        {\n            title: \"身主：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.body,\n        },\n        {\n            title: \"命宫：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.earthlyBranchOfSoulPalace,\n        },\n        {\n            title: \"身宫：\",\n            content: astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.earthlyBranchOfBodyPalace,\n        },\n    ], [astrolabe, horoscope]);\n    const horoDate = (0, react_1.useMemo)(() => {\n        const dateStr = horoscopeDate !== null && horoscopeDate !== void 0 ? horoscopeDate : new Date();\n        const [year, month, date] = (0, lunar_lite_1.normalizeDateStr)(dateStr);\n        const dt = new Date(year, month - 1, date);\n        return {\n            solar: `${year}-${month}-${date}`,\n            lunar: (0, lunar_lite_1.solar2lunar)(dateStr).toString(true),\n            prevDecadalDisabled: dt.setFullYear(dt.getFullYear() - 1),\n        };\n    }, [horoscopeDate]);\n    const onHoroscopeButtonClicked = (scope, value) => {\n        if (!(astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.solarDate)) {\n            return true;\n        }\n        const [year, month, date] = (0, lunar_lite_1.normalizeDateStr)(horoscopeDate);\n        const dt = new Date(year, month - 1, date);\n        const [birthYear, birthMonth, birthDate] = (0, lunar_lite_1.normalizeDateStr)(astrolabe.solarDate);\n        const birthday = new Date(birthYear, birthMonth - 1, birthDate);\n        let hour = horoscopeHour;\n        switch (scope) {\n            case \"hourly\":\n                hour = horoscopeHour + value;\n                if (horoscopeHour + value > 11) {\n                    // 如果大于亥时，则加一天，时辰变为早子时\n                    dt.setDate(dt.getDate() + 1);\n                    hour = 0;\n                }\n                else if (horoscopeHour + value < 0) {\n                    // 如果小于早子时，则减一天，时辰变为亥时\n                    dt.setDate(dt.getDate() - 1);\n                    hour = 11;\n                }\n                break;\n            case \"daily\":\n                dt.setDate(dt.getDate() + value);\n                break;\n            case \"monthly\":\n                dt.setMonth(dt.getMonth() + value);\n                break;\n            case \"yearly\":\n            case \"decadal\":\n                dt.setFullYear(dt.getFullYear() + value);\n                break;\n        }\n        if (dt.getTime() >= birthday.getTime()) {\n            setHoroscopeDate === null || setHoroscopeDate === void 0 ? void 0 : setHoroscopeDate(dt);\n            setHoroscopeHour === null || setHoroscopeHour === void 0 ? void 0 : setHoroscopeHour(hour);\n        }\n    };\n    const shouldBeDisabled = (0, react_1.useCallback)((dateStr, scope, value) => {\n        if (!(astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.solarDate)) {\n            return true;\n        }\n        const [year, month, date] = (0, lunar_lite_1.normalizeDateStr)(dateStr);\n        const dt = new Date(year, month - 1, date);\n        const [birthYear, birthMonth, birthDate] = (0, lunar_lite_1.normalizeDateStr)(astrolabe.solarDate);\n        const birthday = new Date(birthYear, birthMonth - 1, birthDate);\n        switch (scope) {\n            case \"hourly\":\n                if (horoscopeHour + value > 11) {\n                    dt.setDate(dt.getDate() + 1);\n                }\n                else if (horoscopeHour + value < 0) {\n                    dt.setDate(dt.getDate() - 1);\n                }\n                break;\n            case \"daily\":\n                dt.setDate(dt.getDate() + value);\n                break;\n            case \"monthly\":\n                dt.setMonth(dt.getMonth() + value);\n                break;\n            case \"yearly\":\n            case \"decadal\":\n                dt.setFullYear(dt.getFullYear() + value);\n                break;\n        }\n        if (dt.getTime() < birthday.getTime()) {\n            return true;\n        }\n        return false;\n    }, [horoscopeHour, astrolabe]);\n    return (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"iztro-center-palace\", {\n            \"iztro-center-palace-centralize\": centerPalaceAlign,\n        }) },\n        (astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.earthlyBranchOfSoulPalace) && (react_1.default.createElement(Line_1.Line, { scope: arrowScope, index: arrowIndex !== null && arrowIndex !== void 0 ? arrowIndex : (0, utils_1.fixEarthlyBranchIndex)(astrolabe.earthlyBranchOfSoulPalace) })),\n        react_1.default.createElement(\"h3\", { className: \"center-title\" },\n            react_1.default.createElement(\"span\", { className: `gender gender-${(0, i18n_1.kot)((_a = astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.gender) !== null && _a !== void 0 ? _a : \"\")}` }, (0, i18n_1.kot)((_b = astrolabe === null || astrolabe === void 0 ? void 0 : astrolabe.gender) !== null && _b !== void 0 ? _b : \"\") === \"male\" ? \"♂\" : \"♀\"),\n            react_1.default.createElement(\"span\", null, \"\\u57FA\\u672C\\u4FE1\\u606F\")),\n        react_1.default.createElement(\"ul\", { className: \"basic-info\" }, records.map((rec, idx) => (react_1.default.createElement(Item_1.Item, Object.assign({ key: idx }, rec))))),\n        react_1.default.createElement(\"h3\", { className: \"center-title\" }, \"\\u8FD0\\u9650\\u4FE1\\u606F\"),\n        react_1.default.createElement(\"ul\", { className: \"basic-info\" },\n            react_1.default.createElement(Item_1.Item, { title: \"\\u519C\\u5386\\uFF1A\", content: horoDate.lunar }),\n            react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(\"solar-horoscope\", {\n                    \"solar-horoscope-centralize\": centerPalaceAlign,\n                }) },\n                react_1.default.createElement(Item_1.Item, { title: \"\\u9633\\u5386\\uFF1A\", content: horoDate.solar }),\n                react_1.default.createElement(\"span\", { className: \"today\", onClick: () => setHoroscopeDate === null || setHoroscopeDate === void 0 ? void 0 : setHoroscopeDate(new Date()) }, \"\\u4ECA\"))),\n        react_1.default.createElement(\"div\", { className: \"horo-buttons\" },\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"yearly\", -10),\n                }), onClick: () => onHoroscopeButtonClicked(\"yearly\", -10) }, \"\\u25C0\\u9650\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"yearly\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"yearly\", -1) }, \"\\u25C0\\u5E74\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"monthly\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"monthly\", -1) }, \"\\u25C0\\u6708\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"daily\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"daily\", -1) }, \"\\u25C0\\u65E5\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\", {\n                    disabled: shouldBeDisabled(horoDate.solar, \"hourly\", -1),\n                }), onClick: () => onHoroscopeButtonClicked(\"hourly\", -1) }, \"\\u25C0\\u65F6\"),\n            react_1.default.createElement(\"span\", { className: \"center-horo-hour\" }, (0, i18n_1.t)(data_1.CHINESE_TIME[horoscopeHour])),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"hourly\", 1) }, \"\\u65F6\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"daily\", 1) }, \"\\u65E5\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"monthly\", 1) }, \"\\u6708\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"yearly\", 1) }, \"\\u5E74\\u25B6\"),\n            react_1.default.createElement(\"span\", { className: (0, classnames_1.default)(\"center-button\"), onClick: () => onHoroscopeButtonClicked(\"yearly\", 10) }, \"\\u9650\\u25B6\"))));\n};\nexports.IzpalaceCenter = IzpalaceCenter;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst ScrollToBottomButton = ({ isVisible, onClick }) => {\n    if (!isVisible)\n        return null;\n    return (react_1.default.createElement(\"button\", { className: `scroll-to-bottom-button ${isVisible ? 'visible' : ''}`, onClick: onClick, \"aria-label\": \"\\u6EDA\\u52A8\\u5230\\u5E95\\u90E8\" },\n        react_1.default.createElement(\"svg\", { width: \"20\", height: \"20\", viewBox: \"0 0 24 24\", fill: \"none\", stroke: \"currentColor\", strokeWidth: \"2\", strokeLinecap: \"round\", strokeLinejoin: \"round\" },\n            react_1.default.createElement(\"polyline\", { points: \"6 9 12 15 18 9\" }))));\n};\nexports.default = react_1.default.memo(ScrollToBottomButton);\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst AIChatContext_1 = require(\"./AIChatContext\");\nconst BackgroundAIIndicator = () => {\n    const { isGeneratingInBackground } = (0, AIChatContext_1.useAIChat)();\n    if (!isGeneratingInBackground) {\n        return null;\n    }\n    return (react_1.default.createElement(\"div\", { className: \"background-ai-indicator\" },\n        react_1.default.createElement(\"div\", { className: \"indicator-content\" },\n            react_1.default.createElement(\"div\", { className: \"typing-indicator\" },\n                react_1.default.createElement(\"span\", null),\n                react_1.default.createElement(\"span\", null),\n                react_1.default.createElement(\"span\", null)),\n            react_1.default.createElement(\"span\", { className: \"indicator-text\" }, \"AI\\u6B63\\u5728\\u540E\\u53F0\\u751F\\u6210...\"))));\n};\nexports.default = BackgroundAIIndicator;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AppContainer = void 0;\nconst react_1 = __importDefault(require(\"react\"));\nconst useKeyboardDetector_1 = require(\"../utils/useKeyboardDetector\");\n/**\n * 应用容器组件\n * 负责处理全局布局、键盘检测和安全区域适配\n */\nconst AppContainer = ({ children }) => {\n    const { isKeyboardVisible } = (0, useKeyboardDetector_1.useKeyboardDetector)();\n    const safeArea = (0, useKeyboardDetector_1.useSafeArea)();\n    return (react_1.default.createElement(\"div\", { className: `App ${isKeyboardVisible ? 'keyboard-visible' : ''}` }, children));\n};\nexports.AppContainer = AppContainer;\nexports.default = exports.AppContainer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useMessageStorage = void 0;\nconst react_1 = require(\"react\");\n/**\n * 消息存储和分页Hook\n * 实现消息的本地存储和分页加载，优化内存使用\n */\nconst useMessageStorage = ({ maxMessagesInMemory = 100, pageSize = 20, storageKey = 'ai-chat-messages' } = {}) => {\n    const [allMessages, setAllMessages] = (0, react_1.useState)([]);\n    const [visibleMessages, setVisibleMessages] = (0, react_1.useState)([]);\n    const [currentPage, setCurrentPage] = (0, react_1.useState)(1);\n    const [isLoading, setIsLoading] = (0, react_1.useState)(false);\n    const [hasMore, setHasMore] = (0, react_1.useState)(true);\n    // 从本地存储加载消息\n    const loadMessagesFromStorage = (0, react_1.useCallback)(() => {\n        try {\n            const storedMessages = localStorage.getItem(storageKey);\n            if (storedMessages) {\n                const parsedMessages = JSON.parse(storedMessages);\n                // 验证消息格式\n                if (Array.isArray(parsedMessages) && parsedMessages.every(msg => msg && typeof msg === 'object' &&\n                    (msg.role === 'user' || msg.role === 'assistant') &&\n                    typeof msg.content === 'string')) {\n                    return parsedMessages;\n                }\n            }\n        }\n        catch (error) {\n            console.error('从本地存储加载消息失败:', error);\n        }\n        return [];\n    }, [storageKey]);\n    // 保存消息到本地存储\n    const saveMessagesToStorage = (0, react_1.useCallback)((messages) => {\n        try {\n            localStorage.setItem(storageKey, JSON.stringify(messages));\n        }\n        catch (error) {\n            console.error('保存消息到本地存储失败:', error);\n            // 如果存储失败，可能是存储空间不足，尝试清理旧消息\n            try {\n                // 保留最近的消息\n                const recentMessages = messages.slice(-maxMessagesInMemory);\n                localStorage.setItem(storageKey, JSON.stringify(recentMessages));\n            }\n            catch (cleanupError) {\n                console.error('清理旧消息失败:', cleanupError);\n            }\n        }\n    }, [storageKey, maxMessagesInMemory]);\n    // 初始化时从本地存储加载消息\n    (0, react_1.useEffect)(() => {\n        const messages = loadMessagesFromStorage();\n        setAllMessages(messages);\n        // 计算初始可见消息\n        const initialVisible = messages.slice(-pageSize);\n        setVisibleMessages(initialVisible);\n        setCurrentPage(1);\n        setHasMore(messages.length > pageSize);\n    }, [loadMessagesFromStorage, pageSize]);\n    // 添加新消息\n    const addMessages = (0, react_1.useCallback)((newMessages) => {\n        setAllMessages(prev => {\n            const updated = [...prev, ...newMessages];\n            // 限制内存中的消息数量\n            if (updated.length > maxMessagesInMemory) {\n                // 保留最新的消息\n                const trimmed = updated.slice(-maxMessagesInMemory);\n                saveMessagesToStorage(trimmed);\n                return trimmed;\n            }\n            saveMessagesToStorage(updated);\n            return updated;\n        });\n        // 如果当前在最后一页，更新可见消息\n        setVisibleMessages(prev => [...prev, ...newMessages]);\n    }, [maxMessagesInMemory, saveMessagesToStorage]);\n    // 加载更多消息（分页）\n    const loadMoreMessages = (0, react_1.useCallback)(() => {\n        if (isLoading || !hasMore)\n            return;\n        setIsLoading(true);\n        // 使用setTimeout避免阻塞UI\n        setTimeout(() => {\n            const nextPage = currentPage + 1;\n            const startIndex = Math.max(0, allMessages.length - nextPage * pageSize);\n            const endIndex = allMessages.length - (nextPage - 1) * pageSize;\n            if (startIndex <= 0) {\n                // 已经到达第一页\n                const newVisibleMessages = allMessages.slice(0, endIndex);\n                setVisibleMessages(newVisibleMessages);\n                setHasMore(false);\n            }\n            else {\n                // 加载上一页的消息\n                const newMessages = allMessages.slice(startIndex, endIndex);\n                setVisibleMessages(prev => [...newMessages, ...prev]);\n                setCurrentPage(nextPage);\n            }\n            setIsLoading(false);\n        }, 0);\n    }, [allMessages, currentPage, hasMore, isLoading, pageSize]);\n    // 清空所有消息\n    const clearMessages = (0, react_1.useCallback)(() => {\n        setAllMessages([]);\n        setVisibleMessages([]);\n        setCurrentPage(1);\n        setHasMore(false);\n        try {\n            localStorage.removeItem(storageKey);\n        }\n        catch (error) {\n            console.error('清空本地存储失败:', error);\n        }\n    }, [storageKey]);\n    // 重置到最新消息\n    const resetToLatest = (0, react_1.useCallback)(() => {\n        const latestMessages = allMessages.slice(-pageSize);\n        setVisibleMessages(latestMessages);\n        setCurrentPage(1);\n        setHasMore(allMessages.length > pageSize);\n    }, [allMessages, pageSize]);\n    return {\n        allMessages,\n        visibleMessages,\n        currentPage,\n        isLoading,\n        hasMore,\n        addMessages,\n        loadMoreMessages,\n        clearMessages,\n        resetToLatest\n    };\n};\nexports.useMessageStorage = useMessageStorage;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useSafeArea = exports.useKeyboardDetector = void 0;\nconst react_1 = require(\"react\");\n/**\n * 键盘检测Hook\n * 用于检测虚拟键盘的显示状态和高度\n */\nconst useKeyboardDetector = () => {\n    const [isKeyboardVisible, setIsKeyboardVisible] = (0, react_1.useState)(false);\n    const [keyboardHeight, setKeyboardHeight] = (0, react_1.useState)(0);\n    (0, react_1.useEffect)(() => {\n        // 检测是否为移动设备\n        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        if (!isMobile) {\n            return; // 非移动设备不进行键盘检测\n        }\n        const handleResize = () => {\n            var _a, _b;\n            const viewportHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || window.innerHeight;\n            const windowHeight = window.innerHeight;\n            const screenHeight = ((_b = window.screen) === null || _b === void 0 ? void 0 : _b.height) || windowHeight;\n            // 计算键盘高度\n            const calculatedKeyboardHeight = windowHeight - viewportHeight;\n            // 判断键盘是否可见（高度变化超过100px认为是键盘弹出）\n            const isKeyboardNowVisible = calculatedKeyboardHeight > 100;\n            setIsKeyboardVisible(isKeyboardNowVisible);\n            setKeyboardHeight(isKeyboardNowVisible ? calculatedKeyboardHeight : 0);\n            // 更新CSS变量\n            document.documentElement.style.setProperty('--keyboard-height', `${isKeyboardNowVisible ? calculatedKeyboardHeight : 0}px`);\n            document.documentElement.style.setProperty('--is-keyboard-visible', isKeyboardNowVisible ? 'true' : 'false');\n            // 更新body的class\n            if (isKeyboardNowVisible) {\n                document.body.classList.add('keyboard-visible');\n            }\n            else {\n                document.body.classList.remove('keyboard-visible');\n            }\n        };\n        // 初始检测\n        handleResize();\n        // 使用visualViewport事件监听（如果支持）\n        if (window.visualViewport) {\n            window.visualViewport.addEventListener('resize', handleResize);\n            window.visualViewport.addEventListener('scroll', handleResize);\n        }\n        else {\n            // 回退到window的resize事件\n            window.addEventListener('resize', handleResize);\n        }\n        // 监听输入框的focus和blur事件\n        const handleFocusIn = (e) => {\n            const target = e.target;\n            if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n                // 延迟检测，确保键盘已经弹出\n                setTimeout(handleResize, 100);\n            }\n        };\n        const handleFocusOut = (e) => {\n            const target = e.target;\n            if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n                // 延迟检测，确保键盘已经收起\n                setTimeout(handleResize, 300);\n            }\n        };\n        document.addEventListener('focusin', handleFocusIn);\n        document.addEventListener('focusout', handleFocusOut);\n        // 清理函数\n        return () => {\n            if (window.visualViewport) {\n                window.visualViewport.removeEventListener('resize', handleResize);\n                window.visualViewport.removeEventListener('scroll', handleResize);\n            }\n            else {\n                window.removeEventListener('resize', handleResize);\n            }\n            document.removeEventListener('focusin', handleFocusIn);\n            document.removeEventListener('focusout', handleFocusOut);\n        };\n    }, []);\n    return { isKeyboardVisible, keyboardHeight };\n};\nexports.useKeyboardDetector = useKeyboardDetector;\n/**\n * 安全区域检测Hook\n * 用于获取设备的安全区域信息\n */\nconst useSafeArea = () => {\n    const [safeArea, setSafeArea] = (0, react_1.useState)({\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n    });\n    (0, react_1.useEffect)(() => {\n        const updateSafeArea = () => {\n            // 创建一个临时元素来获取CSS变量值\n            const tempElement = document.createElement('div');\n            tempElement.style.position = 'absolute';\n            tempElement.style.top = '-9999px';\n            tempElement.style.left = '-9999px';\n            document.body.appendChild(tempElement);\n            // 获取计算后的样式\n            const computedStyle = window.getComputedStyle(tempElement);\n            const newSafeArea = {\n                top: parseInt(computedStyle.getPropertyValue('--safe-area-inset-top')) || 0,\n                right: parseInt(computedStyle.getPropertyValue('--safe-area-inset-right')) || 0,\n                bottom: parseInt(computedStyle.getPropertyValue('--safe-area-inset-bottom')) || 0,\n                left: parseInt(computedStyle.getPropertyValue('--safe-area-inset-left')) || 0,\n            };\n            // 移除临时元素\n            document.body.removeChild(tempElement);\n            setSafeArea(newSafeArea);\n        };\n        // 初始更新\n        updateSafeArea();\n        // 监听窗口大小变化（安全区域可能在旋转屏幕时改变）\n        window.addEventListener('resize', updateSafeArea);\n        window.addEventListener('orientationchange', updateSafeArea);\n        return () => {\n            window.removeEventListener('resize', updateSafeArea);\n            window.removeEventListener('orientationchange', updateSafeArea);\n        };\n    }, []);\n    return safeArea;\n};\nexports.useSafeArea = useSafeArea;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst FormContainer_1 = require(\"../containers/FormContainer\");\nconst FormPanel = ({ chartMode, setChartMode, formData, synastryData, onFormChange, onSynastryChange, onRadioChange, onSynastryRadioChange, onShowHistory, onSubmit, onSynastrySubmit, onSaveHistory, updateUrlParams, setShowAstrolabe, setShowInputPanel, }) => {\n    const handleSubmit = (0, react_1.useCallback)((e) => {\n        e.preventDefault();\n        if (!formData.year || !formData.month || !formData.day) {\n            alert(\"请填写完整的日期信息（年、月、日）\");\n            return;\n        }\n        // 如果有姓名，保存到历史记录\n        if (formData.name.trim()) {\n            onSaveHistory(Object.assign(Object.assign({}, formData), { type: 'single' }));\n        }\n        updateUrlParams(formData);\n        setShowAstrolabe(true);\n        setShowInputPanel(false);\n    }, [formData, onSaveHistory, updateUrlParams, setShowAstrolabe, setShowInputPanel]);\n    const handleSynastrySubmit = (0, react_1.useCallback)((e) => {\n        e.preventDefault();\n        if (!synastryData.person1.year || !synastryData.person1.month || !synastryData.person1.day) {\n            alert(\"请填写第一个人的完整日期信息（年、月、日）\");\n            return;\n        }\n        if (!synastryData.person2.year || !synastryData.person2.month || !synastryData.person2.day) {\n            alert(\"请填写第二个人的完整日期信息（年、月、日）\");\n            return;\n        }\n        // 如果有任意一个人的姓名，保存到历史记录\n        if (synastryData.person1.name.trim() || synastryData.person2.name.trim()) {\n            onSaveHistory(Object.assign(Object.assign({}, synastryData.person1), { type: 'synastry', person2: synastryData.person2 }));\n        }\n        setShowAstrolabe(true);\n        setShowInputPanel(false);\n    }, [synastryData, onSaveHistory, setShowAstrolabe, setShowInputPanel]);\n    return (react_1.default.createElement(FormContainer_1.FormContainer, { chartMode: chartMode, setChartMode: setChartMode, formData: formData, synastryData: synastryData, onFormChange: onFormChange, onSynastryChange: onSynastryChange, onRadioChange: onRadioChange, onSynastryRadioChange: onSynastryRadioChange, onShowHistory: onShowHistory, onSubmit: handleSubmit, onSynastrySubmit: handleSynastrySubmit }));\n};\nexports.default = react_1.default.memo(FormPanel);\n"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","useHistoryManager","react_1","historyUtils_1","history","setHistory","useState","showHistoryModal","setShowHistoryModal","searchTerm","setSearchTerm","showPasswordInput","setShowPasswordInput","password","setPassword","isCloudStorageEnabled","setIsCloudStorageEnabled","isLoading","setIsLoading","editingHistoryId","setEditingHistoryId","useEffect","HistoryManager","initialize","getHistoryWithCloudSync","handlePasswordSubmit","useCallback","trim","enableCloudStorage","alert","error","handleSaveHistory","item","updateHistory","saveHistory","getHistory","handleDeleteHistory","id","deleteHistory","handleClearHistory","confirm","clearHistory","filter","_a","name","toLowerCase","includes","type","person2","year","month","day","ownKeys","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","__setModuleDefault","v","__importStar","getOwnPropertyNames","ar","prototype","hasOwnProperty","call","length","mod","i","useAIChat","AIChatProvider","STORAGE_KEY","AIChatContext","createContext","children","sessions","setSessions","activeSessionId","setActiveSessionId","isGeneratingInBackground","setIsGeneratingInBackground","savedSessions","localStorage","getItem","parsedSessions","JSON","parse","setItem","stringify","createSession","newSession","replace","c","r","Math","random","toString","title","messages","createdAt","Date","now","prev","switchSession","sessionId","some","s","deleteSession","newSessions","clearAllSessions","updateSessionMessages","newMessages","map","session","assign","setMessages","addMessage","message","updateLastMessage","content","role","clearMessages","updateSessionTitle","activeSession","useMemo","find","contextValue","default","createElement","Provider","context","useContext","Error","__exportStar","p","__rest","t","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","Izstar","classnames_1","data_1","i18n_1","utils_1","horoscopeMutagens","activeHeavenlyStem","hoverHeavenlyStem","palaceHeavenlyStem","star","mutagenStyle","index","getMutagensByHeavenlyStem","hoverMutagenStyle","selfMutagenStyle","className","brightness","mutagen","MUTAGEN","kot","show","key","scope","count","animate","renderMessageSkeleton","renderChatSkeleton","Array","from","_","renderInputSkeleton","skeletons","push","renderSkeletons","useVirtualScroll","items","containerRef","options","itemHeight","overscan","defaultHeight","scrollTop","setScrollTop","containerHeight","setContainerHeight","measuredItems","setMeasuredItems","Map","isScrolling","setIsScrolling","scrollTimeoutRef","useRef","totalHeight","height","measured","visibleRange","startOffset","startIndex","endIndex","max","currentOffset","min","measureItem","newMap","existing","set","offset","itemId","handleScroll","current","clearTimeout","setTimeout","updateContainerHeight","clientHeight","window","addEventListener","removeEventListener","container","passive","visibleItems","scrollToIndex","scrollTo","top","behavior","scrollToBottom","MessageItem_1","TypingIndicator_1","SkeletonLoader_1","useMessageStorage_1","useVirtualScroll_1","MessageList","memo","generationFailed","lastFailedMessage","onRegenerate","messagesContainerRef","lastMessageRef","isStreaming","useMessageStorage","messageStorage","maxMessagesInMemory","pageSize","visibleMessages","storedVisibleMessages","isStorageLoading","hasMore","addMessages","loadMoreMessages","resetToLatest","displayMessages","virtualScroll","msg","storedMsg","topObserverRef","observer","IntersectionObserver","entries","isIntersecting","root","threshold","rootMargin","observe","unobserve","messageItems","originalIndex","isLastMessage","slice","style","position","left","right","ref","el","measuredHeight","getBoundingClientRect","showRegenerate","messageRef","showActions","Fragment","ChatContainer","lazy","SkeletonLoader","ChatLoadingFallback","ChatSkeletonFallback","Suspense","fallback","formData","astrolabe","synastryAstrolabe","isSynastryMode","personNames","person1","isVisible","shouldLoadChat","setShouldLoadChat","requestAnimationFrame","AIChatContext_1","onSelectSession","editingSessionId","setEditingSessionId","editingTitle","setEditingTitle","handleTitleChange","target","handleTitleSave","handleKeyDown","onClick","handleSessionClick","onChange","onBlur","onKeyDown","autoFocus","stopPropagation","toLocaleString","hour","minute","handleEdit","xmlns","width","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","handleDelete","points","x1","y1","x2","y2","cloudStorage_1","CloudStorageService","isCloudEnabled","isAuth","authenticate","disableCloudStorage","clearAuthentication","loadHistoryFromCloud","ids","getHistoryIds","cloudHistory","batchDownloadHistoryItems","forEach","localHistory","mergedHistory","mergeHistories","splice","saveHistoryToCloud","uploadHistoryItem","mergedMap","existingItem","timestamp","values","sort","a","b","newHistoryItem","generateId","unshift","historyJson","updatedItem","itemIndex","findIndex","deleteHistoryItem","filteredHistory","removeItem","clearAllHistory","substr","formatDate","date","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","react_markdown_1","remark_gfm_1","remark_breaks_1","LazyImage","src","alt","props","isLoaded","setIsLoaded","isInView","setIsInView","imgRef","entry","disconnect","onLoad","processedContent","components","h1","h2","h3","h4","h5","h6","ul","ol","li","isTask","Children","toArray","child","isValidElement","href","rel","code","inline","rest","match","exec","language","pre","blockquote","table","thead","tbody","tr","th","td","strong","em","hr","img","del","input","checked","readOnly","markdownContent","remarkPlugins","rehypePlugins","getLastUserMessage","filterValidMessages","isValidMessage","createErrorMessage","processRemainingBuffer","processStreamChunk","buildAIMessages","buildSystemPrompt","formatAstrolabeForSynastry","astrolabeFormatter_1","currentTime","second","hour12","gender","solarDate","chineseDate","time","earthlyBranchOfSoulPalace","earthlyBranchOfBodyPalace","soul","body","fiveElementsClass","keyPalaces","palaces","palace","_b","majorStars","minorStars","heavenlyStem","earthlyBranch","join","horoscope","decadal","yearly","basePrompt","synastryData","person1Data","formatAstrolabeForAI","systemPrompt","existingMessages","userMessage","chunk","buffer","onMessageUpdate","assistantMessage","newBuffer","lines","split","pop","line","startsWith","data","endsWith","parsed","choices","delta","newContent","validMessages","quickActions","onQuickActionClick","action","prompt","disabled","useVirtualKeyboard","layoutUtils_1","keyboardState","setKeyboardState","isMobile","isMobileDevice","isAndroid","isAndroidDevice","navigationBarHeight","getAndroidNavigationBarHeight","observerRef","updateKeyboardState","config","keyboardHeight","document","documentElement","setProperty","navHeight","handleViewportResize","throttle","safeAreaTop","parseInt","getComputedStyle","getPropertyValue","safeAreaBottom","viewportHeight","visualViewport","innerHeight","screenHeight","screen","windowHeight","navBarHeight","getKeyboardHeight","headerHeight","handleInputFocus","handleInputBlur","setupInputListeners","inputElement","ResizeObserver","debounce","classList","add","remove","hideKeyboard","useMessageScroll_1","useVirtualKeyboard_1","useAIChatService_1","useChatLayout_1","MessageList_1","ChatInput_1","QuickActions_1","QuestionPanel_1","ScrollToBottomButton_1","inputValue","setInputValue","showQuestionPanel","setShowQuestionPanel","isGenerating","setIsGenerating","setIsStreaming","setGenerationFailed","setLastFailedMessage","activeQuestionTab","setActiveQuestionTab","inputRef","quickActionsData","setQuickActionsData","synastryQuickActionsData","setSynastryQuickActionsData","questionCategoriesData","setQuestionCategoriesData","dataLoaded","setDataLoaded","userScrolledUp","setUserScrolledUp","useMessageScroll","getContainerStyle","getMessagesContainerStyle","getInputContainerStyle","useChatLayout","sendMessage","regenerateResponse","stopGeneration","useAIChatService","onMessagesChange","onLoadingChange","onGeneratingChange","onStreamingChange","onError","newTitle","substring","synastryQuickActions","questionCategories","handleSendMessage","updatedMessages","handleQuickActionClick","handlePresetQuestionClick","question","handleSubmit","preventDefault","toggleQuestionPanel","handleRegenerate","onInputChange","onSubmit","onToggleQuestionPanel","onStopGeneration","onTabChange","onQuestionClick","client_1","App_1","createRoot","getElementById","render","StrictMode","navigator","serviceWorker","register","registration","catch","isUserActivelyScrolling","setIsUserActivelyScrolling","userScrollTimeoutRef","isAtBottom","scrollHeight","force","atBottom","resetScrollState","AIChat","AIChat_1","messageUtils_1","useNetworkRequest_1","abortControllerRef","sendChatRequest","isNetworkLoading","networkError","useAIChatRequest","processStreamResponse","response","reader","getReader","decoder","TextDecoder","assistantMessageContent","read","decode","stream","shouldUpdate","callAIService","fetch","method","headers","model","temperature","signal","ok","status","handleError","currentMessages","errorMessage","AbortController","aiMessages","finalMessages","failedMessage","messagesWithoutLastAssistant","abort","subCategories","questions","Iztrolabe","Izpalace_1","IzpalaceCenter_1","iztro_hook_1","astro_1","taichiPoint","setTaichiPoint","taichiPalaces","setTaichiPalaces","setActiveHeavenlyStem","setHoverHeavenlyStem","focusedIndex","setFocusedIndex","showDecadal","setShowDecadal","showYearly","setShowYearly","showMonthly","setShowMonthly","showDaily","setShowDaily","showHourly","setShowShowHourly","horoscopeDate","setHoroscopeDate","horoscopeHour","setHoroscopeHour","setHoroscope","useIztro","birthday","birthTime","birthdayType","fixLeap","isLeapMonth","lang","astroType","toggleShowScope","toggleActiveHeavenlyStem","dynamic","arrowIndex","hourly","arrowScope","daily","monthly","getPalaceNames","toggleTaichiPoint","Izpalace","onFocused","showDecadalScope","showYearlyScope","showMonthlyScope","showDailyScope","showHourlyScope","taichiPalace","toggleScope","IzpalaceCenter","centerPalaceAlign","createLayoutObserver","updateLayoutCSSVariables","isKeyboardVisible","calculateAvailableHeight","getSafeAreaInset","getLayoutConfig","test","userAgent","heightDiff","screenWidth","windowWidth","innerWidth","widthDiff","abs","CSS","supports","onLayoutChange","func","delay","timeoutId","args","lastCall","ResultContainer","Iztrolabe_1","SegmentedControl_1","module","BackgroundAIIndicator","HistoryPanel","ResultContainerWithHistory","chartMode","astrolabe1","astrolabe2","onShowInputPanel","activeTab","setActiveTab","isInitialMount","SegmentedControl","label","ChatInput","isPWA","setIsPWA","isIOS","setIsIOS","setIsAndroid","androidNavBarHeight","setAndroidNavBarHeight","iosNotchHeight","setIosNotchHeight","deviceInfo","isIOSDevice","isStandalone","matchMedia","matches","standalone","referrer","heights","getIosNotchHeight","getAndroidNavBarHeight","handleInputChange","handleButtonClick","Event","mediaQuery","handlePWAChange","MutationObserver","attributes","attributeFilter","placeholder","CLOUD_ENABLED_KEY","CLOUD_PASSWORD","WORKER_URL","statusText","json","success","downloadHistoryItem","isOnline","mode","cache","Izstar_1","_c","_d","_e","horoscopeNames","age","fixIndex","onMouseEnter","onMouseLeave","adjectiveStars","stars","changsheng12","boshi12","isBodyPalace","ages","range","palaceNames","yearlyDecStar","suiqian12","jiangqian12","controlRef","sliderRef","activeElement","querySelector","buttonElement","nextElementSibling","updateSliderPosition","buttonRect","controlRect","opacity","animationId","resizeObserver","cancelAnimationFrame","optionValue","onTouchStart","touches","touch","currentTarget","dataset","touchStartX","clientX","touchStartY","clientY","onTouchMove","parseFloat","deltaX","deltaY","onTouchEnd","option","activeCategory","category","subCategory","markdownFormatter_1","MessageItem","isUser","displayedContent","setDisplayedContent","hasStartedStreaming","setHasStartedStreaming","contentRef","handleCopy","clipboard","writeText","err","handleShare","share","shareData","text","shouldShowActions","x","y","rx","ry","cx","cy","formatStars","lunarDate","timeRange","sign","zodiac","_f","_g","_h","isOriginalPalace","formatPalace","nominalAge","Line","strokeColor","element","getElementsByClassName","idx","canvasDom","w","h","canvasCtx","getContext","clearRect","strokeStyle","lineWidth","globalAlpha","dgIdx","q4Idx","h4Idx","beginPath","moveTo","lineTo","onLoadHistory","onEditHistory","handlePasswordKeyDown","FormContainer","setChartMode","onFormChange","onSynastryChange","onRadioChange","onSynastryRadioChange","onSynastrySubmit","onShowHistory","handleFormChange","handleSynastryChange","person","htmlFor","useNetworkRequest","cacheKey","cacheTTL","maxRetries","retryDelay","retryBackoff","setError","cacheRef","isCacheValid","getFromCache","fullKey","setCache","clearCache","keys","delete","ms","sendRequest","requestConfig","customCacheKey","url","cacheData","retryCount","currentRetryDelay","attemptRequest","fetchOptions","cancelRequest","messages_1","args_1","Item","layoutConfig","setLayoutConfig","isInitialized","setIsInitialized","updateLayout","newConfig","updatedConfig","initializeLayout","handleResize","handleMobileLayout","handleDesktopLayout","handleOrientationChange","currentIsMobile","getGridTemplateStyle","contains","gridTemplateRows","baseStyle","display","minHeight","overflow","bottom","overflowY","scrollSnapType","paddingTop","paddingBottom","marginTop","marginBottom","padding","flexShrink","backgroundColor","zIndex","borderTop","AppContainer_1","ResultContainer_1","useHistoryManager_1","FormPanel_1","HistoryModal_1","setFormData","setSynastryData","showAstrolabe","setShowAstrolabe","showInputPanel","setShowInputPanel","urlParams","URLSearchParams","location","search","hasCompleteDateParams","updateThemeColor","isDarkMode","themeColor","metaThemeColor","setAttribute","getElementsByTagName","appendChild","darkModeMediaQuery","darkModeListener","updateUrlParams","params","newUrl","pathname","replaceState","handleLoadHistory","handleEditHistory","handleShowInputPanel","AppContainer","onSaveHistory","Item_1","Line_1","lunar_lite_1","records","horoDate","dateStr","normalizeDateStr","dt","solar","lunar","solar2lunar","prevDecadalDisabled","setFullYear","onHoroscopeButtonClicked","birthYear","birthMonth","birthDate","setDate","setMonth","getTime","shouldBeDisabled","fixEarthlyBranchIndex","rec","CHINESE_TIME","useKeyboardDetector_1","useKeyboardDetector","useSafeArea","storageKey","allMessages","setAllMessages","setVisibleMessages","currentPage","setCurrentPage","setHasMore","loadMessagesFromStorage","storedMessages","parsedMessages","isArray","every","saveMessagesToStorage","recentMessages","cleanupError","initialVisible","updated","trimmed","nextPage","newVisibleMessages","latestMessages","setIsKeyboardVisible","setKeyboardHeight","calculatedKeyboardHeight","isKeyboardNowVisible","handleFocusIn","tagName","handleFocusOut","safeArea","setSafeArea","updateSafeArea","tempElement","computedStyle","newSafeArea","removeChild","FormContainer_1","handleSynastrySubmit"],"sourceRoot":""}